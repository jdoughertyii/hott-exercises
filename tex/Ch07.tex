\begin{coqdoccode}
\end{coqdoccode}
\section{Homotopy $n$-types}



 \exer{7.1}{250} 
(i) Use Theorem 7.2.2 to show that if $\brck{A} \to A$ for every type $A$, then
    every type is a set.
(ii) Show that if every surjective function (purely) splits, i.e.~if
    $\prd{b:B}\brck{\hfib{f}{b}} \to \prd{b:B}\hfib{f}{b}$ for every $f : A \to
    B$, then every type is a set.


 \soln
(i)  Suppose that $f : \prd{A:\UU}\brck{A} \to A$, and let $X$ be some type. To
apply Theorem 7.2.2, we need a reflexive mere relation on $X$ that implies
identity.  Let $R(x, y) \defeq \brck{x = y}$, which is clearly a reflexive mere
relation.  Moreoever, it implies the identity, since for any $x, y : X$ we have
\[
  f(x = y) : R(x, y) \to (x = y)
\]
So by Theorem 7.2.2, $X$ is a set.




 \exer{7.2}{250} 
Express $\Sn^{2}$ as a colimit of a diagram consisting entirely of copies of
$\unit$.


 \soln
Recall that we can define $\Sn^{2} \defeq \susp\Sn^{1} \defeq \susp\susp\Sn^{0}
\defeq \susp\susp\susp\bool$.  Then note that $\eqv{\bool}{\unit + \unit}$, and
that $\susp{A}$ is the pushout of the span $\unit \leftarrow A \to \unit$.  So
we have a diagram
\[\xymatrix{
  \unit + \unit \ar[r] \ar[d] & \unit \ar[d] & \\
  \unit \ar[r] & \Sn^{1} \ar[d] \ar[r] & \unit \ar[d] \\
  & \unit \ar[r] & \Sn^{2}
}\]
where both squares are pushouts.  And, since the coproduct is the colimit
of the discrete diagram with two items, we can write
\[\xymatrix{
               & \unit \ar[d] & & \\
  \unit \ar[r] & \bool \ar[r] \ar[d] & \unit \ar[d] & \\
  & \unit \ar[r] & \Sn^{1} \ar[d] \ar[r] & \unit \ar[d] \\
  & & \unit \ar[r] & \Sn^{2}
}\]
where now every object that isn't a $\unit$ is a colimit.


 \exer{7.3}{250} \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdef{Ch07.W tree}{W\_tree}{\coqdocinductive{W\_tree}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) : \coqdockw{Type} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdef{Ch07.sup}{sup}{\coqdocconstructor{sup}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvar{A}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvar{B} \coqdocvariable{a} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch07.W tree}{\coqdocinductive{W\_tree}} \coqdocvar{A} \coqdocvar{B}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch07.W tree}{\coqdocinductive{W\_tree}} \coqdocvar{A} \coqdocvar{B}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{7.4}{250}  \exer{7.5}{250}  \exer{7.6}{250}  \exer{7.7}{250}  \exer{7.8}{250}  \exer{7.9}{251}  \exer{7.10}{251}  \exer{7.11}{251} 

 \exer{7.12}{251} 
Show that $X \mapsto (\lnot \lnot X)$ is a modality.


 \soln
We must show that there are
\begin{enumerate}
  \item functions $\eta^{\lnot \lnot}_{A} : A \to \lnot\lnot A$ for every type
  $A$,
  \item for every $A : \UU$ and every family $B : \lnot\lnot A \to \UU$, a
  function
  \[
    \ind{\lnot\lnot} : 
    \left(\prd{a : A}\lnot\lnot(B(\eta^{\lnot\lnot}_{A}(a)))\right)
    \to
    \prd{z : \lnot\lnot A}\lnot\lnot(B(z))
  \]
  \item A path $\ind{\lnot\lnot}(f)(\eta^{\lnot\lnot}_{A}(a)) = f(a)$ for each
  $f : \prd{a : A}\lnot\lnot(B(\eta^{\lnot\lnot}_{A}(a)))$, and
  \item For any $z, z' : \lnot \lnot A$, the function $\eta^{\lnot\lnot}_{z =
  z'} : (z = z') \to \lnot\lnot(z = z')$ is an equivalence.
\end{enumerate}
Some of this has already been done.  The functions $\eta^{\lnot\lnot}_{A}$ were
given in Exercise 1.12; recall:
\[
  \eta^{\lnot\lnot}_{A} \defeq \lam{a}{f}f(a)
\]
Now suppose that we have an element $f$ of the antecedent of
$\ind{\lnot\lnot}$, and let $z : \lnot\lnot A$.  Suppose furthermore
that $g : \lnot B(z)$; we derive a contradiction.  It suffices to
construct an element of $\lnot A$, for then we can apply $z$ to obtain
an element of $\emptyt$.  So suppose that $a : A$.  Then 
\[
  f(a) : \lnot \lnot B(\eta^{\lnot\lnot}_{A}(a))
\]
but $\lnot X$ is a mere proposition for any type $X$, so $z =
\eta^{\lnot\lnot}_{A}(a)$, and transporting gives an element of $\lnot \lnot
B(z)$.  Applying this to $g$ gives a contradiction.


For (iii), suppose that $a : A$ and $f : \prd{a :
A}\lnot\lnot(B(\eta^{\lnot\lnot}_{A}(a)))$.  Then $f(a) : \lnot \lnot
(B(\eta^{\lnot\lnot}_{A}(a)))$, making this type contractible, giving a
canonical path $\ind{\lnot\lnot}(f)(\eta^{\lnot\lnot}_{A}(a)) = f(a)$.


Finally, for (iv), let $z, z' : \lnot\lnot A$.  Since $\lnot\lnot A$ is a mere
proposition, so is $z = z'$.  $\lnot\lnot(z = z')$ is also a mere proposition,
so if there is an arrow $\lnot\lnot(z = z') \to (z = z')$, then it is
automatically a quasi-inverse to $\eta^{\lnot\lnot}_{z = z'}$.  Such an arrow
is immediate from the fact that $\lnot \lnot A$ is a mere proposition.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
eta\_nn\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:=\coqdocindent{0.50em}
fun\coqdocindent{0.50em}
a\coqdocindent{0.50em}
f\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
hprop\_arrow\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
B\coqdocindent{0.50em}
->\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
HB.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_allpath.\coqdocindent{0.50em}
intros\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
HB.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
hprop\_neg\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
(\~{}\coqdocindent{0.50em}
A).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_arrow.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hprop\_Empty.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
ind\_nn\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
(forall\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
(eta\_nn\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)))\coqdocindent{0.50em}
->\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
z\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
z).\coqdocindent{0.50em}
\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intros\coqdocindent{0.50em}
f\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
g.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
((transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
x))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(@allpath\_hprop\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
hprop\_neg\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{10.00em}
(f\coqdocindent{0.50em}
a))\coqdocindent{0.50em}
g).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
ind\_nn\_compute\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type)\coqdoceol
\coqdocindent{1.50em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
a,\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
(eta\_nn\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)))\coqdocindent{0.50em}
(a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{2.00em}
ind\_nn\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
f\coqdocindent{0.50em}
(eta\_nn\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
isequiv\_hprop\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
Q\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
(HQ\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
Q)\coqdoceol
\coqdocindent{3.00em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Q)\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
(Q\coqdocindent{0.50em}
->\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
IsEquiv\coqdocindent{0.50em}
f.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
g.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(isequiv\_adjointify\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
q.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
hprop\_hprop\_path\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HA\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
(x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
(x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
y).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_allpath.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
set\_path2.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
nn\_isequiv\_eta\_path\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(z\coqdocindent{0.50em}
z'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
IsEquiv\coqdocindent{0.50em}
(eta\_nn\coqdocindent{0.50em}
(z\coqdocindent{0.50em}
=\coqdocindent{0.50em}
z')).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
isequiv\_hprop.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_hprop\_path.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hprop\_neg.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hprop\_neg.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hprop\_neg.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
ismodality\_DN\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
A).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(@Build\_IsModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
\~{}\~{}\coqdocindent{0.50em}
A)\coqdoceol
\coqdocindent{13.50em}
eta\_nn\coqdoceol
\coqdocindent{13.50em}
ind\_nn\coqdoceol
\coqdocindent{13.50em}
ind\_nn\_compute\coqdoceol
\coqdocindent{13.50em}
nn\_isequiv\_eta\_path).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exer{7.13}{251} 
Let $P$ be a mere proposition
\begin{enumerate}
\item Show that $X \mapsto (P \to X)$ is a left exact modality.
\item Show that $X \mapsto (P * X)$ is a left exact modality, where $*$ denotes
    the join.
\end{enumerate}


 \soln
A left exact modality is one which preserves pullbacks as well as finite
products.  That is, if $A \times _{C} B$ is a pullback, then so is
$\modal (A \times_{C} B)$, which is to say that for all $X$,
\[
  (X \to \modal(A \times_{C} B))
  \eqvsym
  (X \to \modal A) \times_{X \to \modal C} (X \to \modal B)
\]
Likewise, if $A \times B$ is a product, then so is $\modal(A \times B)$;
i.e., for all $X$ we have
\[
  \eqv{
    (X \to \modal(A \times B)) 
  }{
    (X \to \modal A) \times (X \to \modal B)
  }
\] \begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
mod\_fun\coqdocindent{0.50em}
(mod\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
`\{IsModality\coqdocindent{0.50em}
mod\}\coqdoceol
\coqdocindent{5.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
B.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
modality\_ind.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
modality\_eta.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
a).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
mod\_fun\_eta\coqdocindent{0.50em}
(mod\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
`\{IsModality\coqdocindent{0.50em}
mod\}\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{3.00em}
\{f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\}\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
(@mod\_fun\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
f)\coqdocindent{0.50em}
o\coqdocindent{0.50em}
(@modality\_eta\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
A)\coqdoceol
\coqdocindent{1.00em}
=\coqdoceol
\coqdocindent{1.00em}
(@modality\_eta\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
o\coqdocindent{0.50em}
f.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
compose,\coqdocindent{0.50em}
mod\_fun.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(@modality\_ind\_compute\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Class\coqdocindent{0.50em}
IsLEModality\coqdocindent{0.50em}
(mod\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
:=\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
BuildIsLEModality\coqdocindent{0.50em}
\{\coqdoceol
\coqdocindent{3.00em}
lem\_ismodality\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsModality\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
;\coqdoceol
\coqdocindent{3.00em}
lem\_pullbacks\coqdocindent{0.50em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
C\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
->\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
X,\coqdoceol
\coqdocindent{4.00em}
(X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
\{a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\{b\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g\coqdocindent{0.50em}
b\}\})\coqdoceol
\coqdocindent{4.00em}
<\~{}>\coqdoceol
\coqdocindent{4.00em}
\{a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\{\coqdocindent{0.50em}
b\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdoceol
\coqdocindent{5.50em}
(mod\_fun\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
f)\coqdocindent{0.50em}
o\coqdocindent{0.50em}
a\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{5.50em}
=\coqdocindent{0.50em}
(mod\_fun\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
g)\coqdocindent{0.50em}
o\coqdocindent{0.50em}
b\}\}\coqdocindent{0.50em}
;\coqdoceol
\coqdocindent{3.00em}
lem\_products\coqdocindent{0.50em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
X:\coqdocindent{0.50em}
Type),\coqdoceol
\coqdocindent{4.00em}
(X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
*\coqdocindent{0.50em}
B))\coqdocindent{0.50em}
<\~{}>\coqdocindent{0.50em}
(X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
(X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
mod\coqdocindent{0.50em}
B)\coqdocindent{7.50em}
\coqdoceol
\coqdocindent{2.00em}
\}.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\end{coqdoccode}
(i) Let $\modal X \defeq (P \to X)$, with $\eta^{\modal}_{A} : A \to
\modal A$ given by $\eta^{\modal}_{A}(a) \defeq \lam{p}a$.  To derive the
induction principle, suppose that $A : \UU$, $B : \modal A \to \UU$, $f :
\prd{a:A}\modal(B(\eta^{\modal}_{A}(a)))$, and $g : \modal A$.  We need to
construct an arrow $P \to B(g)$.  So suppose that $p : P$, so $g(p) : A$.  Then
$f(g(p)) : P \to B(\lam{p'}g(p))$.  But since $P$ is a mere proposition, by
function extensionality $\lam{p'}g(p) = g$, and we can transport the output of
$f(g(p))$ to obtain an element of $B(g)$, as required.


To demonstrate the computation rule, suppose that $f : \prd{a:A} P \to
B(\lam{p}a)$ and $a : A$.  Then $f(a) : P \to B(\lam{p}a)$ and $\ind{\modal
A}(f)(a) : P \to B(\lam{p}a)$.  So by function extensionality and the fact that
$P$ is a mere proposition, $\ind{\modal A}(f)(a) = f(a)$.


To show that $\eta^{\modal}_{z = z'}$ is an equivalence for all $f, g : \modal
A$, we first need an inverse.  Let $k : P \to (f = g)$, and suppose that $p :
P$.  Then $k(p) : f = g$, so $\lam{p}\happly(k(p)) : f \sim g$.  By function
extensionality, then, we have $f = g$.  These are clearly quasi-inverses.  If
$q : f = g$, then we want to show that
\[
  \funext(\lam{p}\happly(q, p)) = q
\]
which follows immediately from the fact that $\funext$ and $\happly$ are
inverses.  For the other direction, suppose that $k : P \to (f = g)$.  Then we
need to show that
\[
  \lam{p}\funext(\lam{p'}\happly(k(p'), p')) = k
\]
which we do by function extensionality.  Supposing that $p : P$, we need to
show that
\[
  \lam{p'}\happly(k(p'), p')) = \happly(k(p))
\]
and this follows from the fact that $P$ is a mere proposition, just as we
showed that $\lam{p'}g(p) = g$.


Now, to show that this modality is left exact, note that
\begin{align*}
 (X \to \modal(A \times_{C} B))
 &\equiv
 (X \to P \to A \times_{C} B)
 \\&\eqvsym
 ((X \times P) \to A \times_{C} B)
 \\&\eqvsym
 ((X \times P) \to A) \times_{(X \times P) \to C} ((X \times P) \to B)
 \\&\eqvsym
 (X \to P \to A) \times_{X \to P \to C} (X \to P \to B)
 \\&\equiv
 (X \to \modal A) \times_{X \to \modal C} (X \to \modal B)
\end{align*}
Using the cartesian closure adjunction.  Likewise,
\begin{align*}
  (X \to \modal(A \times B))
  &\equiv
  (X \to P \to A \times B)
  \\&\eqvsym
  ((X \times P) \to (A \times B))
  \\&\eqvsym
  ((X \times P) \to A)
  \times
  ((X \times P) \to B)
  \\&\eqvsym
  (X \to P \to A)
  \times
  (X \to P \to B)
  \\&\equiv
  (X \to \modal A)
  \times
  (X \to \modal B)
\end{align*}
By the universal property of the product.  So $\modal$ preserves both pullbacks
and finite products.


Coq is having a real hard time with the proof of
\coqdocvar{coslice\_compose\_aux} below.  The right way to do it is to use the functorality of $\modal$, but instead I just did a bunch of path algebra.  Maybe I'll go back and do it right one day.\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
eta\_coslice\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type,\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdoceol
\coqdocindent{1.00em}
:=\coqdocindent{0.50em}
fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a\coqdocindent{0.50em}
p\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
a.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
ind\_coslice\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
Type),\coqdoceol
\coqdocindent{3.00em}
(forall\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{3.00em}
->\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
z\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
z).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intros\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
g\coqdocindent{0.50em}
p)\coqdocindent{0.50em}
g\coqdoceol
\coqdocindent{5.00em}
(fun\coqdocindent{0.50em}
p'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
ap\coqdocindent{0.50em}
g\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p\coqdocindent{0.50em}
p')))).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
p.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
ind\_coslice\_compute\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(B\coqdocindent{0.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)))\coqdocindent{0.50em}
a,\coqdoceol
\coqdocindent{3.00em}
ind\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
f\coqdocindent{0.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
a)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intros\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
ind\_coslice.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
eta\_coslice.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
B\coqdoceol
\coqdocindent{2.50em}
(path\_forall\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
a)\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
a)\coqdoceol
\coqdocindent{4.00em}
(fun\coqdocindent{0.50em}
p'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
1))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.50em}
(f\coqdocindent{0.50em}
a\coqdocindent{0.50em}
p)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p'.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
ap\_const.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
B\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
a\coqdocindent{0.50em}
p)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall\_1.\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
isequiv\_eta\_coslice\_path\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
A\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A),\coqdoceol
\coqdocindent{3.00em}
IsEquiv\coqdocindent{0.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g)).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intros.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(isequiv\_adjointify\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
(H\coqdocindent{0.50em}
p)).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
retract\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
H.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
eta\_coslice.\coqdoceol
\coqdocindent{1.00em}
transitivity\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
((path\_forall\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g)\^{}-1\coqdocindent{0.50em}
(H\coqdocindent{0.50em}
p))).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
f\coqdocindent{0.50em}
g)).\coqdoceol
\coqdocindent{1.00em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p'.\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
eisretr.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
q.\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
p\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
apD10\coqdocindent{0.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g)\coqdocindent{0.50em}
q\coqdocindent{0.50em}
p)\coqdocindent{0.50em}
p)\coqdoceol
\coqdocindent{4.50em}
with\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
q).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
eta\_path\_forall.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
ismodality\_hprop\_coslice\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
IsModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdoceol
\coqdocindent{1.00em}
:=\coqdocindent{0.50em}
@Build\_IsModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdoceol
\coqdocindent{13.50em}
(eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP)\coqdoceol
\coqdocindent{13.50em}
(ind\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP)\coqdoceol
\coqdocindent{13.50em}
(ind\_coslice\_compute\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP)\coqdoceol
\coqdocindent{13.50em}
(isequiv\_eta\_coslice\_path\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP).\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
isequiv\_contr\_coslice\_fun\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
`\{Contr\coqdocindent{0.50em}
P\}\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
IsEquiv\coqdocindent{0.50em}
(@mod\_fun\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(ismodality\_hprop\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{10.00em}
A\coqdocindent{0.50em}
B).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(isequiv\_adjointify\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intros\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
a.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
Contr0.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
mod\_fun.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
h.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
modality\_ind.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
eta\_coslice,\coqdocindent{0.50em}
ind\_coslice.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((path\_forall\_1\_beta\coqdocindent{0.50em}
p\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((transport\_const\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p'.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
h).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdocindent{0.50em}
\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
retraction\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
mod\_fun.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
modality\_ind,\coqdocindent{0.50em}
modality\_eta.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
ind\_coslice,\coqdocindent{0.50em}
eta\_coslice.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
a)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(path\_forall\_1\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
a))).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
ap\_const.\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
ap11\_V\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
\{f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\}\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
:\coqdocindent{0.50em}
f\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g)\coqdocindent{0.50em}
\{x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\}\coqdocindent{0.50em}
(p\coqdocindent{0.50em}
:\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
y)\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
ap11\coqdocindent{0.50em}
h\^{}\coqdocindent{0.50em}
p\^{}\coqdocindent{0.50em}
=\coqdocindent{0.50em}
(ap11\coqdocindent{0.50em}
h\coqdocindent{0.50em}
p)\^{}.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
induction\coqdocindent{0.50em}
h.\coqdocindent{0.50em}
induction\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
reflexivity.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
coslice\_compose\_aux\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
C\coqdocindent{0.50em}
P\coqdocindent{0.50em}
X\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{3.00em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
->\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\coqdoceol
\{h\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\{k\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
f\coqdocindent{0.50em}
o\coqdocindent{0.50em}
h\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g\coqdocindent{0.50em}
o\coqdocindent{0.50em}
k\}\}\coqdocindent{0.50em}
<\~{}>\coqdoceol
\coqdocindent{1.50em}
\{a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdoceol
\coqdocindent{1.50em}
\{b\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
->\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdoceol
\coqdocindent{1.50em}
@mod\_fun\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A0\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A0)\coqdocindent{0.50em}
(ismodality\_hprop\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
f\coqdocindent{0.50em}
o\coqdocindent{0.50em}
a\coqdoceol
\coqdocindent{1.50em}
=\coqdoceol
\coqdocindent{1.50em}
@mod\_fun\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A0\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A0)\coqdocindent{0.50em}
(ismodality\_hprop\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
g\coqdocindent{0.50em}
o\coqdocindent{0.50em}
b\coqdoceol
\coqdocindent{1.50em}
\}\}.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_functor\_sigma'\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_uncurry.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
h.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_functor\_sigma'\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_uncurry.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
k.\coqdoceol
\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_adjointify\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
forward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
r.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
mod\_fun,\coqdocindent{0.50em}
modality\_ind,\coqdocindent{0.50em}
modality\_eta.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
x.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
compose.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
ind\_coslice,\coqdocindent{0.50em}
eta\_coslice.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((path\_forall\_1\_beta\coqdocindent{0.50em}
p\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((apD10\coqdoceol
\coqdocindent{5.50em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{7.00em}
(ap\coqdocindent{0.50em}
\_\coqdoceol
\coqdocindent{8.50em}
(allpath\_hprop\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p\coqdocindent{0.50em}
p)\coqdocindent{0.50em}
1)\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{7.50em}
ap\_1\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_))\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(path\_forall\_1\_beta\coqdocindent{0.50em}
p\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\^{}).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(apD10\coqdoceol
\coqdocindent{5.50em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{7.00em}
((ap\_1\coqdocindent{0.50em}
p\coqdocindent{0.50em}
\_)\^{}\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{7.50em}
ap\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{8.50em}
(allpath\_hprop\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p\coqdocindent{0.50em}
p))))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{5.50em}
(g\coqdocindent{0.50em}
(k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))))).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
r\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p)).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
back\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
r.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
z.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((ap\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
o\coqdocindent{0.50em}
h)\coqdocindent{0.50em}
(eta\_prod\coqdocindent{0.50em}
z)\^{})\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
compose.\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
z,\coqdocindent{0.50em}
snd\coqdocindent{0.50em}
z)))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.00em}
with\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(@idpath\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
z,\coqdocindent{0.50em}
snd\coqdocindent{0.50em}
z)))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(f\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
z,\coqdocindent{0.50em}
snd\coqdocindent{0.50em}
z)))).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((apD10\coqdoceol
\coqdocindent{5.50em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{7.00em}
((ap\_1\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
z,\coqdocindent{0.50em}
y)))\^{}\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{7.50em}
ap\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{8.50em}
(allpath\_hprop\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z)\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z)))))\coqdoceol
\coqdocindent{5.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((path\_forall\_1\_beta\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdoceol
\coqdocindent{6.00em}
(fun\coqdocindent{0.50em}
p'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{6.50em}
ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
z,\coqdocindent{0.50em}
y))\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z)\coqdocindent{0.50em}
p'))\coqdoceol
\coqdocindent{6.00em}
\_)\^{}\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((apD10\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
r\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdocindent{0.50em}
clear\coqdocindent{0.50em}
r.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((path\_forall\_1\_beta\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z)\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((apD10\coqdoceol
\coqdocindent{5.50em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{7.00em}
(ap11\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z)\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
z))\coqdocindent{0.50em}
1)\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{7.50em}
ap\_1\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_))\coqdoceol
\coqdocindent{5.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
simpl.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((ap\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
o\coqdocindent{0.50em}
k)\coqdocindent{0.50em}
(eta\_prod\coqdocindent{0.50em}
z))\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
r.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
r)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
x.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
r\coqdocindent{0.50em}
x))).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_Mp.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((concat\_p\_pp\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_pV.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
moveR\_Mp.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
moveR\_pM.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((apD10\_path\_forall\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_pM.\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(eta\_prod\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
(@idpath\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p)).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((ap\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((ap\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
(ap\_1\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_))\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveL\_pV.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((concat\_1p\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(concat\_p\_pp\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
concat2.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(apD10\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))))).\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
x.\coqdocindent{0.50em}
change\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap11\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
hott\_simpl.\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdocindent{1.00em}
hott\_simpl.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
concat2.\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
x.\coqdocindent{0.50em}
change\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
whiskerL.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
equiv\_uncurry,\coqdocindent{0.50em}
equiv\_inverse,\coqdocindent{0.50em}
modality\_eta.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
eta\_coslice.\coqdocindent{0.50em}
reflexivity.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(apD10\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap11\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
change\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap\_V\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(allpath\_hprop\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p\coqdocindent{0.50em}
p)))).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
eta\_path\_forall.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
eta\_path\_forall.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
retract\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
r.\coqdoceol
\coqdocindent{1.00em}
etransitivity\coqdocindent{0.50em}
(path\_forall\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
r)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
z.\coqdoceol
\coqdocindent{1.00em}
destruct\coqdocindent{0.50em}
z\coqdocindent{0.50em}
as\coqdocindent{0.50em}
\coqdocvar{x} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
change\coqdocindent{0.50em}
(fst\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
x.\coqdocindent{0.50em}
change\coqdocindent{0.50em}
(snd\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p))\coqdocindent{0.50em}
with\coqdocindent{0.50em}
p.\coqdoceol
\coqdocindent{1.00em}
hott\_simpl.\coqdoceol
\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
compose.\coqdoceol
\coqdocindent{1.00em}
repeat\coqdocindent{0.50em}
(refine\coqdocindent{0.50em}
((concat\_pp\_p\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_Mp.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
moveR\_Vp.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
moveR\_pM.\coqdoceol
\coqdocindent{1.00em}
transitivity\coqdocindent{0.50em}
(apD10\coqdoceol
\coqdocindent{6.00em}
(path\_forall\coqdoceol
\coqdocindent{7.00em}
(ind\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdoceol
\coqdocindent{8.50em}
(fun\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
C\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
a))\coqdoceol
\coqdocindent{8.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\coqdoceol
\coqdocindent{7.00em}
(ind\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
B\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdoceol
\coqdocindent{8.50em}
(fun\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
C\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
a))\coqdoceol
\coqdocindent{8.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\coqdoceol
\coqdocindent{7.00em}
(fun\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{7.50em}
path\_forall\_1\_beta\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdoceol
\coqdocindent{8.50em}
(fun\coqdocindent{0.50em}
p'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{9.00em}
ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y))\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
p'))\coqdoceol
\coqdocindent{8.50em}
(f\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p0)))\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{7.50em}
(apD10\coqdoceol
\coqdocindent{9.00em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{10.50em}
(ap\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\coqdoceol
\coqdocindent{12.00em}
(allpath\_hprop\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
p0)\coqdocindent{0.50em}
1)\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{11.00em}
ap\_1\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y))))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{9.00em}
(f\coqdocindent{0.50em}
(h\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p0)))\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{8.00em}
((apD10\coqdocindent{0.50em}
r\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p0)\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{9.00em}
apD10\coqdoceol
\coqdocindent{10.00em}
(ap11\coqdocindent{0.50em}
1\coqdoceol
\coqdocindent{11.50em}
((ap\_1\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\^{}\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{12.00em}
ap\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y)))\coqdoceol
\coqdocindent{13.00em}
(allpath\_hprop\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
p0))))\coqdoceol
\coqdocindent{10.00em}
(g\coqdocindent{0.50em}
(k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p0))))\coqdocindent{0.50em}
@\coqdoceol
\coqdocindent{8.50em}
(path\_forall\_1\_beta\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdoceol
\coqdocindent{10.00em}
(fun\coqdocindent{0.50em}
p'\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{10.50em}
ap\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
y))\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p0\coqdocindent{0.50em}
p'))\coqdoceol
\coqdocindent{10.00em}
(g\coqdocindent{0.50em}
(k\coqdocindent{0.50em}
(x,\coqdocindent{0.50em}
p0))))\^{}))))\coqdocindent{1.00em}
p).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((apD10\_path\_forall\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{9.50em}
(fun\coqdocindent{0.50em}
x0\coqdocindent{0.50em}
:\coqdocindent{0.50em}
X\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{4.50em}
ind\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
A\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
C)\coqdoceol
\coqdocindent{5.50em}
(fun\coqdocindent{0.50em}
a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
eta\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP\coqdocindent{0.50em}
C\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
a))\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{5.50em}
(fun\coqdocindent{0.50em}
y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
P\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
h\coqdocindent{0.50em}
(x0,\coqdocindent{0.50em}
y)))\coqdoceol
\coqdocindent{9.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((apD10\_path\_forall\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(concat\_p\_pp\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
whiskerL.\coqdoceol
\coqdocindent{1.00em}
repeat\coqdocindent{0.50em}
(apply\coqdocindent{0.50em}
moveL\_Mp).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(inv\_pp\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\^{}).\coqdoceol
\coqdocindent{1.00em}
hott\_simpl.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
concat2.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
repeat\coqdocindent{0.50em}
(refine\coqdocindent{0.50em}
((concat\_pp\_p\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_Vp.\coqdoceol
\coqdocindent{1.00em}
hott\_simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
concat2.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
concat2.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(apD10\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap11\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
1\coqdocindent{0.50em}
(allpath\_hprop\coqdocindent{0.50em}
p\coqdocindent{0.50em}
p)))).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
simpl\coqdocindent{0.50em}
modality\_eta.\coqdocindent{0.50em}
unfold\coqdocindent{0.50em}
eta\_coslice.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(apD10\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
((equiv\_inverse\coqdocindent{0.50em}
(equiv\_uncurry\coqdocindent{0.50em}
X\coqdocindent{0.50em}
P\coqdocindent{0.50em}
B))\coqdocindent{0.50em}
k\coqdocindent{0.50em}
x\coqdocindent{0.50em}
p)))).\coqdoceol
\coqdocindent{1.00em}
simpl\coqdocindent{0.50em}
(g\coqdocindent{0.50em}
((equiv\_inverse\coqdocindent{0.50em}
(equiv\_uncurry\coqdocindent{0.50em}
X\coqdocindent{0.50em}
P\coqdocindent{0.50em}
B))\coqdocindent{0.50em}
k\coqdocindent{0.50em}
x\coqdocindent{0.50em}
p)).\coqdoceol
\coqdocindent{1.00em}
repeat\coqdocindent{0.50em}
(f\_ap;\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap11\_V\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_))).\coqdoceol
\coqdocindent{1.00em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
eta\_path\_forall.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
islemodality\_hprop\_coslice\coqdocindent{0.50em}
`\{Funext\}\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{4.00em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HP\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
IsLEModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(BuildIsLEModality\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(ismodality\_hprop\_coslice\coqdocindent{0.50em}
P\coqdocindent{0.50em}
HP).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
preserves\coqdocindent{0.50em}
pullbacks\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intros.\coqdoceol
\coqdocindent{1.00em}
equiv\_via\coqdocindent{0.50em}
((X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
\{a\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\{b\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
f\coqdocindent{0.50em}
a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g\coqdocindent{0.50em}
b\}\}).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_uncurry.\coqdoceol
\coqdocindent{1.00em}
transparent\coqdocindent{0.50em}
assert\coqdocindent{0.50em}
(Hm\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(IsModality\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
P\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A))).\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
ismodality\_hprop\_coslice.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
HP.\coqdoceol
\coqdocindent{1.00em}
equiv\_via\coqdocindent{0.50em}
\{h\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
\&\coqdoceol
\coqdocindent{1.50em}
\{k\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdoceol
\coqdocindent{1.50em}
f\coqdocindent{0.50em}
o\coqdocindent{0.50em}
h\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g\coqdocindent{0.50em}
o\coqdocindent{0.50em}
k\}\}.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
ex2\_11.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
H.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
coslice\_compose\_aux.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
preserves\coqdocindent{0.50em}
products\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intros.\coqdoceol
\coqdocindent{1.00em}
equiv\_via\coqdocindent{0.50em}
((X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A\coqdocindent{0.50em}
*\coqdocindent{0.50em}
B).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_uncurry.\coqdoceol
\coqdocindent{1.00em}
equiv\_via\coqdocindent{0.50em}
(((X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
((X\coqdocindent{0.50em}
*\coqdocindent{0.50em}
P)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B)).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_prod\_corect.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_functor\_prod';\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_uncurry.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\end{coqdoccode}
(ii)
Suppose now that $\modal X \defeq P * X$.  That is, suppose that $\modal X$ is
the pushout of the span $X \xleftarrow{\fst} X \times P \xrightarrow{\snd}
P$.  This is the higher inductive type presented by



\begin{itemize}
\item  a function $\inl : X \to P * X$

\item  a function $\inr : P \to P * X$

\item  for each $z : P \times X$ a path $\glue(z) : \inl(\fst(z)) = \inr(\snd(z))$

\end{itemize}
Note that if $P$ is contractible, then so is $\modal X$.  This is
straightforward: letting $p$ be the center of $P$, $\inl(p)$ is the center of
$\modal(X)$.  Using the induction principle for pushouts, we must first show
that for all $p' : P$, $\inl(p) = \inl(p')$, which follows from $P$'s
contractibility.  Next we need, for any $x : X$, $\inl(p) = \inr(x)$.  This
follows from $\glue((p, x)) : \inl(p) = \inr(x)$.  Finally, we must show that
for all $(p', x) : P \times X$, 
\[
  (\inl(p) = \inl(p')) = (\inl(p) = \inr(x))
\]
Which is pretty easy to show by some path algebra.


Now, suppose that $A : \UU$ and $B : \modal(A) \to \UU$, and let $f : \prd{a:A}
\modal(B(\eta^{\modal}_{A}(a)))$.  We use pushout induction to construct a map
$\prd{z:\modal A} \modal B(z)$.  When $z \equiv \inl(p)$, $P$ is inhabited, so
$\modal (B (z))$ is contractible and we can return its center.  When $z \equiv
\inr(a)$ then $f(a) : \modal(B(\inr(a)))$ is our element.  For the path,
suppose that $(p, x) : P \times X$.  Then $P$ is contractible, so all of its
higher path spaces are trivial and we're done.  This gives judgemental
computation rule, as well.


Finally, we need to show that $\eta^{\modal}_{z = z'}$ is an equivalence for
all $z, z' : \modal A$.  To define an inverse, suppose that $p : \modal(z =
z')$.  If $p \equiv \inl(p')$, then $P$ is contractible and so is $\modal A$,
so the higher path spaces are trivial and $z = z'$.  If $p \equiv \inr(q)$,
then $q : z = z'$ and we're done.  Finally, supposing that $(p, a) : P \times
A$, $P$ is contractible so $(z = z')$ is as well, so all the paths are trivial.
To show that these are quasi-inverses involves some minor path algebra.  Thus,
$\modal$ is a modality.


Now, to show that it is left exact.


\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdocindent{0.50em}
The\coqdocindent{0.50em}
main\coqdocindent{0.50em}
HoTT\coqdocindent{0.50em}
branch\coqdocindent{0.50em}
just\coqdocindent{0.50em}
added\coqdocindent{0.50em}
this\coqdocindent{0.50em}
definition\coqdocindent{0.50em}
today,\coqdocindent{0.50em}
but\coqdocindent{0.50em}
I\coqdoceol
\coqdocindent{1.50em}
couldn't\coqdocindent{0.50em}
get\coqdocindent{0.50em}
it\coqdocindent{0.50em}
to\coqdocindent{0.50em}
compile\coqdocindent{0.50em}
on\coqdocindent{0.50em}
the\coqdocindent{0.50em}
first\coqdocindent{0.50em}
try\coqdocindent{0.50em}
so\coqdocindent{0.50em}
I'll\coqdocindent{0.50em}
just\coqdocindent{0.50em}
recap\coqdocindent{0.50em}
it.\coqdoceol
\coqdocindent{1.50em}
I\coqdocindent{0.50em}
should\coqdocindent{0.50em}
come\coqdocindent{0.50em}
back\coqdocindent{0.50em}
and\coqdocindent{0.50em}
replace\coqdocindent{0.50em}
this\coqdocindent{0.50em}
with\coqdocindent{0.50em}
the\coqdocindent{0.50em}
real\coqdocindent{0.50em}
thing.\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch07.JoinModality}{JoinModality}{\coqdocmodule{JoinModality}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch07.JoinModality.join}{join}{\coqdocdefinition{join}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) := \coqdocinductive{pushout} (@\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvariable{A} \coqdocvariable{B}) (@\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvariable{A} \coqdocvariable{B}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch07.JoinModality.join mod}{join\_mod}{\coqdocdefinition{join\_mod}} \{\coqdocvar{P} : \coqdockw{Type}\} : \coqdockw{Type} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type} := \coqdockw{fun} \coqdocvar{A} \ensuremath{\Rightarrow} \coqref{Ch07.JoinModality.join}{\coqdocdefinition{join}} \coqdocvariable{P} \coqdocvariable{A}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch07.JoinModality.eta hprop join}{eta\_hprop\_join}{\coqdocdefinition{eta\_hprop\_join}} \{\coqdocvar{P} : \coqdockw{Type}\} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{A} \coqdoceol
\coqdocindent{1.00em}
:= \coqdockw{fun} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocconstructor{push} (@\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{P} \coqdocvariable{A} \coqdocvariable{a}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch07.JoinModality.contr join}{contr\_join}{\coqdoclemma{contr\_join}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) `\{\coqdocabbreviation{Contr} \coqdocvariable{A}\} : \coqdocabbreviation{Contr} (\coqref{Ch07.JoinModality.join}{\coqdocdefinition{join}} \coqdocvariable{A} \coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocconstructor{push} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} (\coqdocmethod{center} \coqdocvar{A}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{y}. \coqdoctac{refine} (\coqdocdefinition{pushout\_rect} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{y}).\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{intros} [\coqdocvar{a} \ensuremath{|} \coqdocvar{b}].\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{apply} \coqdocdefinition{ap}, \coqdocdefinition{ap}, \coqdocmethod{contr}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{exact} (\coqdocaxiom{pp} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocmethod{center} \coqdocvar{A}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}).\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{intros} [\coqdocvar{a} \coqdocvar{b}]. \coqdocvar{cbn}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocdefinition{apD} (\coqdockw{fun} \coqdocvar{a'} \ensuremath{\Rightarrow} \coqdocaxiom{pp} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{a'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}) \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{a}\coqdocnotation{)\^{}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{transport\_paths\_r} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{transport\_paths\_FlFr} \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{a}\coqdocnotation{)\^{}} \coqdocvar{\_}\coqdocnotation{)\^{}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{moveL\_pM}. \coqdoctac{apply} \coqdocdefinition{moveL\_pM}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{ap\_V} \coqdocvar{\_} \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{a}\coqdocnotation{)\^{}}\coqdocnotation{)}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocdefinition{ap} (\coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocdefinition{pushl} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})) \coqdocnotation{(}\coqdocdefinition{inv\_V} \coqdocvar{\_}\coqdocnotation{)\^{}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{moveR\_pV}. \coqdoctac{apply} \coqdocdefinition{moveR\_Mp}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap\_V} \coqdocvar{\_} \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{a}\coqdocnotation{)\^{})\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocdefinition{pushr} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})) (\coqdocdefinition{inv\_V} (\coqdocmethod{contr} \coqdocvar{a}))\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{moveL\_Vp}. \coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{concat\_pp\_p} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{moveR\_pM}. \coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap\_compose} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{unfold} \coqdocdefinition{compose}, \coqdocdefinition{pushl}, \coqdocdefinition{pushr}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{moveL\_pV}. \coqdoctac{apply} \coqdocdefinition{concat2}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{concat\_p1} \coqdocvar{\_}\coqdocnotation{)}). \coqdoctac{apply} \coqdocdefinition{concat2}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{ap\_const}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch07.JoinModality.ind hprop join}{ind\_hprop\_join}{\coqdocdefinition{ind\_hprop\_join}} (\coqdocvar{P} : \coqdockw{Type}) `\{\coqdocabbreviation{IsHProp} \coqdocvariable{P}\} \coqdoceol
\coqdocindent{5.50em}
(\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type})\coqdoceol
\coqdocindent{1.00em}
:  \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, @\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{P} (\coqdocvariable{B} (\coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}} \coqdocvariable{A} \coqdocvariable{a}))\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{3.50em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{\ensuremath{\forall}} \coqdocvar{z} : (@\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{P} \coqdocvariable{A}), (@\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{P} (\coqdocvariable{B} \coqdocvariable{z})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{pushout\_rect} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdoctac{destruct} \coqdocvar{z}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{push}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}} \coqdoctac{in} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{f}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdoctac{destruct} \coqdocvar{z} \coqdockw{as} (\coqdocvar{p}, \coqdocvar{a}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H} : (\coqdocabbreviation{IsHProp} (@\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvar{P} (\coqdocvar{B} (\coqdocdefinition{pushr} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{p}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}))))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}. \coqdoctac{intro} \coqdocvar{b}. \coqdoctac{apply} \coqref{Ch07.JoinModality.contr join}{\coqdoclemma{contr\_join}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{IsHProp0}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch07.JoinModality.ind hprop join compute}{ind\_hprop\_join\_compute}{\coqdoclemma{ind\_hprop\_join\_compute}} (\coqdocvar{P} : \coqdockw{Type}) `\{\coqdocabbreviation{IsHProp} \coqdocvariable{P}\} \coqdoceol
\coqdocindent{1.00em}
: \coqdockw{\ensuremath{\forall}} \coqdocvar{A} \coqdocvar{B} (\coqdocvar{f} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, \coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} (\coqdocvariable{B} (\coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}} \coqdocvariable{A} \coqdocvariable{a}))) \coqdocvar{a},\coqdoceol
\coqdocindent{3.00em}
\coqref{Ch07.JoinModality.ind hprop join}{\coqdocdefinition{ind\_hprop\_join}} \coqdocvariable{P} \coqdocvariable{A} \coqdocvariable{B} \coqdocvariable{f} (\coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}} \coqdocvariable{A} \coqdocvariable{a}) \coqdocnotation{=} \coqdocvariable{f} \coqdocvariable{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch07.JoinModality.isequiv eta hprop join path}{isequiv\_eta\_hprop\_join\_path}{\coqdoclemma{isequiv\_eta\_hprop\_join\_path}} (\coqdocvar{P} : \coqdockw{Type}) (\coqdocvar{HP} : \coqdocabbreviation{IsHProp} \coqdocvariable{P})\coqdoceol
\coqdocindent{1.00em}
: \coqdockw{\ensuremath{\forall}} \coqdocvar{A} (\coqdocvar{z} \coqdocvar{z'} : @\coqref{Ch07.JoinModality.join mod}{\coqdocdefinition{join\_mod}} \coqdocvariable{P} \coqdocvariable{A}), \coqdocclass{IsEquiv} (@\coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}} \coqdocvariable{P} (\coqdocvariable{z} \coqdocnotation{=} \coqdocvariable{z'})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{isequiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{pushout\_rect} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{destruct} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{path\_contr} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch07.JoinModality.contr join}{\coqdoclemma{contr\_join}}. \coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{HP}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{p} \coqdocvar{q}]. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{path\_contr} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocinstance{contr\_paths\_contr} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch07.JoinModality.contr join}{\coqdoclemma{contr\_join}}. \coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{HP}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocdefinition{Sect}. \coqdoctac{refine} (\coqdocdefinition{pushout\_rect} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{destruct} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocaxiom{pp} (\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{p}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocdefinition{path\_contr} \coqdocvar{z} \coqdocvar{z'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocdefinition{pushl}. \coqdocvar{f\_ap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch07.JoinModality.eta hprop join}{\coqdocdefinition{eta\_hprop\_join}}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{p} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{path\_contr} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocinstance{contr\_paths\_contr} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch07.JoinModality.contr join}{\coqdoclemma{contr\_join}}. \coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{HP}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
ismodality\_hprop\_join\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
`\{IsHProp\coqdocindent{0.50em}
P\}\coqdoceol
\coqdocindent{1.00em}
:\coqdocindent{0.50em}
IsModality\coqdocindent{0.50em}
(@join\_mod\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{1.00em}
:=\coqdocindent{0.50em}
@Build\_IsModality\coqdocindent{0.50em}
(@join\_mod\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{11.50em}
(@eta\_hprop\_join\coqdocindent{0.50em}
P)\coqdoceol
\coqdocindent{11.50em}
(@ind\_hprop\_join\coqdocindent{0.50em}
P\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{11.50em}
(@ind\_hprop\_join\_compute\coqdocindent{0.50em}
P\coqdocindent{0.50em}
\_)\coqdoceol
\coqdocindent{11.50em}
(@isequiv\_eta\_hprop\_join\_path\coqdocindent{0.50em}
P\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
islemodality\_hprop\_join\coqdocindent{0.50em}
(P\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
`\{IsHProp\coqdocindent{0.50em}
P\}\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
IsLEModality\coqdocindent{0.50em}
(@join\_mod\coqdocindent{0.50em}
P).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(@BuildIsLEModality\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
ismodality\_hprop\_join.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
IsHProp0.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
preserves\coqdocindent{0.50em}
pullbacks\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intros.\coqdoceol
\coqdocindent{1.00em}
admit.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
preserves\coqdocindent{0.50em}
products\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
intros.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_adjointify\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
intros.\coqdocindent{0.50em}
split.\coqdoceol
\coqdocindent{1.00em}
Admitted.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch07}{\coqdocmodule{JoinModality}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{7.14}{251}  \exer{7.15}{251} \begin{coqdoccode}
\end{coqdoccode}
