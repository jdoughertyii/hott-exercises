\begin{coqdoccode}
\coqdocemptyline
\end{coqdoccode}
\exer{6.3}{217} 
Prove that the torus $T^{2}$ as defined in \S6.6 
is equivalent to $\Sn^{1} \times \Sn^{1}$.


 \soln
We first define $f : T^{2} \to \Sn^{1} \times \Sn^{1}$ by torus recursion,
using the maps
\begin{align*}
  b &\mapsto (\base, \base) \\
  p &\mapsto \pair^{=}(\refl{\base}, \lloop)\\
  q &\mapsto \pair^{=}(\lloop, \refl{\base})\\
  \Phi(\alpha, \alpha) &: \lam{\alpha : x = x'}{\alpha' : y = y'}
    \left(\pair^{=}(\refl{x}, \alpha') \ct \pair^{=}(\alpha, \refl{y'})\right)
    =
    \left(\pair^{=}(\alpha, \refl{y}) \ct \pair^{=}(\refl{x'}, \alpha')\right) \\
  t &\mapsto \Phi(\lloop, \lloop)
\end{align*}
Where $\Phi$ is defined by recursion on $\alpha$ and $\alpha'$.  To define a
function $f : \Sn^{1} \times \Sn^{1} \to T^{2}$, we need a function $\tilde{f}
: \Sn^{1} \to \Sn^{1} \to T^{2}$, which we'll define by double circle
recursion.  $\tilde{f}' : \Sn^{1} \to T^{2}$ is given by $b \mapsto \base$ and
$\lloop \mapsto p$.  Then $\tilde{f}$ is defined by $b \mapsto \tilde{f}'$ and
\begin{align*}
  \lloop &\mapsto 
\end{align*}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Phi}{Phi}{\coqdocdefinition{Phi}} \{\coqdocvar{A} : \coqdockw{Type}\} \{\coqdocvar{x} \coqdocvar{x'} \coqdocvar{y} \coqdocvar{y'} : \coqdocvariable{A}\} (\coqdocvar{alpha} : \coqdocvariable{x} \coqdocnotation{=} \coqdocvariable{x'}) (\coqdocvar{alpha'} : \coqdocvariable{y} \coqdocnotation{=} \coqdocvariable{y'}) \coqdoceol
\coqdocnoindent
: \coqdocnotation{(}\coqdocnotation{(}\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} 1 \coqdocvariable{alpha'}\coqdocnotation{)} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqdocvariable{alpha} 1\coqdocnotation{)}\coqdocnotation{)} \coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{=} \coqdocnotation{(}\coqdocnotation{(}\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqdocvariable{alpha} 1\coqdocnotation{)} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvariable{y'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} 1 \coqdocvariable{alpha'}\coqdocnotation{)}\coqdocnotation{)}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{alpha}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{alpha'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{6.4}{217} 
Define dependent $n$-loops and the action of dependent functions on $n$-loops,
and write down the induction principle for the $n$-spheres as defined at the
end of \S6.4.


 \exer{6.5}{217}
Prove that $\eqv{\susp\Sn^{n}}{\Sn^{n+1}}$, using the definition of $\Sn^{n}$
in terms of $\Omega^{n}$ from \S6.4.


 \soln
This definition defines $\Sn^{n}$ as the higher inductive type generated by



\begin{itemize}
\item  $\base_{n} : \Sn^{n}$

\item  $\lloop_{n} : \Omega^{n}(\Sn^{n}, \base)$.

\end{itemize}
To define a function $\susp\Sn^{n} \to \Sn^{n+1}$, we send both $\north$ and
$\south$ to $\base_{n+1}$.  So we need a function $m : \Sn^{n} \to (\base_{n+1}
= \base_{n+1})$, for which we use $\Sn^{n}$-recursion.


 \exer{6.6}{217} 
Prove that if the type $\Sn^{2}$ belongs to some universe $\UU$, then $\UU$ is
not a 2-type.


 \exer{6.7}{217} 
Prove that if $G$ is a monoid and $x : G$, then $\sm{y:G}((x \cdot y = e)
\times (y \cdot x = e))$ is a mere proposition.  Conclude, using the principle
of unique choice, that it would be equivalent to define a group to be a monoid
such that for every $x : G$, there merely exists a $y : G$ such that $x \cdot y
= e$ and $y \cdot x = e$.


 \soln
Suppose that $G$ is a monoid and $x : G$.  Since $G$ is a set, each of $x
\cdot y = e$ and $y \cdot x = e$ are mere propositions.  The product preserves
this, so our type is of the form $\sm{y : G} P(y)$ for a family of mere
propositions $P : G \to \UU$.  Now, suppose that there is a point $u : \sm{y :
G} P(y)$; we show that this implies that this type is contractible, hence the
type is a mere proposition.  Since $P(y)$ is a mere proposition, we just need
to show that for any point $v : \sm{y : G} P(y)$, $\fst u = \fst v$.  But this
is just to say that if $\fst u$ has an inverse it is unique, and this is a
basic fact about inverses.


A group is defined to be a monoid together with an inversion function $i : G
\to G$ such that for all $x : G$, $x \cdot i(x) = e$ and $i(x) \cdot x = e$.
That is, the following type is inhabited:
\[
  \sm{i : G \to G}\prd{x : G}\left(
    (x \cdot i(x) = e) \times (i(x) \cdot x = e)
  \right)
\]
but this type is equivalent to the type
\[
  \prd{x : G}\sm{y : G}
  \left(
    (x \cdot y = e) \times (y \cdot x = e)
  \right)
\]
And as we have just shown, this is of the form $\prd{x:G} Q(x)$ for $Q$ a
family of mere propositions.  Thus, by the principle of unique choice, it
suffices to demand that for each $x : G$ we have $\brck{Q(x)}$.  Thus these two
requirements are equivalent.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Class} \coqdef{Ch06 3.IsMonoid}{IsMonoid}{\coqdocrecord{IsMonoid}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{m} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}) (\coqdocvar{e} : \coqdocvariable{A}) \coqdoceol
\coqdocindent{1.00em}
:= \coqdef{Ch06 3.BuildIsMonoid}{BuildIsMonoid}{\coqdocconstructor{BuildIsMonoid}} \{\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m isset}{m\_isset}{\coqdocprojection{m\_isset}} : \coqdocabbreviation{IsHSet} \coqdocvariable{A} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m unitr}{m\_unitr}{\coqdocprojection{m\_unitr}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, \coqdocvariable{m} \coqdocvariable{a} \coqdocvariable{e} \coqdocnotation{=} \coqdocvariable{a} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m unitl}{m\_unitl}{\coqdocprojection{m\_unitl}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, \coqdocvariable{m} \coqdocvariable{e} \coqdocvariable{a} \coqdocnotation{=} \coqdocvariable{a} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m assoc}{m\_assoc}{\coqdocprojection{m\_assoc}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z} : \coqdocvariable{A}, \coqdocvariable{m} \coqdocvariable{x} (\coqdocvariable{m} \coqdocvariable{y} \coqdocvariable{z}) \coqdocnotation{=} \coqdocvariable{m} (\coqdocvariable{m} \coqdocvariable{x} \coqdocvariable{y}) \coqdocvariable{z}\coqdoceol
\coqdocindent{3.50em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Record} \coqdef{Ch06 3.Monoid}{Monoid}{\coqdocrecord{Monoid}} \coqdoceol
\coqdocindent{1.00em}
:= \coqdef{Ch06 3.BuildMonoid}{BuildMonoid}{\coqdocconstructor{BuildMonoid}} \{\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m set}{m\_set}{\coqdocprojection{m\_set}} :> \coqdockw{Type} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m mult}{m\_mult}{\coqdocprojection{m\_mult}} :> \coqref{Ch06 3.m set}{\coqdocmethod{m\_set}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch06 3.m set}{\coqdocmethod{m\_set}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch06 3.m set}{\coqdocmethod{m\_set}} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m unit}{m\_unit}{\coqdocprojection{m\_unit}} :> \coqref{Ch06 3.m set}{\coqdocmethod{m\_set}} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.m ismonoid}{m\_ismonoid}{\coqdocprojection{m\_ismonoid}} :> \coqref{Ch06 3.IsMonoid}{\coqdocclass{IsMonoid}} \coqref{Ch06 3.m set}{\coqdocmethod{m\_set}} \coqref{Ch06 3.m mult}{\coqdocmethod{m\_mult}} \coqref{Ch06 3.m unit}{\coqdocmethod{m\_unit}}\coqdoceol
\coqdocindent{3.50em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.hprop inverse exists}{hprop\_inverse\_exists}{\coqdoclemma{hprop\_inverse\_exists}} (\coqdocvar{G} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) (\coqdocvar{x} : \coqdocvariable{G}) :\coqdoceol
\coqdocindent{1.00em}
\coqdocabbreviation{IsHProp} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{y} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{G} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{G} \coqdocvariable{x} \coqdocvar{y} \coqdocnotation{=} \coqdocvariable{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{G} \coqdocvar{y} \coqdocvariable{x} \coqdocnotation{=} \coqdocvariable{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
reduce\coqdocindent{0.50em}
to\coqdocindent{0.50em}
uniqueness\coqdocindent{0.50em}
of\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{y} : \coqdocvar{G}, \coqdocabbreviation{IsHProp} (\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{G} \coqdocvar{x} \coqdocvariable{y} \coqdocnotation{=} \coqdocvar{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{G} \coqdocvariable{y} \coqdocvar{x} \coqdocnotation{=} \coqdocvar{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})). \coqdoctac{intro} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_prod}; \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}; \coqdoctac{apply} \coqdocvar{G}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}. \coqdoctac{intro} \coqdocvar{u}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{u}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{v}. \coqdoctac{apply} \coqdocdefinition{path\_sigma\_hprop}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
is\coqdocindent{0.50em}
unique\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}@\coqref{Ch06 3.m unitr}{\coqdocmethod{m\_unitr}} \coqdocvar{\_} \coqdocvar{G} \coqdocvar{G} \coqdocvar{G} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}@\coqref{Ch06 3.m unitl}{\coqdocmethod{m\_unitl}} \coqdocvar{\_} \coqdocvar{G} \coqdocvar{G} \coqdocvar{G} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{transitivity} (\coqdocvar{G} \coqdocvar{u}\coqdocnotation{.1} (\coqdocvar{G} \coqdocvar{x} \coqdocvar{v}\coqdocnotation{.1})). \coqdocvar{f\_ap}. \coqdoctac{symmetry}. \coqdoctac{apply} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{v}\coqdocnotation{.2}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{transitivity} (\coqdocvar{G} (\coqdocvar{G} \coqdocvar{u}\coqdocnotation{.1} \coqdocvar{x}) \coqdocvar{v}\coqdocnotation{.1}). \coqdoctac{refine} (@\coqref{Ch06 3.m assoc}{\coqdocmethod{m\_assoc}} \coqdocvar{G} \coqdocvar{G} \coqdocvar{G} \coqdocvar{G} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{f\_ap}. \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{u}\coqdocnotation{.2}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Class} \coqdef{Ch06 3.IsGroup}{IsGroup}{\coqdocrecord{IsGroup}} (\coqdocvar{A} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) (\coqdocvar{i} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}) \coqdoceol
\coqdocindent{1.00em}
:= \coqdef{Ch06 3.BuildIsGroup}{BuildIsGroup}{\coqdocconstructor{BuildIsGroup}} \{\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.g invr}{g\_invr}{\coqdocprojection{g\_invr}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, (\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{A}) \coqdocvariable{a} (\coqdocvariable{i} \coqdocvariable{a}) \coqdocnotation{=} \coqdocnotation{(}\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{A}\coqdocnotation{)} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.g invl}{g\_invl}{\coqdocprojection{g\_invl}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvariable{A}, (\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{A}) (\coqdocvariable{i} \coqdocvariable{a}) \coqdocvariable{a} \coqdocnotation{=} \coqdocnotation{(}\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{A}\coqdocnotation{)}\coqdoceol
\coqdocindent{3.50em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Record} \coqdef{Ch06 3.Group}{Group}{\coqdocrecord{Group}} \coqdoceol
\coqdocindent{1.00em}
:= \coqdef{Ch06 3.BuildGroup}{BuildGroup}{\coqdocconstructor{BuildGroup}} \{\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.g monoid}{g\_monoid}{\coqdocprojection{g\_monoid}} :> \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.g inv}{g\_inv}{\coqdocprojection{g\_inv}} :> \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch06 3.m set}{\coqdocprojection{m\_set}} \coqref{Ch06 3.g monoid}{\coqdocmethod{g\_monoid}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch06 3.m set}{\coqdocprojection{m\_set}} \coqref{Ch06 3.g monoid}{\coqdocmethod{g\_monoid}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} ;\coqdoceol
\coqdocindent{4.50em}
\coqdef{Ch06 3.g isgroup}{g\_isgroup}{\coqdocprojection{g\_isgroup}} :> \coqref{Ch06 3.IsGroup}{\coqdocclass{IsGroup}} \coqref{Ch06 3.g monoid}{\coqdocmethod{g\_monoid}} \coqref{Ch06 3.g inv}{\coqdocmethod{g\_inv}}\coqdoceol
\coqdocindent{3.50em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.issig group}{issig\_group}{\coqdoclemma{issig\_group}} `\{\coqdocclass{Funext}\} : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{G} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{i} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{G} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvar{G} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{a}, \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{G} \coqdocvariable{a} (\coqdocvar{i} \coqdocvariable{a}) \coqdocnotation{=} \coqdocvar{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{G} (\coqdocvar{i} \coqdocvariable{a}) \coqdocvariable{a} \coqdocnotation{=} \coqdocvar{G}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}\}}} \coqdoceol
\coqdocindent{2.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch06 3.Group}{\coqdocrecord{Group}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocdefinition{equiv\_compose'} \coqdocvar{\_} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{G} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{i} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{G} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvar{G} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch06 3.IsGroup}{\coqdocclass{IsGroup}} \coqdocvar{G} \coqdocvar{i}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}\}}} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{issig} \coqref{Ch06 3.BuildGroup}{\coqdocconstructor{BuildGroup}} \coqref{Ch06 3.g monoid}{\coqdocprojection{g\_monoid}} \coqref{Ch06 3.g inv}{\coqdocprojection{g\_inv}} \coqref{Ch06 3.g isgroup}{\coqdocprojection{g\_isgroup}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_functor\_sigma\_id}. \coqdoctac{intro} \coqdocvar{G}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_functor\_sigma\_id}. \coqdoctac{intro} \coqdocvar{i}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocdefinition{equiv\_compose'} \coqdocvar{\_}\coqdoceol
\coqdocindent{12.50em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{\_} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{a}, (\coqdocvar{G} \coqdocvariable{a} (\coqdocvar{i} \coqdocvariable{a}) \coqdocnotation{=} \coqdocvar{G})\coqdoceol
\coqdocindent{16.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a} : \coqdocvar{G}, \coqdocvar{G} (\coqdocvar{i} \coqdocvariable{a}) \coqdocvariable{a} \coqdocnotation{=} \coqdocvar{G}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{)\}}}\coqdoceol
\coqdocindent{12.50em}
\coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{issig} (\coqref{Ch06 3.BuildIsGroup}{\coqdocconstructor{BuildIsGroup}} \coqdocvar{G} \coqdocvar{i}) (@\coqref{Ch06 3.g invr}{\coqdocmethod{g\_invr}} \coqdocvar{G} \coqdocvar{i}) (@\coqref{Ch06 3.g invl}{\coqdocmethod{g\_invl}} \coqdocvar{G} \coqdocvar{i}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{intro} \coqdocvar{z}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocnotation{(}\coqdockw{fun} \coqdocvar{a} \ensuremath{\Rightarrow} \coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} (\coqdocvar{z} \coqdocvariable{a})\coqdocnotation{;} \coqdockw{fun} \coqdocvar{a} \ensuremath{\Rightarrow} \coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} (\coqdocvar{z} \coqdocvariable{a})\coqdocnotation{)}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdockw{fun} \coqdocvar{a} \ensuremath{\Rightarrow} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{z}\coqdocnotation{.1} \coqdocvariable{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{z}\coqdocnotation{.2} \coqdocvariable{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{z} \coqdockw{as} [\coqdocvar{g} \coqdocvar{h}]. \coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{\ensuremath{\exists}} 1. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} \coqdocdefinition{eta\_prod}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
ex6\_7\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
\{G\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
x,\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
\{y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
G\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
y\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\}\}\coqdoceol
\coqdocindent{1.00em}
<\~{}>\coqdoceol
\coqdocindent{1.00em}
Group.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(@equiv\_compose'\coqdocindent{0.50em}
\_\coqdoceol
\coqdocindent{12.50em}
\{G\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{13.00em}
forall\coqdocindent{0.50em}
x\coqdocindent{0.50em}
:\coqdocindent{0.50em}
G,\coqdocindent{0.50em}
\{y\coqdocindent{0.50em}
:\coqdocindent{0.50em}
G\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
y\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\}\}\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{12.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(@equiv\_compose'\coqdocindent{0.50em}
\_\coqdoceol
\coqdocindent{12.50em}
\{G\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{12.50em}
\{i\coqdocindent{0.50em}
:\coqdocindent{0.50em}
G\coqdocindent{0.50em}
->\coqdocindent{0.50em}
G\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{13.00em}
forall\coqdocindent{0.50em}
a,\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
a\coqdocindent{0.50em}
(i\coqdocindent{0.50em}
a)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
(i\coqdocindent{0.50em}
a)\coqdocindent{0.50em}
a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\}\}\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{12.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
issig\_group.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_functor\_sigma\_id.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
G.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(BuildEquiv\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(Book\_2\_15\_6\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
x\coqdocindent{0.50em}
y\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)\coqdocindent{0.50em}
*\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
y\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
G)))).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
Book\_2\_15\_7.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_functor\_sigma\_id.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
G.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_functor\_forall\_id.\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
x.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(BuildEquiv\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
min1).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
IsEquivmin1.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_inverse\_exists.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exer{6.8}{217} 
Prove that if $A$ is a set, then $\lst{A}$ is a monoid.  Then complete the
proof of Lemma 6.11.5.


 \soln
We first characterise the path space of $\lst{A}$, which goes just as $\N$.
We define the codes
\begin{align*}
    \codefunc(\nil, \nil) &\defeq \unit \\
    \codefunc(\cons(h, t), \nil) &\defeq \emptyt \\
    \codefunc(\nil, \cons(h', t')) &\defeq \emptyt \\
    \codefunc(\cons(h, t), \cons(h', t')) &\defeq (h=h') \times \codefunc(t, t')
\end{align*}
and the function $r : \prd{\ell : \lst{A}} \codefunc(\ell, \ell)$ by
\begin{align*}
        r(\nil) &\defeq \star \\
        r(\cons(h, t)) &\defeq (\refl{h}, r(t))
\end{align*}
Now, for all $\ell, \ell' : \lst{A}$, $\eqv{(\ell = \ell')}{\codefunc(\ell,
\ell')}$.  To prove this, we define
\[
  \encode(\ell, \ell', p) \defeq \transfib{\codefunc(\ell, -)}{p}{r(\ell)}
\]
and we define $\decode$ by double induction on $\ell, \ell'$.  When they're
both $\nil$, send everything to $\refl{\nil}$.  When one is $\nil$ and the
other a $\cons$, we use the eliminator for $\emptyt$.  When they're both a
cons, we define
\begin{align*}
  \codefunc(\cons(h, t), \cons(h', t'))
  &\equiv
  (h = h') \times \codefunc(t, t') \\
  &\xrightarrow{\idfunc{h=h'} \times \decode(t, t')}
  (h = h') \times (t = t') \\
  &\xrightarrow{\pair^{=}}
  ((h, t) = (h', t')) \\
  &\xrightarrow{\mapfunc{\lam{z}\cons(\fst z, \snd z)}}
  (\cons(h, t) = \cons(h', t'))
\end{align*}
It follows easily from induction on everything and naturality that these are
quasi-inverses.  The only point of note is that the fact that $A$ is a set is
required in the proof of
\[
  \encode(\ell, \ell', \decode(\ell, \ell', z)) = z
\]
This is because our definition of $\encode$ involved an arbitrary choice in
how $r$ acts on $\cons$, and this choice is only preserved up to homotopy.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Open} \coqdockw{Scope} \coqdocvar{list\_scope}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch06 3.list code}{list\_code}{\coqdocdefinition{list\_code}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{l} \coqdocvar{l'} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) : \coqdockw{Type} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{l} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvariable{l'} \coqdockw{with}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \ensuremath{\Rightarrow} \coqdocinductive{Unit}\coqdoceol
\coqdocindent{7.50em}
\ensuremath{|} \coqdocvar{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t'} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{6.50em}
\coqdockw{end}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvariable{l'} \coqdockw{with}\coqdoceol
\coqdocindent{10.00em}
\ensuremath{|} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{10.00em}
\ensuremath{|} \coqdocvar{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t'} \ensuremath{\Rightarrow} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h} \coqdocnotation{=} \coqdocvar{h'}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} \coqdocvar{t} \coqdocvar{t'}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{9.00em}
\coqdockw{end}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch06 3.list r}{list\_r}{\coqdocdefinition{list\_r}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{l} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) : \coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} \coqdocvariable{l} \coqdocvariable{l} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{l} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \ensuremath{\Rightarrow} \coqdocconstructor{tt}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t} \ensuremath{\Rightarrow} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}1\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqref{Ch06 3.list r}{\coqdocdefinition{list\_r}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.list encode}{list\_encode}{\coqdocdefinition{list\_encode}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{l} \coqdocvar{l'} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) (\coqdocvar{p} : \coqdocvariable{l} \coqdocnotation{=} \coqdocvariable{l'}) := \coqdoceol
\coqdocindent{1.00em}
\coqdocdefinition{transport} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} \coqdocvariable{l} \coqdocvariable{x}) \coqdocvariable{p} (\coqref{Ch06 3.list r}{\coqdocdefinition{list\_r}} \coqdocvariable{l}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.list decode}{list\_decode}{\coqdocdefinition{list\_decode}} \{\coqdocvar{A} : \coqdockw{Type}\} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} (\coqdocvar{l} \coqdocvar{l'} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) (\coqdocvar{z} : \coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} \coqdocvariable{l} \coqdocvariable{l'}), \coqdocvariable{l} \coqdocnotation{=} \coqdocvariable{l'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [| \coqdocvar{h} \coqdocvar{t}]; \coqdoctac{destruct} \coqdocvar{l'} \coqdockw{as} [| \coqdocvar{h'} \coqdocvar{t'}]; \coqdoctac{intros}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{reflexivity}. \coqdocvar{contradiction}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (@\coqdocdefinition{ap} \coqdocvar{\_} \coqdocvar{\_} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqexternalref{cons}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{cons}} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvariable{x}) (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvariable{x})) \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_prod}. \coqdoctac{apply} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{z}). \coqdoctac{apply} \coqdocvar{IHt}. \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{z}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.path list}{path\_list}{\coqdocdefinition{path\_list}} \{\coqdocvar{A} : \coqdockw{Type}\} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{h} \coqdocvar{h'} : \coqdocvariable{A}) (\coqdocvar{t} \coqdocvar{t'} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}),\coqdoceol
\coqdocindent{1.00em}
\coqdocvariable{h} \coqdocnotation{=} \coqdocvariable{h'} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{t} \coqdocnotation{=} \coqdocvariable{t'} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvariable{t} \coqdocnotation{=} \coqdocvariable{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvariable{t'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{h} \coqdocvar{h'} \coqdocvar{t} \coqdocvar{t'} \coqdocvar{ph} \coqdocvar{pt}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch06 3.list decode}{\coqdocdefinition{list\_decode}} \coqdocvar{\_} \coqdocvar{\_}). \coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{ph}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch06 3.list encode}{\coqdocdefinition{list\_encode}} \coqdocvar{\_} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{pt}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.equiv path list}{equiv\_path\_list}{\coqdoclemma{equiv\_path\_list}} \{\coqdocvar{A} : \coqdockw{Type}\} \{\coqdocvar{H} : \coqdocabbreviation{IsHSet} \coqdocvariable{A}\} (\coqdocvar{l} \coqdocvar{l'} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) : \coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} \coqdocvariable{l} \coqdocvariable{l'}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{l} \coqdocnotation{=} \coqdocvariable{l'}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} (\coqref{Ch06 3.list decode}{\coqdocdefinition{list\_decode}} \coqdocvar{l} \coqdocvar{l'}) (\coqref{Ch06 3.list encode}{\coqdocdefinition{list\_encode}} \coqdocvar{l} \coqdocvar{l'}) \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
lst\_decode\coqdocindent{0.50em}
o\coqdocindent{0.50em}
lst\_encode\coqdocindent{0.50em}
==\coqdocindent{0.50em}
id\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [|\coqdocvar{h} \coqdocvar{t}]. \coqdoctac{reflexivity}. \coqdoctac{simpl} \coqdoctac{in} *.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{ap\_1} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{transitivity} (\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} 1 1). \coqdocvar{f\_ap}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
lst\_encode\coqdocindent{0.50em}
o\coqdocindent{0.50em}
lst\_decode\coqdocindent{0.50em}
==\coqdocindent{0.50em}
id\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{l'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [|\coqdocvar{h} \coqdocvar{t}], \coqdocvar{l'} \coqdockw{as} [|\coqdocvar{h'} \coqdocvar{t'}]; \coqdoctac{intro} \coqdocvar{z}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocinstance{contr\_unit}. \coqdocvar{contradiction}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{unfold} \coqref{Ch06 3.list encode}{\coqdocdefinition{list\_encode}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{transport\_compose} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{transport\_prod} \coqdoceol
\coqdocindent{7.50em}
(\coqdocdefinition{path\_prod} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{h'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{t'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{z}) (\coqref{Ch06 3.list decode}{\coqdocdefinition{list\_decode}} \coqdocvar{t} \coqdocvar{t'} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{z})))\coqdoceol
\coqdocindent{7.50em}
\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}1\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqref{Ch06 3.list r}{\coqdocdefinition{list\_r}} \coqdocvar{t}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{z} \coqdockw{as} [\coqdocvar{p} \coqdocvar{c}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_prod}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{transport\_path\_prod} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{induction} \coqdocvar{p}. \coqdoctac{apply} (\coqdocvar{IHt} \coqdocvar{t'}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\noindent
It's now easy to see that $\lst{A}$ is a set, by induction.
If $\ell \equiv \ell' \equiv \nil$, then $\eqv{(\ell = \ell')}{\unit}$, which
is contractible.
Similarly, if only one is $\nil$ then $\eqv{(\ell = \ell')}{\emptyt}$, which
is contractible.
Finally, if both are $\cons$es, then the path space is $(h = h') \times
\codefunc(t, t')$.  The former is contractible because $A$ is a set, and the
latter is contractible by the induction hypothesis.  Contractibility is
preserved by products, so the path space is contractible.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.set list is set}{set\_list\_is\_set}{\coqdoclemma{set\_list\_is\_set}} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} (\coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HA} \coqdocvar{l}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [|\coqdocvar{h} \coqdocvar{t}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intro} \coqdocvar{l'}; \coqdoctac{destruct} \coqdocvar{l'} \coqdockw{as} [|\coqdocvar{h'} \coqdocvar{t'}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{trunc\_equiv} (\coqref{Ch06 3.equiv path list}{\coqdoclemma{equiv\_path\_list}} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{trunc\_equiv} (\coqref{Ch06 3.equiv path list}{\coqdoclemma{equiv\_path\_list}} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} (\coqdocvar{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t'}))).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intro} \coqdocvar{l'}; \coqdoctac{destruct} \coqdocvar{l'} \coqdockw{as} [|\coqdocvar{h'} \coqdocvar{t'}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{trunc\_equiv} (\coqref{Ch06 3.equiv path list}{\coqdoclemma{equiv\_path\_list}} (\coqdocvar{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t}) \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}})).\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{r} : (\coqdocabbreviation{IsHProp} (\coqref{Ch06 3.list code}{\coqdocdefinition{list\_code}} (\coqdocvar{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t}) (\coqdocvar{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t'})))).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdoclemma{hprop\_prod}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdocvar{HA}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{trunc\_equiv} \coqdocnotation{(}\coqref{Ch06 3.equiv path list}{\coqdoclemma{equiv\_path\_list}} \coqdocvar{t} \coqdocvar{t'}\coqdocnotation{)\^{}-1}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{trunc\_equiv} (\coqref{Ch06 3.equiv path list}{\coqdoclemma{equiv\_path\_list}} (\coqdocvar{h} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t}) (\coqdocvar{h'} \coqexternalref{:list scope:x '::' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{::}} \coqdocvar{t'}))).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Now, to show that $\lst{A}$ is a monoid, we must equip it with a
multiplication function and a unit element.  For the multiplication function we
use append, and for the unit we use $\nil$.  These must satisfy two properties.
First we must have, for all $\ell : \lst{A}$, $\ell \cdot \nil = \nil \cdot
\ell = \ell$, which we clearly do.  Second, append must be associative, which
it clearly is.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdocindent{0.50em}
move\coqdocindent{0.50em}
these\coqdocindent{0.50em}
elsewhere\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.app nil r}{app\_nil\_r}{\coqdoclemma{app\_nil\_r}} \{\coqdocvar{A} : \coqdockw{Type}\} : \coqdockw{\ensuremath{\forall}} \coqdocvar{l} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}, \coqdocvariable{l} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{++}} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}} \coqdocnotation{=} \coqdocvariable{l}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{induction} \coqdocvar{l}. \coqdoctac{reflexivity}. \coqdoctac{simpl}. \coqdocvar{f\_ap}. \coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.app assoc}{app\_assoc}{\coqdoclemma{app\_assoc}} \{\coqdocvar{A} : \coqdockw{Type}\} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z} : \coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A},\coqdoceol
\coqdocindent{1.00em}
\coqdocvariable{x} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{++}} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{y} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{++}} \coqdocvariable{z}\coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqdocnotation{=} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{x} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{++}} \coqdocvariable{y}\coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:list scope:x '++' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{++}} \coqdocvariable{z}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{z}. \coqdoctac{induction} \coqdocvar{x}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqref{Ch06 3.path list}{\coqdocdefinition{path\_list}}. \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{IHx}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.set list is monoid}{set\_list\_is\_monoid}{\coqdoclemma{set\_list\_is\_monoid}} \{\coqdocvar{A} : \coqdockw{Type}\} \{\coqdocvar{HA} : \coqdocabbreviation{IsHSet} \coqdocvariable{A}\} : \coqdoceol
\coqdocindent{1.00em}
\coqref{Ch06 3.IsMonoid}{\coqdocclass{IsMonoid}} (\coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) (@\coqexternalref{app}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocdefinition{app}} \coqdocvariable{A}) \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch06 3.BuildIsMonoid}{\coqdocconstructor{BuildIsMonoid}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch06 3.set list is set}{\coqdoclemma{set\_list\_is\_set}}. \coqdoctac{apply} \coqdocvar{HA}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch06 3.app nil r}{\coqdoclemma{app\_nil\_r}}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch06 3.app assoc}{\coqdoclemma{app\_assoc}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Now, Lemma 6.11.5 states that for any set $A$, the type $\lst{A}$ is the
free monoid on $A$.  That is, there is an equivalence
\[
  \eqv{
    \hom_{\text{Monoid}}(\lst{A}, G)
  }{
    (A \to G)
  }
\]
There is an obvious inclusion $\eta : A \to \lst{A}$ defined by $a \mapsto
\cons(a, \nil)$, and this defines a map $({-} \circ \eta)$ giving the forward
direction of the equivalence.  For the other direction, suppose that $f : A \to
G$.  We lift this to a map $\bar{f} : \lst{A} \to G$ by recursion:
\begin{align*}
  \bar{f}(\nil) &\defeq e \\
  \bar{f}(\cons(h, t)) &\defeq f(h) \cdot \bar{f}(t)
\end{align*}
To show that this is a monoid homomorphism, we must show
\begin{align*}
  \bar{f}(\nil) &= e \\
  \bar{f}(\ell \cdot \ell') &= \bar{f}(\ell) \cdot \bar{f}(\ell')
\end{align*}
The first is a judgemental equality, so we just need to show the second, which
we do by induction on $\ell$.  When $\ell \equiv \nil$ we have
\[
  \bar{f}(\nil \cdot \ell')
  \equiv
  \bar{f}(\ell')
  =
  e \cdot \bar{f}(\ell')
  \equiv
  \bar{f}(\nil) \cdot \bar{f}(\ell')
\]
and when it is a cons,
\begin{align*}
  \bar{f}(\cons(h, t) \cdot \ell')
  &=
  \bar{f}(\cons(h, t \cdot \ell'))
  =
  f(h) \cdot \bar{f}(t \cdot \ell')
  =
  f(h) \cdot \bar{f}(t) \cdot \bar{f}(\ell')
  =
  f(\cons(h, t)) \cdot \bar{f}(\ell')
\end{align*}
by the induction hypothesis in the third equality.  So $\bar{f}$ is a monoid
homomorphism.


To show that these are quasi-inverses, suppose that $f :
\hom_{\text{Monoid}}(\lst{A}, G)$.  Then we must show that
\[
  \overline{f \circ \eta} = f
\]
which we do by function extensionality and induction.  When $\ell \equiv \nil$,
we have
\[
  \overline{f \circ \eta}(\nil) \equiv e = f(\nil)
\]
Since $f$ is a monoid homomorphism.  When $\ell \equiv \cons(h, t)$,
\begin{align*}
  \overline{f \circ \eta}(\cons(h, t))
  &\equiv
  f(\eta(h))
  \cdot
  \overline{f \circ \eta}(t)
  =
  f(\eta(h))
  \cdot
  f(t)
  =
  f(\cons(h, \nil) \cdot t)
  \equiv
  f(\cons(h, t))
\end{align*}
So by function extensionality $\overline{f \circ \eta} = f$.  We must
also show that the proofs that $\overline{f \circ \eta}$ and $f$ are
monoid homomorphisms are equal.  This turns out to be trivial,
however: since monoids are structures on sets, all of the relevant
proofs are of equalities in sets, so the structures are mere
propositions, and equality of the underlying maps is equivalent to
equality of the homomorphisms.


For the other direction, suppose that $f : A \to G$.  We show that
\[
  \bar{f} \circ \eta = f
\]
again by function extensionality.  Suppose that $a : A$; then
\[
  \bar{f}(\eta(a)) 
  \equiv \bar{f}(\cons(a, \nil))
  \equiv f(a) \cdot \bar{f}(\nil)
  \equiv f(a) \cdot e
  = f(a)
\]
and we're done.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} \coqdef{Ch06 3.:16186}{"}{"}[ ]" := \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}}.\coqdoceol
\coqdocnoindent
\coqdockw{Notation} \coqdef{Ch06 3.:16209}{"}{"}[ x ; .. ; y ]" := (\coqexternalref{cons}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{cons}} \coqdocvar{x} .. (\coqexternalref{cons}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{cons}} \coqdocvar{y} \coqexternalref{nil}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{nil}}) ..).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Class} \coqdef{Ch06 3.IsMonoidHom}{IsMonoidHom}{\coqdocrecord{IsMonoidHom}} \{\coqdocvar{A} \coqdocvar{B} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}\} (\coqdocvar{f} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdef{Ch06 3.BuildIsMonoidHom}{BuildIsMonoidHom}{\coqdocconstructor{BuildIsMonoidHom}} \{\coqdoceol
\coqdocindent{3.00em}
\coqdef{Ch06 3.hunit}{hunit}{\coqdocprojection{hunit}} : \coqdocvariable{f} (\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{A}) \coqdocnotation{=} \coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{B} ;\coqdoceol
\coqdocindent{3.00em}
\coqdef{Ch06 3.hmult}{hmult}{\coqdocprojection{hmult}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{a'} : \coqdocvariable{A}, \coqdocvariable{f} ((\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{A}) \coqdocvariable{a} \coqdocvariable{a'}) \coqdocnotation{=} (\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{B}) (\coqdocvariable{f} \coqdocvariable{a}) (\coqdocvariable{f} \coqdocvariable{a'})\coqdoceol
\coqdocindent{2.00em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Record} \coqdef{Ch06 3.MonoidHom}{MonoidHom}{\coqdocrecord{MonoidHom}} (\coqdocvar{A} \coqdocvar{B} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) := \coqdoceol
\coqdocindent{1.00em}
\coqdef{Ch06 3.BuildMonoidHom}{BuildMonoidHom}{\coqdocconstructor{BuildMonoidHom}} \{\coqdoceol
\coqdocindent{3.00em}
\coqdef{Ch06 3.mhom fun}{mhom\_fun}{\coqdocprojection{mhom\_fun}} :> \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B} ;\coqdoceol
\coqdocindent{3.00em}
\coqdef{Ch06 3.mhom ismhom}{mhom\_ismhom}{\coqdocprojection{mhom\_ismhom}} :> \coqref{Ch06 3.IsMonoidHom}{\coqdocclass{IsMonoidHom}} \coqref{Ch06 3.mhom fun}{\coqdocmethod{mhom\_fun}}\coqdoceol
\coqdocindent{2.00em}
\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.homLAG to AG}{homLAG\_to\_AG}{\coqdocdefinition{homLAG\_to\_AG}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{IsHSet} \coqdocvariable{A}) (\coqdocvar{G} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) :\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch06 3.MonoidHom}{\coqdocrecord{MonoidHom}} (\coqref{Ch06 3.BuildMonoid}{\coqdocconstructor{BuildMonoid}} (\coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch06 3.set list is monoid}{\coqdoclemma{set\_list\_is\_monoid}}) \coqdocvariable{G} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{G}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
:= \coqdockw{fun} \coqdocvar{f} \coqdocvar{a} \ensuremath{\Rightarrow} (\coqref{Ch06 3.mhom fun}{\coqdocprojection{mhom\_fun}} \coqdocvar{\_} \coqdocvariable{G} \coqdocvariable{f}) \coqref{Ch06 3.::'[' x ';' '..' ';' x ']'}{\coqdocnotation{[}}\coqdocvariable{a}\coqref{Ch06 3.::'[' x ';' '..' ';' x ']'}{\coqdocnotation{]}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.AG to homLAG}{AG\_to\_homLAG}{\coqdocdefinition{AG\_to\_homLAG}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{IsHSet} \coqdocvariable{A}) (\coqdocvar{G} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{G}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch06 3.MonoidHom}{\coqdocrecord{MonoidHom}} (\coqref{Ch06 3.BuildMonoid}{\coqdocconstructor{BuildMonoid}} (\coqexternalref{list}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{list}} \coqdocvariable{A}) \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch06 3.set list is monoid}{\coqdoclemma{set\_list\_is\_monoid}}) \coqdocvariable{G}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
lift\coqdocindent{0.50em}
f\coqdocindent{0.50em}
by\coqdocindent{0.50em}
recursion\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqref{Ch06 3.BuildMonoidHom}{\coqdocconstructor{BuildMonoidHom}} \coqdocvar{\_} \coqdocvar{G} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [|\coqdocvar{h} \coqdocvar{t}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvar{G}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} ((\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvar{\_}) (\coqdocvar{f} \coqdocvar{h}) \coqdocvar{IHt}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch06 3.BuildIsMonoidHom}{\coqdocconstructor{BuildIsMonoidHom}}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
takes\coqdocindent{0.50em}
the\coqdocindent{0.50em}
unit\coqdocindent{0.50em}
to\coqdocindent{0.50em}
the\coqdocindent{0.50em}
unit\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
respects\coqdocindent{0.50em}
multiplication\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{intro} \coqdocvar{l}. \coqdoctac{induction} \coqdocvar{l}. \coqdoctac{intro} \coqdocvar{l'}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqref{Ch06 3.m unitl}{\coqdocmethod{m\_unitl}} \coqdocvar{\_}\coqdocnotation{)\^{}}). \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{G}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{l'}. \coqdoctac{simpl}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqref{Ch06 3.m assoc}{\coqdocmethod{m\_assoc}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{f\_ap}. \coqdoctac{apply} (\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{G}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.isprod ismonoidhom}{isprod\_ismonoidhom}{\coqdoclemma{isprod\_ismonoidhom}} \{\coqdocvar{A} \coqdocvar{B} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}\} (\coqdocvar{f} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{f} (\coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{A}) \coqdocnotation{=} \coqref{Ch06 3.m unit}{\coqdocprojection{m\_unit}} \coqdocvariable{B}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{a'}, \coqdocvariable{f} ((\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{A}) \coqdocvariable{a} \coqdocvariable{a'}) \coqdocnotation{=} (\coqref{Ch06 3.m mult}{\coqdocprojection{m\_mult}} \coqdocvariable{B}) (\coqdocvariable{f} \coqdocvariable{a}) (\coqdocvariable{f} \coqdocvariable{a'})\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch06 3.IsMonoidHom}{\coqdocclass{IsMonoidHom}} \coqdocvariable{f}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
I\coqdocindent{0.50em}
think\coqdocindent{0.50em}
this\coqdocindent{0.50em}
should\coqdocindent{0.50em}
be\coqdocindent{0.50em}
a\coqdocindent{0.50em}
judgemental\coqdocindent{0.50em}
equality,\coqdocindent{0.50em}
but\coqdocindent{0.50em}
it's\coqdocindent{0.50em}
not\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{etransitivity} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{\_} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{f} \coqdocvar{A} \coqdocnotation{=} \coqdocvar{B} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{a} \coqdocvar{a'} : \coqdocvar{A}, \coqdocvar{f} (\coqdocvar{A} \coqdocvariable{a} \coqdocvariable{a'}) \coqdocnotation{=} \coqdocvar{B} (\coqdocvar{f} \coqdocvariable{a}) (\coqdocvar{f} \coqdocvariable{a'})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}); \coqdoctac{intro} \coqdocvar{z}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{z}). \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{z}). \coqdoctac{apply} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{z}\coqdocnotation{.1}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{z}\coqdocnotation{.2}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{eta\_sigma}. \coqdoctac{apply} \coqdocdefinition{eta\_prod}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{issig} (\coqref{Ch06 3.BuildIsMonoidHom}{\coqdocconstructor{BuildIsMonoidHom}} \coqdocvar{A} \coqdocvar{B} \coqdocvar{f}) (@\coqref{Ch06 3.hunit}{\coqdocmethod{hunit}} \coqdocvar{A} \coqdocvar{B} \coqdocvar{f}) (@\coqref{Ch06 3.hmult}{\coqdocmethod{hmult}} \coqdocvar{A} \coqdocvar{B} \coqdocvar{f}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
hprop\_ismonoidhom\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid\}\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
:\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHProp\coqdocindent{0.50em}
(IsMonoidHom\coqdocindent{0.50em}
f).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(trunc\_equiv'\coqdocindent{0.50em}
(isprod\_ismonoidhom\coqdocindent{0.50em}
f)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
hprop\_prod.\coqdoceol
\coqdocindent{1.00em}
intros\coqdocindent{0.50em}
p\coqdocindent{0.50em}
q.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
B.\coqdoceol
\coqdocindent{1.00em}
repeat\coqdocindent{0.50em}
(apply\coqdocindent{0.50em}
hprop\_dependent;\coqdocindent{0.50em}
intro).\coqdocindent{0.50em}
intros\coqdocindent{0.50em}
p\coqdocindent{0.50em}
q.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
B.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.issig monoidhom}{issig\_monoidhom}{\coqdoclemma{issig\_monoidhom}} (\coqdocvar{A} \coqdocvar{B} : \coqref{Ch06 3.Monoid}{\coqdocrecord{Monoid}}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{f} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch06 3.IsMonoidHom}{\coqdocclass{IsMonoidHom}} \coqdocvar{f}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch06 3.MonoidHom}{\coqdocrecord{MonoidHom}} \coqdocvariable{A} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{issig} (\coqref{Ch06 3.BuildMonoidHom}{\coqdocconstructor{BuildMonoidHom}} \coqdocvar{A} \coqdocvar{B}) (@\coqref{Ch06 3.mhom fun}{\coqdocprojection{mhom\_fun}} \coqdocvar{A} \coqdocvar{B}) (@\coqref{Ch06 3.mhom ismhom}{\coqdocprojection{mhom\_ismhom}} \coqdocvar{A} \coqdocvar{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
equiv\_path\_monoidhom\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid\}\coqdocindent{0.50em}
\{f\coqdocindent{0.50em}
g\coqdocindent{0.50em}
:\coqdocindent{0.50em}
MonoidHom\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B\}\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
((mhom\_fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
f)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
(mhom\_fun\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
g))\coqdocindent{0.50em}
<\~{}>\coqdocindent{0.50em}
f\coqdocindent{0.50em}
=\coqdocindent{0.50em}
g.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
equiv\_via\coqdocindent{0.50em}
((issig\_monoidhom\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B)\^{}-1\coqdocindent{0.50em}
f\coqdocindent{0.50em}
=\coqdocindent{0.50em}
(issig\_monoidhom\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B)\^{}-1\coqdocindent{0.50em}
g).\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(@equiv\_path\_sigma\_hprop\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{6.00em}
(A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
IsMonoidHom\coqdocindent{0.50em}
hprop\_ismonoidhom\coqdoceol
\coqdocindent{6.00em}
((issig\_monoidhom\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B)\^{}-1\coqdocindent{0.50em}
f)\coqdocindent{0.50em}
((issig\_monoidhom\coqdocindent{0.50em}
A\coqdocindent{0.50em}
B)\^{}-1\coqdocindent{0.50em}
g)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
equiv\_inverse.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_ap.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
\_.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
list\_is\_free\_monoid\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type)\coqdocindent{0.50em}
(HA\coqdocindent{0.50em}
:\coqdocindent{0.50em}
IsHSet\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Monoid)\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
MonoidHom\coqdocindent{0.50em}
(BuildMonoid\coqdocindent{0.50em}
(list\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
set\_list\_is\_monoid)\coqdocindent{0.50em}
G\coqdocindent{0.50em}
<\~{}>\coqdocindent{0.50em}
(A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
G).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
transparent\coqdocindent{0.50em}
assert\coqdocindent{0.50em}
(HG\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(IsMonoid\coqdocindent{0.50em}
G\coqdocindent{0.50em}
G\coqdocindent{0.50em}
G)).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
G.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_adjointify\coqdocindent{0.50em}
(homLAG\_to\_AG\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
(AG\_to\_homLAG\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdoceol
\coqdocindent{1.00em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(m\_unitr\coqdocindent{0.50em}
\_).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
equiv\_path\_monoidhom.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
l.\coqdoceol
\coqdocindent{1.00em}
induction\coqdocindent{0.50em}
l\coqdocindent{0.50em}
as\coqdocindent{0.50em}
\ensuremath{|}\coqdocvar{h} \coqdocvar{t};\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
symmetry.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(@hunit\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
f).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
f.\coqdoceol
\coqdocindent{1.00em}
transitivity\coqdocindent{0.50em}
(G\coqdocindent{0.50em}
(homLAG\_to\_AG\coqdocindent{0.50em}
A\coqdocindent{0.50em}
HA\coqdocindent{0.50em}
G\coqdocindent{0.50em}
f\coqdocindent{0.50em}
h)\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
t)).\coqdocindent{0.50em}
f\_ap.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
homLAG\_to\_AG.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(@hmult\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
f\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\coqdocvar{h}\coqdocindent{0.50em}
t)\^{}.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
f.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Close} \coqdockw{Scope} \coqdocvar{list\_scope}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{6.9}{217} 
Assuming $\LEM{}$, construct a family $f : \prd{X : \UU} (X \to X)$ such that
$f_{\bool} : \bool \to \bool$ is the nonidentity automorphism.


 \exer{6.10}{218} 
Show that the map constructed in Lemma 6.3.2 is in fact a quasi-inverse to
$\happly$, so that the interval type implies the full function extensionality
axiom.


 \soln
Of course, it's easiest to prove the full function extensionality axiom by
referring to Exercise 2.16.  But we want to show something more: that this map
is an inverse to $\happly$.
Let $f, g : A \to B$, and suppose that $p : f = g$.  Then $\happly(p) :
\prd{x:A}f(x) = g(x)$.  For all $x : A$ we define a function $\tilde{h} : I \to
B$ by
\begin{align*}
 \tilde{h}_{x}(0_{I}) &\defeq f(x),  \\
 \tilde{h}_{x}(1_{I}) &\defeq g(x),  \\
 \mapfunc{\tilde{h}_{x}}(\seg) &\defeq \happly(p, x)
\end{align*}
and we define $q : I \to (A \to B)$ by $q(i) \defeq \lam{x}\tilde{h}_{x}(i)$.
Thus
\[
  \mapfunc{q}(\seg) \equiv \mapfunc{\lam{x}\tilde{h}_{x}}(\seg)
\]
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch06 3.Exercise6 10}{Exercise6\_10}{\coqdocmodule{Exercise6\_10}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch06 3.Exercise6 10.Interval}{Interval}{\coqdocmodule{Interval}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdocvar{Private} \coqdockw{Inductive} \coqdef{Ch06 3.Exercise6 10.Interval.interval}{interval}{\coqdocinductive{interval}} : \coqdockw{Type} :=\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdef{Ch06 3.Exercise6 10.Interval.zero}{zero}{\coqdocconstructor{zero}} : \coqref{Ch06 3.interval}{\coqdocinductive{interval}}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdef{Ch06 3.Exercise6 10.Interval.one}{one}{\coqdocconstructor{one}} : \coqref{Ch06 3.interval}{\coqdocinductive{interval}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Axiom} \coqdef{Ch06 3.Exercise6 10.Interval.seg}{seg}{\coqdocaxiom{seg}} : \coqref{Ch06 3.Exercise6 10.Interval.zero}{\coqdocconstructor{zero}} \coqdocnotation{=} \coqref{Ch06 3.Exercise6 10.Interval.one}{\coqdocconstructor{one}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 10.Interval.interval rect}{interval\_rect}{\coqdocdefinition{interval\_rect}} (\coqdocvar{P} : \coqref{Ch06 3.Exercise6 10.Interval.interval}{\coqdocinductive{interval}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type})\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{a} : \coqdocvariable{P} \coqref{Ch06 3.Exercise6 10.Interval.zero}{\coqdocconstructor{zero}}) (\coqdocvar{b} : \coqdocvariable{P} \coqref{Ch06 3.Exercise6 10.Interval.one}{\coqdocconstructor{one}}) (\coqdocvar{p} : \coqref{Ch06 3.Exercise6 10.Interval.seg}{\coqdocaxiom{seg}} \coqdocnotation{\#} \coqdocvariable{a} \coqdocnotation{=} \coqdocvariable{b})\coqdoceol
\coqdocindent{1.00em}
: \coqdockw{\ensuremath{\forall}} \coqdocvar{x} : \coqref{Ch06 3.Exercise6 10.Interval.interval}{\coqdocinductive{interval}}, \coqdocvariable{P} \coqdocvariable{x}\coqdoceol
\coqdocindent{1.00em}
:= \coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} (\coqdockw{match} \coqdocvariable{x} \coqdockw{return} \coqdocvar{\_} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P} \coqdocvariable{x} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqref{Ch06 3.Exercise6 10.Interval.zero}{\coqdocconstructor{zero}} \ensuremath{\Rightarrow} \coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvariable{a}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \coqref{Ch06 3.Exercise6 10.Interval.one}{\coqdocconstructor{one}} \ensuremath{\Rightarrow} \coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvariable{b}\coqdoceol
\coqdocindent{7.50em}
\coqdockw{end}) \coqdocvariable{p}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Axiom} \coqdef{Ch06 3.Exercise6 10.Interval.interval rect beta seg}{interval\_rect\_beta\_seg}{\coqdocaxiom{interval\_rect\_beta\_seg}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{P} : \coqref{Ch06 3.Exercise6 10.Interval.interval}{\coqdocinductive{interval}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type})\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{a} : \coqdocvariable{P} \coqref{Ch06 3.Exercise6 10.Interval.zero}{\coqdocconstructor{zero}}) (\coqdocvar{b} : \coqdocvariable{P} \coqref{Ch06 3.Exercise6 10.Interval.one}{\coqdocconstructor{one}}) (\coqdocvar{p} : \coqref{Ch06 3.Exercise6 10.Interval.seg}{\coqdocaxiom{seg}} \coqdocnotation{\#} \coqdocvariable{a} \coqdocnotation{=} \coqdocvariable{b}),\coqdoceol
\coqdocindent{1.00em}
\coqdocdefinition{apD} (\coqref{Ch06 3.Exercise6 10.Interval.interval rect}{\coqdocdefinition{interval\_rect}} \coqdocvariable{P} \coqdocvariable{a} \coqdocvariable{b} \coqdocvariable{p}) \coqref{Ch06 3.Exercise6 10.Interval.seg}{\coqdocaxiom{seg}} \coqdocnotation{=} \coqdocvariable{p}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch06 3.Interval}{\coqdocmodule{Interval}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 10.interval rectnd}{interval\_rectnd}{\coqdocdefinition{interval\_rectnd}} (\coqdocvar{P} : \coqdockw{Type}) (\coqdocvar{a} \coqdocvar{b} : \coqdocvariable{P}) (\coqdocvar{p} : \coqdocvariable{a} \coqdocnotation{=} \coqdocvariable{b})\coqdoceol
\coqdocindent{1.00em}
: \coqdocinductive{interval} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}\coqdoceol
\coqdocindent{1.00em}
:= \coqdocdefinition{interval\_rect} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvariable{P}) \coqdocvariable{a} \coqdocvariable{b} (\coqdocdefinition{transport\_const} \coqdocvar{\_} \coqdocvar{\_} \coqdocnotation{@} \coqdocvariable{p}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 10.interval rectnd beta seg}{interval\_rectnd\_beta\_seg}{\coqdocdefinition{interval\_rectnd\_beta\_seg}} (\coqdocvar{P} : \coqdockw{Type}) (\coqdocvar{a} \coqdocvar{b} : \coqdocvariable{P}) (\coqdocvar{p} : \coqdocvariable{a} \coqdocnotation{=} \coqdocvariable{b})\coqdoceol
\coqdocindent{1.00em}
: \coqdocdefinition{ap} (\coqref{Ch06 3.Exercise6 10.interval rectnd}{\coqdocdefinition{interval\_rectnd}} \coqdocvariable{P} \coqdocvariable{a} \coqdocvariable{b} \coqdocvariable{p}) \coqdocaxiom{seg} \coqdocnotation{=} \coqdocvariable{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdoclemma{cancelL} (\coqdocdefinition{transport\_const} \coqdocaxiom{seg} \coqdocvar{a}) \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{apD\_const} (\coqdocdefinition{interval\_rect} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{P}) \coqdocvar{a} \coqdocvar{b} \coqdocvar{\_}) \coqdocaxiom{seg}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocaxiom{interval\_rect\_beta\_seg} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{P}) \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 10.interval path arrow}{interval\_path\_arrow}{\coqdocdefinition{interval\_path\_arrow}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} \{\coqdocvar{f} \coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}\} \coqdoceol
\coqdocindent{1.00em}
: \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{f} \coqdocnotation{\ensuremath{\sim}} \coqdocvariable{g}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{f} \coqdocnotation{=} \coqdocvariable{g}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
:= \coqdockw{fun} \coqdocvar{p} \ensuremath{\Rightarrow} \coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{i} \coqdocvar{a} \ensuremath{\Rightarrow} \coqref{Ch06 3.Exercise6 10.interval rectnd}{\coqdocdefinition{interval\_rectnd}} \coqdocvariable{B} (\coqdocvariable{f} \coqdocvariable{a}) (\coqdocvariable{g} \coqdocvariable{a}) (\coqdocvariable{p} \coqdocvariable{a}) \coqdocvariable{i}) \coqdocaxiom{seg}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.Exercise6 10.ex6 10 alpha}{ex6\_10\_alpha}{\coqdoclemma{ex6\_10\_alpha}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} \{\coqdocvar{f} \coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}\} \coqdoceol
\coqdocindent{1.00em}
: \coqdocnotation{(}@\coqdocdefinition{ap10} \coqdocvariable{A} \coqdocvariable{B} \coqdocvariable{f} \coqdocvariable{g}\coqdocnotation{)} \coqdocnotation{o} \coqdocnotation{(}@\coqref{Ch06 3.Exercise6 10.interval path arrow}{\coqdocdefinition{interval\_path\_arrow}} \coqdocvariable{A} \coqdocvariable{B} \coqdocvariable{f} \coqdocvariable{g}\coqdocnotation{)} \coqdocnotation{\ensuremath{\sim}} \coqdocabbreviation{idmap}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.Exercise6 10.ex6 10 beta}{ex6\_10\_beta}{\coqdoclemma{ex6\_10\_beta}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} \{\coqdocvar{f} \coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}\} \coqdoceol
\coqdocindent{1.00em}
: \coqdocnotation{(}@\coqref{Ch06 3.Exercise6 10.interval path arrow}{\coqdocdefinition{interval\_path\_arrow}} \coqdocvariable{A} \coqdocvariable{B} \coqdocvariable{f} \coqdocvariable{g}\coqdocnotation{)} \coqdocnotation{o} \coqdocnotation{(}@\coqdocdefinition{ap10} \coqdocvariable{A} \coqdocvariable{B} \coqdocvariable{f} \coqdocvariable{g}\coqdocnotation{)} \coqdocnotation{\ensuremath{\sim}} \coqdocabbreviation{idmap}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{unfold} \coqdocdefinition{compose}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{q} := (\coqdockw{fun} \coqdocvar{i} \coqdocvar{a} \ensuremath{\Rightarrow} \coqref{Ch06 3.Exercise6 10.interval rectnd}{\coqdocdefinition{interval\_rectnd}} \coqdocvar{B} (\coqdocvar{f} \coqdocvariable{a}) (\coqdocvar{g} \coqdocvariable{a}) (\coqdocdefinition{ap10} \coqdocvar{p} \coqdocvariable{a}) \coqdocvariable{i})).\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch06 3}{\coqdocmodule{Exercise6\_10}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{6.11}{218} 
Prove the universal property of suspension:
\[
  \eqv{ \left(\susp A \to B \right) }{ \left(\sm{b_{n} : B}\sm{b_{s} : B} (A \to (b_{n} = b_{s}))\right) }
\]


 \soln
To construct an equivalence, suppose that $f : \susp A \to B$.  Then there are
two elements $f(\north), f(\south) : B$ such that there is a map $A \to
(f(\north) = f(\south))$; in particular for any element $a : A$ we have the
element $\merid(a) : (\north = \south)$ which may be pushed forward to give
$f(\merid(a)) : f(\north) = f(\south)$.  For the other direction, suppose that
we have elements $b_{n}, b_{s} : B$ such that $f : A \to (b_{n} = b_{s})$.
Then by suspension recursion we define a function $g : \susp A \to B$ such that
$g(\north) \equiv b_{n}$, $g(\south) \equiv b_{s}$, and $g(\merid(a)) = f(a)$
for all $a : \susp A$.


To show that these are quasi-inverses, suppose that $f : \susp A \to B$.  We
then construct the element $(f(\north), f(\south), \lam{a}f(\merid(a)))$ of the
codomain, and going back gives a function $g : \susp A \to B$ such that
$g(\north) \equiv f(\north)$, $g(\south) \equiv f(\south)$, and $g(\merid(a)) =
f(\merid(a))$ for all $a : \susp A$.  But this just means that $g$ and $f$ have
the same recurrence relation, so we're back where we started.


For the other loop, suppose that we have an element $(b_{n}, b_{s}, f)$ of the
right.  Then we get an arrow $g : \susp A \to B$ on the left such that
$g(\north) = b_{n}$, $g(\south) = b_{s}$, and $g(\merid(a)) = f(a)$ for all $a
: \susp A$.  Going back to the right, we have the element $(b_{n}, b_{s}, f)$,
homotopic to the identity function.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
univ\_prop\_susp\coqdocindent{0.50em}
`\{Funext\}\coqdocindent{0.50em}
\{A\coqdocindent{0.50em}
B\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\}\coqdocindent{0.50em}
:\coqdoceol
\coqdocindent{1.00em}
(Susp\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
B)\coqdocindent{0.50em}
<\~{}>\coqdocindent{0.50em}
\{bn\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
\{bs\coqdocindent{0.50em}
:\coqdocindent{0.50em}
B\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(bn\coqdocindent{0.50em}
=\coqdocindent{0.50em}
bs)\}\}.\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_adjointify\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
North).\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
South).\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
f\coqdocindent{0.50em}
(merid\coqdocindent{0.50em}
a)).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
w.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
w\coqdocindent{0.50em}
as\coqdocindent{0.50em}
\coqdocvar{bn} [\coqdocvar{bs} \coqdocvar{f}].\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(Susp\_rect\_nd\coqdocindent{0.50em}
bn\coqdocindent{0.50em}
bs\coqdocindent{0.50em}
f).\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
w.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
w\coqdocindent{0.50em}
as\coqdocindent{0.50em}
\coqdocvar{bn} [\coqdocvar{bs} \coqdocvar{f}].\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_sigma\_uncurried.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
1.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_sigma\_uncurried.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
1.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_forall;\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
a.\coqdocindent{0.50em}
simpl.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
Susp\_comp\_nd\_merid.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
path\_forall.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(Susp\_rect\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
1\coqdocindent{0.50em}
1\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
a.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((trans\_paths\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
moveR\_pM.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((concat\_p1\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(concat\_1p\coqdocindent{0.50em}
\_)\^{}).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
inverse2.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
((Susp\_comp\_nd\_merid\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exer{6.12}{218} 
Show that $\eqv{\Z}{\N + \unit + \N}$.  Show that if we were to define $\Z$ as
$\N + \unit + \N$, then we could obtain Lemma 6.10.12 with judgmental
computation rules.


 \soln
Let $\Z \defeq \sm{x : \N \times \N} (r(x) = x)$, where
\[
  r(a, b) = \begin{cases}
    (a - b, 0) & \text{if $a \geq b$} \\
    (0, b - a) & \text{otherwise}
 \end{cases}
\]
To define the forward direction, let $((a, b), p) : \Z$.  If $a = b$, then
produce $\star$.  Otherwise, if $a > b$, produce $\pred(a - b)$ in the right
copy of $\N$.  Otherwise (i.e., when $a < b$), produce $\pred(b - a)$ in the
left copy of $\N$.  To go the other way, we have three cases.  When $n$ is
in the left, send it to $(0, \suc(n))$, along with the appropriate proof.  When
$n \equiv \star$, produce $(0, 0)$.  When $n$ is in the right, send it to
$(\suc(n), 0)$.  Clearly, these two constructions are quasi-inverses, since
$\suc(\pred(n)) = n$ for all $n \neq 0$.


Now define $\Z \defeq \N + \unit + \N$.  I just can't seem to get the right
computation rules!  I can get
\[
  f(\suc(\suc(n)))
  \equiv
  d_{+}(\suc(n), f(\suc(n)))
\]
and so on, but this isn't what we want.  The problem has to do with the
apparent necessity of $\pred$ in the encoding of the integers.  I suppose I
could try a different encoding.


\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch06 3.Exercise6 12}{Exercise6\_12}{\coqdocmodule{Exercise6\_12}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch06 3.Exercise6 12.monus}{monus}{\coqdocdefinition{monus}} \coqdocvar{n} \coqdocvar{m} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{m} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocvariable{n}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m'} \ensuremath{\Rightarrow} \coqdocdefinition{pred} (\coqref{Ch06 3.monus}{\coqdocdefinition{monus}} \coqdocvariable{n} \coqdocvar{m'})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.monus O n}{monus\_O\_n}{\coqdoclemma{monus\_O\_n}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqref{Ch06 3.Exercise6 12.monus}{\coqdocdefinition{monus}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{induction} \coqdocvar{n}. \coqdoctac{reflexivity}. \coqdoctac{simpl}. \coqdoctac{change} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqdockw{with} (\coqdocdefinition{pred} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdocvar{f\_ap}. \coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.n le Sn}{n\_le\_Sn}{\coqdoclemma{n\_le\_Sn}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocdefinition{le} \coqdocvariable{n} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intro} \coqdocvar{n}. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{n}\coqdocnotation{)\^{}}. \coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.monus eq O  n le m}{monus\_eq\_O\_\_n\_le\_m}{\coqdoclemma{monus\_eq\_O\_\_n\_le\_m}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch06 3.Exercise6 12.monus}{\coqdocdefinition{monus}} \coqdocvariable{n} \coqdocvariable{m} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{le} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.monus self}{monus\_self}{\coqdoclemma{monus\_self}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqref{Ch06 3.Exercise6 12.monus}{\coqdocdefinition{monus}} \coqdocvariable{n} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 12.n le m  Sn le Sm}{n\_le\_m\_\_Sn\_le\_Sm}{\coqdocdefinition{n\_le\_m\_\_Sn\_le\_Sm}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}), \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{le} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{le} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
:= \coqdockw{fun} \coqdocvar{n} \coqdocvar{m} \coqdocvar{H} \ensuremath{\Rightarrow} \coqdocnotation{(}\coqdocvariable{H}\coqdocnotation{.1}\coqdocnotation{;} \coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{H}\coqdocnotation{.2}\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Lemma\coqdocindent{0.50em}
order\_partitions\coqdocindent{0.50em}
:\coqdocindent{0.50em}
forall\coqdocindent{0.50em}
(n\coqdocindent{0.50em}
m\coqdocindent{0.50em}
:\coqdocindent{0.50em}
nat),\coqdocindent{0.50em}
(le\coqdocindent{0.50em}
n\coqdocindent{0.50em}
m)\coqdocindent{0.50em}
+\coqdocindent{0.50em}
(lt\coqdocindent{0.50em}
m\coqdocindent{0.50em}
n).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
induction\coqdocindent{0.50em}
n.\coqdoceol
\coqdocindent{2.00em}
intro\coqdocindent{0.50em}
m.\coqdocindent{0.50em}
left.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
m.\coqdocindent{0.50em}
reflexivity.\coqdoceol
\coqdocindent{1.00em}
induction\coqdocindent{0.50em}
m.\coqdoceol
\coqdocindent{2.00em}
right.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
n.\coqdocindent{0.50em}
reflexivity.\coqdoceol
\coqdocindent{2.00em}
destruct\coqdocindent{0.50em}
IHm.\coqdoceol
\coqdocindent{3.00em}
left.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
l.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
(S\coqdocindent{0.50em}
x).\coqdoceol
\coqdocindent{3.00em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
S).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
((plus\_n\_Sm\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\^{}\coqdocindent{0.50em}
@\coqdocindent{0.50em}
p).\coqdoceol
\coqdocindent{3.00em}
destruct\coqdocindent{0.50em}
(IHn\coqdocindent{0.50em}
m).\coqdoceol
\coqdocindent{4.00em}
left.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
n\_le\_m\_\_Sn\_le\_Sm.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
l0.\coqdoceol
\coqdocindent{4.00em}
right.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
l0.\coqdocindent{0.50em}
exists\coqdocindent{0.50em}
x.\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
S).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
p.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
r\coqdocindent{0.50em}
:\coqdocindent{0.50em}
nat\coqdocindent{0.50em}
*\coqdocindent{0.50em}
nat\coqdocindent{0.50em}
->\coqdocindent{0.50em}
nat\coqdocindent{0.50em}
*\coqdocindent{0.50em}
nat.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
z\coqdocindent{0.50em}
as\coqdocindent{0.50em}
\coqdocvar{a} \coqdocvar{b}.\coqdoceol
\coqdocindent{1.00em}
destruct\coqdocindent{0.50em}
(order\_partitions\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(monus\coqdocindent{0.50em}
a\coqdocindent{0.50em}
b,\coqdocindent{0.50em}
O).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(O,\coqdocindent{0.50em}
monus\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
int\coqdocindent{0.50em}
:=\coqdocindent{0.50em}
\{x\coqdocindent{0.50em}
:\coqdocindent{0.50em}
nat\coqdocindent{0.50em}
*\coqdocindent{0.50em}
nat\coqdocindent{0.50em}
\&\coqdocindent{0.50em}
r\coqdocindent{0.50em}
x\coqdocindent{0.50em}
=\coqdocindent{0.50em}
x\}.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
int\_to\_nat\_1\_nat\coqdocindent{0.50em}
:\coqdocindent{0.50em}
int\coqdocindent{0.50em}
->\coqdocindent{0.50em}
(nat\coqdocindent{0.50em}
+\coqdocindent{0.50em}
Unit\coqdocindent{0.50em}
+\coqdocindent{0.50em}
nat).\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
z\coqdocindent{0.50em}
as\coqdocindent{0.50em}
[\coqdocvar{a} \coqdocvar{b}] \coqdocvar{p}.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
(decidable\_paths\_nat\coqdocindent{0.50em}
a\coqdocindent{0.50em}
b).\coqdoceol
\coqdocindent{1.00em}
left.\coqdocindent{0.50em}
right.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
tt.\coqdoceol
\coqdocindent{1.00em}
destruct\coqdocindent{0.50em}
(order\_partitions\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a).\coqdoceol
\coqdocindent{1.00em}
right.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(pred\coqdocindent{0.50em}
(monus\coqdocindent{0.50em}
a\coqdocindent{0.50em}
b)).\coqdoceol
\coqdocindent{1.00em}
left.\coqdocindent{0.50em}
left.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(pred\coqdocindent{0.50em}
(monus\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a)).\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Definition\coqdocindent{0.50em}
nat\_1\_nat\_to\_int\coqdocindent{0.50em}
:\coqdocindent{0.50em}
(nat\coqdocindent{0.50em}
+\coqdocindent{0.50em}
Unit\coqdocindent{0.50em}
+\coqdocindent{0.50em}
nat)\coqdocindent{0.50em}
->\coqdocindent{0.50em}
int\coqdocindent{0.50em}
:=\coqdoceol
\coqdocindent{1.00em}
fun\coqdocindent{0.50em}
z\coqdocindent{0.50em}
=>\coqdoceol
\coqdocindent{2.00em}
match\coqdocindent{0.50em}
z\coqdocindent{0.50em}
with\coqdoceol
\coqdocindent{3.00em}
|\coqdocindent{0.50em}
inl\coqdocindent{0.50em}
a\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
match\coqdocindent{0.50em}
a\coqdocindent{0.50em}
with\coqdoceol
\coqdocindent{9.50em}
|\coqdocindent{0.50em}
inl\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
((O,\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n);\coqdocindent{0.50em}
1)\coqdoceol
\coqdocindent{9.50em}
|\coqdocindent{0.50em}
inr\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
((O,\coqdocindent{0.50em}
O);\coqdocindent{0.50em}
1)\coqdoceol
\coqdocindent{8.50em}
end\coqdoceol
\coqdocindent{3.00em}
|\coqdocindent{0.50em}
inr\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
((S\coqdocindent{0.50em}
n,\coqdocindent{0.50em}
O);\coqdocindent{0.50em}
1)\coqdoceol
\coqdocindent{2.00em}
end.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.lt le}{lt\_le}{\coqdoclemma{lt\_le}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{lt} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{le} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m} \coqdocvar{p}. \coqdoctac{destruct} \coqdocvar{p} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch06 3.Exercise6 12.hset prod}{hset\_prod}{\coqdoclemma{hset\_prod}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{\ensuremath{\forall}} \coqdocvar{B}, \coqdocabbreviation{IsHSet} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{HA} \coqdocvar{B} \coqdocvar{HB}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{z} \coqdocvar{z'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch06 3.Exercise6 12.hset nat}{hset\_nat}{\coqdoclemma{hset\_nat}} : \coqdocabbreviation{IsHSet} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hset\_decidable}. \coqdoctac{intros} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}; \coqdoctac{intro} \coqdocvar{m}; \coqdoctac{destruct} \coqdocvar{m}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{equiv\_path\_nat} \coqdoctac{in} \coqdocvar{p}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{equiv\_path\_nat} \coqdoctac{in} \coqdocvar{p}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqdocvar{IHn} \coqdocvar{m}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{left}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{p}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
ex6\_12\coqdocindent{0.50em}
:\coqdocindent{0.50em}
int\coqdocindent{0.50em}
<\~{}>\coqdocindent{0.50em}
(nat\coqdocindent{0.50em}
+\coqdocindent{0.50em}
Unit\coqdocindent{0.50em}
+\coqdocindent{0.50em}
nat).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
refine\coqdocindent{0.50em}
(equiv\_adjointify\coqdocindent{0.50em}
int\_to\_nat\_1\_nat\coqdocindent{0.50em}
nat\_1\_nat\_to\_int\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
z\coqdocindent{0.50em}
as\coqdocindent{0.50em}
[\coqdocvar{n} \ensuremath{|} \coqdocvar{n}] \ensuremath{|} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
reflexivity.\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
repeat\coqdocindent{0.50em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
contr\_unit.\coqdocindent{0.50em}
reflexivity.\coqdoceol
\coqdocindent{1.00em}
\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
z.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
z\coqdocindent{0.50em}
as\coqdocindent{0.50em}
[\coqdocvar{a} \coqdocvar{b}] \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
path\_sigma\_uncurried.\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(\coqdoceol
\coqdocindent{2.00em}
(nat\_1\_nat\_to\_int\coqdocindent{0.50em}
(int\_to\_nat\_1\_nat\coqdocindent{0.50em}
((a,\coqdocindent{0.50em}
b);\coqdocindent{0.50em}
p))).1\coqdocindent{0.50em}
=\coqdocindent{0.50em}
((a,\coqdocindent{0.50em}
b);\coqdocindent{0.50em}
p).1\coqdoceol
\coqdocindent{1.00em}
)\coqdocindent{0.50em}
as\coqdocindent{0.50em}
H.\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
nat\_1\_nat\_to\_int,\coqdocindent{0.50em}
int\_to\_nat\_1\_nat.\coqdoceol
\coqdocindent{1.00em}
destruct\coqdocindent{0.50em}
(decidable\_paths\_nat\coqdocindent{0.50em}
a\coqdocindent{0.50em}
b).\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
r\coqdocindent{0.50em}
in\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
(order\_partitions\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a);\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
p);\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
path\_prod.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.00em}
assert\coqdocindent{0.50em}
(b\coqdocindent{0.50em}
=\coqdocindent{0.50em}
O).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
snd\coqdocindent{0.50em}
p)\^{}.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.00em}
assert\coqdocindent{0.50em}
(a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
O).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(p0\coqdocindent{0.50em}
@\coqdocindent{0.50em}
X).\coqdoceol
\coqdocindent{2.00em}
simpl.\coqdocindent{0.50em}
transitivity\coqdocindent{0.50em}
(monus\coqdocindent{0.50em}
a\coqdocindent{0.50em}
0).\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
X0\^{}.\coqdocindent{0.50em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
X\^{}.\coqdoceol
\coqdocindent{2.00em}
reflexivity.\coqdoceol
\coqdocindent{2.00em}
reflexivity.\coqdoceol
\coqdocindent{2.00em}
assert\coqdocindent{0.50em}
(a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
O).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
fst\coqdocindent{0.50em}
p)\^{}.\coqdocindent{0.50em}
assert\coqdocindent{0.50em}
(b\coqdocindent{0.50em}
=\coqdocindent{0.50em}
O).\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
(p0\^{}\coqdocindent{0.50em}
@\coqdocindent{0.50em}
X).\coqdoceol
\coqdocindent{2.00em}
simpl.\coqdocindent{0.50em}
transitivity\coqdocindent{0.50em}
(monus\coqdocindent{0.50em}
b\coqdocindent{0.50em}
0).\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
X0\^{}.\coqdocindent{0.50em}
f\_ap.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
X\^{}.\coqdoceol
\coqdoceol
\coqdocindent{1.00em}
unfold\coqdocindent{0.50em}
r\coqdocindent{0.50em}
in\coqdocindent{0.50em}
p.\coqdocindent{0.50em}
simpl.\coqdocindent{0.50em}
destruct\coqdocindent{0.50em}
(order\_partitions\coqdocindent{0.50em}
b\coqdocindent{0.50em}
a);\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
(\_\coqdocindent{0.50em}
@\coqdocindent{0.50em}
p);\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
path\_prod.\coqdoceol
\coqdocindent{2.00em}
simpl.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((Spred\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{2.00em}
intro\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
monus\_eq\_O\_\_n\_le\_m\coqdocindent{0.50em}
in\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
le\_antisymmetric\coqdocindent{0.50em}
in\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
symmetry\coqdocindent{0.50em}
in\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
n\coqdocindent{0.50em}
in\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
contradiction.\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
l.\coqdocindent{0.50em}
reflexivity.\coqdocindent{0.50em}
reflexivity.\coqdocindent{0.50em}
reflexivity.\coqdoceol
\coqdocindent{2.00em}
simpl.\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((Spred\coqdocindent{0.50em}
\_\coqdocindent{0.50em}
\_)\coqdocindent{0.50em}
@\coqdocindent{0.50em}
\_).\coqdoceol
\coqdocindent{2.00em}
intro\coqdocindent{0.50em}
H.\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{2.00em}
assert\coqdocindent{0.50em}
(a\coqdocindent{0.50em}
=\coqdocindent{0.50em}
b).\coqdocindent{0.50em}
refine\coqdocindent{0.50em}
((ap\coqdocindent{0.50em}
fst\coqdocindent{0.50em}
p)\^{}\coqdocindent{0.50em}
@\coqdocindent{0.50em}
H\^{}\coqdocindent{0.50em}
@\coqdocindent{0.50em}
(ap\coqdocindent{0.50em}
snd\coqdocindent{0.50em}
p)).\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
n\coqdocindent{0.50em}
in\coqdocindent{0.50em}
X.\coqdoceol
\coqdocindent{2.00em}
contradiction.\coqdocindent{0.50em}
reflexivity.\coqdocindent{0.50em}
simpl\coqdocindent{0.50em}
in\coqdocindent{0.50em}
*.\coqdoceol
\coqdocindent{2.00em}
\coqdoceol
\coqdocindent{2.00em}
exists\coqdocindent{0.50em}
H.\coqdoceol
\coqdocindent{2.00em}
assert\coqdocindent{0.50em}
(IsHSet\coqdocindent{0.50em}
(nat\coqdocindent{0.50em}
*\coqdocindent{0.50em}
nat))\coqdocindent{0.50em}
as\coqdocindent{0.50em}
Hn.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hset\_prod;\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
hset\_nat.\coqdoceol
\coqdocindent{2.00em}
apply\coqdocindent{0.50em}
set\_path2.\coqdoceol
Defined.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch06 3.Exercise6 12.int'}{int'}{\coqdocdefinition{int'}} := \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocinductive{Unit} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch06 3}{\coqdocmodule{Exercise6\_12}}.\coqdoceol
\end{coqdoccode}
