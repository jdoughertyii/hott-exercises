\begin{coqdoccode}
\end{coqdoccode}
\section{Sets and logic}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} \coqdef{Ch03.Brck}{Brck}{\coqdocabbreviation{Brck}} \coqdocvar{Q} := (\coqdocabbreviation{merely} \coqdocvar{Q}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.1}{127}  
Prove that if $A \eqvsym B$ and $A$ is a set, then so is $B$.


 \soln
Suppose that $A \eqvsym B$ and that $A$ is a set.  Since $A$ is a set, $x =_{A}
y$ is a mere proposition.  And since $A \eqvsym B$, this means that $x =_{B} y$
is a mere proposition, hence that $B$ is a set.


Alternatively, we can unravel some definitions.  By assumption we have $f : A
\eqvsym B$ and
\[
  g : \isset(A) \equiv \prd{x, y:A}\prd{p,q : x=y} (p = q)
\]
Now suppose that $x, y : B$ and $p, q : x = y$.  Then $f^{-1}(x),
f^{-1}(y) : A$ and $f^{-1}(p), f^{-1}(q) : f^{-1}(x) =
f^{-1}(y)$, so
\[
  f\!\left(g(f^{-1}(x), f^{-1}(y), f^{-1}(p), f^{-1}(q))\right) 
  : 
    f(f^{-1}(p)) = f(f^{-1}(q))
\]
Since $f^{-1}$ is a quasi-inverse of $f$, we have the homotopy $\alpha :
\prd{a:A} (f(f^{-1}(a)) = a)$, thus
\[
  \alpha_{x}^{-1} \ct 
  f\!\left(g(f^{-1}(x), f^{-1}(y), f^{-1}(p), f^{-1}(q))\right) 
  \ct \alpha_{y}
  :
  p = q
\]
So we've constructed an element of
\[
  \isset(B) : \prd{x, y : B} \prd{p, q : x = y} (p = q)
\]
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 1}{ex3\_1}{\coqdoclemma{ex3\_1}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) `\{\coqdocclass{Univalence}\} : \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe} \coqdoctac{in} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 1'}{ex3\_1'}{\coqdoclemma{ex3\_1'}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{p} \coqdocnotation{=} \coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{q}). \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}})\coqdocnotation{)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.2}{127}
Prove that if $A$ and $B$ are sets, then so is $A + B$.


 \soln
Suppose that $A$ and $B$ are sets.  Then for all $a, a' : A$ and $b, b': B$, $a
= a'$ and $b = b'$ are contractible.  Given the characterization of the path
space of $A+B$ in \symbol{92}S2.12, it must also be contractible.  Hence $A + B$ is a
set.


More explicitly, suppose that $z, z' : A + B$ and $p, q : z = z'$.  By
induction, there are four cases.



\begin{itemize}
\item  $z \equiv \inl(a)$ and $z' \equiv \inl(a')$.  Then $(z = z') \eqvsym (a = a')$, and since $A$ is a set, $a = a'$ is contractible, so $(z = z')$ is as well.

\item  $z \equiv \inl(a)$ and $z' \equiv \inr(b)$.  Then $(z = z') \eqvsym \emptyt$, so $p$ is a contradiction.

\item  $z \equiv \inr(b)$ and $z' \equiv \inl(a)$.  Then $(z = z') \eqvsym \emptyt$, so $p$ is a contradiction.

\item  $z \equiv \inr(b)$ and $z' \equiv \inr(b')$.  Then $(z = z') \eqvsym (b = b')$, and since $B$ is a set, this type is contractible.

\end{itemize}
So $z = z'$ is contractible, making $A + B$ a set.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 2}{ex3\_2}{\coqdoclemma{ex3\_2}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{z} \coqdocvar{z'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{p} \coqdocnotation{=} \coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{pose} \coqdocvar{proof} (\coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{z} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{b}], \coqdocvar{z'} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{b'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{f}. \coqdocvar{contradiction}. \coqdocvar{contradiction}. \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} \coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.3}{127}
Prove that if $A$ is a set and $B : A \to \UU$ is a type family such that
$B(x)$ is a set for all $x:A$, then $\sm{x:A}B(x)$ is a set.


 \soln
At this point the pattern in these proofs is relatively obvious: show
that the path space of the combined types is determined by the path
spaces of the base types, and then apply the fact that the base types
are sets.  So here we suppose that $w w' : \sm{x:A} B(x)$, and that $p
q : (w = w')$.  Now
\[
  (w = w') \eqvsym \sm{p : \fst(w) = \fst(w')} p_{*}(\snd(w)) = \snd(w')
\]
by Theorem 2.7.2. Since $A$ is a set, $\fst(w) = \fst(w')$ is
contractible, so $(w = w') \eqvsym ((\refl{\fst(w)})_{*}(\snd(w)) =
\snd(w')) \equiv (\snd(w) = \snd(w'))$ by Lemma 3.11.9.  And since $B$
is a set, this too is contractible, making $w = w'$ contractible and
$\sm{x:A} B(x)$ a set.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 3}{ex3\_3}{\coqdoclemma{ex3\_3}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) : \coqdoceol
\coqdocindent{1.00em}
\coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}:\coqdocvariable{A}, \coqdocabbreviation{IsHSet} (\coqdocvariable{B} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{B} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w} \coqdocvar{w'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1} \coqdocvar{p} \coqdocnotation{=} \coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1} \coqdocvar{q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{p}..\coqdocnotation{1} \coqdocnotation{=} \coqdocvar{q}..\coqdocnotation{1}). \coqdoctac{apply} \coqdocvar{f}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{apply} (\coqdocvar{g} \coqdocvar{w'}\coqdocnotation{.1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} \coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.4}{127}
Show that $A$ is a mere proposition if and only if $A \to A$ is contractible.


 \soln 
For the forward direction, suppose that $A$ is a mere proposition.  Then by
Example 3.6.2, $A \to A$ is a mere proposition.  We also have $\idfunc{A} : A
\to A$ when $A$ is inhabited and $! : A \to A$ when it's not, so $A \to A$ is
contractible.


For the other direction, suppose that $A \to A$ is contractible and that $x y :
A$.  We have the functions $z \mapsto x$ and $z \mapsto y$, and since $A \to A$
is contractible these functions are equal.  $\happly$ then gives $x = y$, so
$A$ is a mere proposition.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 4}{ex3\_4}{\coqdoclemma{ex3\_4}} `\{\coqdocclass{Funext}\} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\leftrightarrow}}} \coqdocabbreviation{Contr} (\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{intro} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
forward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocabbreviation{idmap}; \coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
backward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdockw{fun} \coqdocvar{z}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{x}\coqdocnotation{)} \coqdocnotation{=} \coqdocnotation{(}\coqdockw{fun} \coqdocvar{z}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{y}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H'}. \coqdoctac{transitivity} \coqdocvar{center}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocnotation{(}\coqdocvar{contr} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{x})\coqdocnotation{)\^{}}. \coqdoctac{apply} (\coqdocvar{contr} (\coqdockw{fun} \coqdocvar{\_} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{y})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{apD10} \coqdocvar{X} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.5}{127}
Show that $\isprop(A) \eqvsym (A \to \iscontr(A))$.


 \soln
Lemma 3.3.3 gives us maps $\isprop(A) \to (A \to \iscontr(A))$ and $(A
\to \iscontr(A)) \to \isprop(A)$.  Note that $\iscontr(A)$ is a mere
proposition, so $A \to \iscontr(A)$ is as well.  $\isprop(A)$ is
always a mere proposition, so by Lemma 3.3.3 we have the equivalence.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch03.Ex5}{Ex5}{\coqdocmodule{Ex5}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.Ex5.equiv hprop inhabited contr}{equiv\_hprop\_inhabited\_contr}{\coqdoclemma{equiv\_hprop\_inhabited\_contr}} `\{\coqdocclass{Funext}\} (\coqdocvar{A} : \coqdockw{Type}) \coqdoceol
\coqdocindent{1.00em}
: \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{Contr} \coqdocvariable{A}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03}{\coqdocmodule{Ex5}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.6}{127}
Show that if $A$ is a mere proposition, then so is $A + (\lnot A)$.


 \soln
Suppose that $A$ is a mere proposition, and that $x, y : A + (\lnot A)$.  By a
case analysis, we have



\begin{itemize}
\item  $x = \inl(a)$ and $y = \inl(a')$.  Then $(x = y) \eqvsym (a = a')$, and $A$ is a mere proposition, so this holds.

\item  $x = \inl(a)$ and $y = \inr(f)$.  Then $f(a) : \emptyt$, a contradiction.

\item  $x = \inr(f)$ and $y = \inl(a)$.  Then $f(a) : \emptyt$, a contradiction.

\item  $x = \inr(f)$ and $y = \inr(f')$.  Then $(x = y) \eqvsym (f = f')$, and $\lnot A$ is a mere proposition, so this holds.

\end{itemize}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 6}{ex3\_6}{\coqdoclemma{ex3\_6}} `\{\coqdocclass{Funext}\} \{\coqdocvar{A}\} : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} (\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocnotation{\ensuremath{\lnot}}\coqdocvar{A})) \coqdockw{as} \coqdocvar{H'{}'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{f} \coqdocvar{f'}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{x}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{f}], \coqdocvar{y} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{f'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}). \coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}}). \coqdoctac{apply} \coqdocvar{H'{}'}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.7}{127}
More generally, show that if $A$ and $B$ are mere propositions and $\lnot (A
\times B)$, then $A + B$ is also a mere proposition.


 \soln
Suppose that $A$ and $B$ are mere propositions with $f : \lnot (A \times B)$,
and let $x, y : A + B$.  Then we have cases:



\begin{itemize}
\item  $x = \inl(a)$ and $y = \inl(a')$.  Then $(x = y) \eqvsym (a = a')$, and $A$ is a mere proposition, so this holds.

\item  $x = \inl(a)$ and $y = \inr(b)$.  Then $f(a, b) : \emptyt$, a contradiction.

\item  $x = \inr(b)$ and $y = \inl(a)$.  Then $f(a, b) : \emptyt$, a contradiction.

\item  $x = \inr(b)$ and $y = \inr(b')$.  Then $(x = y) \eqvsym (b = b')$, and $B$ is a mere proposition, so this holds.

\end{itemize}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 7}{ex3\_7}{\coqdoclemma{ex3\_7}} \{\coqdocvar{A} \coqdocvar{B}\} : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\~{}(}\coqdocvariable{A} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqdocvariable{B}\coqdocnotation{)} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} (\coqdocvariable{A}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}}\coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HA} \coqdocvar{HB} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{b}], \coqdocvar{y} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{b'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}). \coqdoctac{apply} \coqdocvar{HA}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqdocvar{f} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}). \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqdocvar{f} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{a'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}). \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}}). \coqdoctac{apply} \coqdocvar{HB}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.8}{127}
Assuming that some type $\isequiv(f)$ satisfies
\begin{itemize}
  \item[(i)] For each $f : A \to B$, there is a function $\qinv(f) \to \isequiv(f)$;
  \item[(ii)] For each $f$ we have $\isequiv(f) \to \qinv(f)$;
  \item[(iii)] For any two $e_{1}, e_{2} : \isequiv(f)$ we have $e_{1} = e_{2}$,
\end{itemize}
show that the type $\brck{\qinv(f)}$ satisfies the same conditions and is
equivalent to $\isequiv(f)$.


 \soln
Suppose that $f : A \to B$.  There is a function $\qinv(f) \to \brck{\qinv(f)}$
by definition.  Since $\isequiv(f)$ is a mere proposition (by iii), the
recursion principle for $\brck{\qinv(f)}$ gives a map $\brck{\qinv(f)} \to
\isequiv(f)$, which we compose with the map from (ii) to give a map
$\brck{\qinv(f)} \to \qinv(f)$.  Finally, $\brck{\qinv(f)}$ is a mere
proposition by construction.  Since $\brck{\qinv(f)}$ and $\isequiv(f)$ are
both mere propositions and logically equivalent, $\brck{\qinv(f)} \eqvsym
\isequiv(f)$ by Lemma 3.3.3.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 8}{Exercise3\_8}{\coqdocsection{Exercise3\_8}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Variables} (\coqdef{Ch03.Exercise3 8.E}{E}{\coqdocvariable{E}} \coqdef{Ch03.Exercise3 8.Q}{Q}{\coqdocvariable{Q}} : \coqdockw{Type}).\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H1}{H1}{\coqdocvariable{H1}} : \coqdocvariable{Q} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{E}.\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H2}{H2}{\coqdocvariable{H2}} : \coqdocvariable{E} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{Q}.\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H3}{H3}{\coqdocvariable{H3}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{e} \coqdocvar{e'} : \coqdocvariable{E}, \coqdocvariable{e} \coqdocnotation{=} \coqdocvariable{e'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 8 i}{ex3\_8\_i}{\coqdocdefinition{ex3\_8\_i}} : \coqdocvariable{Q} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} := \coqdocconstructor{tr}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 8 ii}{ex3\_8\_ii}{\coqdocdefinition{ex3\_8\_ii}} : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{Q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{q}. \coqdoctac{apply} \coqdocvariable{H2}. \coqdoctac{apply} (@\coqdocdefinition{Trunc\_rect} \coqdocnotation{-1} \coqdocvariable{Q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{q'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdocvariable{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvariable{H1}. \coqdoctac{apply} \coqdocvar{q}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 8 iii}{ex3\_8\_iii}{\coqdoclemma{ex3\_8\_iii}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{q} \coqdocvar{q'} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}, \coqdocvariable{q} \coqdocnotation{=} \coqdocvariable{q'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 8 iv}{ex3\_8\_iv}{\coqdoclemma{ex3\_8\_iv}} : \coqdocnotation{(}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{E}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} @\coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqref{Ch03.ex3 8 iii}{\coqdoclemma{ex3\_8\_iii}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdocvariable{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvariable{H1} \coqdocnotation{o} \coqref{Ch03.ex3 8 ii}{\coqdocdefinition{ex3\_8\_ii}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.ex3 8 i}{\coqdocdefinition{ex3\_8\_i}} \coqdocnotation{o} \coqdocvariable{H2}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 8}{\coqdocsection{Exercise3\_8}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.9}{127}
Show that if $\LEM{}$ holds, then the type $\prop \defeq \sm{A:\UU}\isprop(A)$
is equivalent to $\bool$.


 \soln
Suppose that 
\[
  f : \prd{A:\UU}\left(\isprop(A) \to (A + \lnot A)\right)
\]
To construct a map $\prop \to \bool$, it suffices to consider an element of the
form $(A, g)$, where $g : \isprop(A)$.  Then $f(g) : A + \lnot A$, so we have
two cases:



\begin{itemize}
\item  $f(g) \equiv \inl(a)$, in which case we send it to $1_{\bool}$, or

\item  $f(g) \equiv \inr(a)$, in which case we send it to $0_{\bool}$.

\end{itemize}
To go the other way, note that $\LEM{}$ splits $\prop$ into two equivalence
classes (basically, the true and false propositions), and $\unit$ and $\emptyt$
are in different classes.  Univalence quotients out these classes, leaving us
with two elements.  We'll use $\unit$ and $\emptyt$ as representatives, so we
send $0_{\bool}$ to $\emptyt$ and $1_{\bool}$ to $\unit$.


Coq has some trouble with the universes here, so we have to specify that we want (\coqdocinductive{Unit} : \coqdockw{Type}) and (\coqdocinductive{Empty} : \coqdockw{Type}); otherwise we get the \coqdocvar{Type0} versions.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 9}{Exercise3\_9}{\coqdocsection{Exercise3\_9}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 9.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{A} : \coqdockw{Type}), \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 9 f}{ex3\_9\_f}{\coqdocdefinition{ex3\_9\_f}} (\coqdocvar{P} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}}\coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) : \coqdocinductive{Bool} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} (\coqdocvariable{LEM} \coqdocvariable{P}\coqdocnotation{.1} \coqdocvariable{P}\coqdocnotation{.2}) \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocconstructor{true}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvar{a'} \ensuremath{\Rightarrow} \coqdocconstructor{false}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop Unit}{hprop\_Unit}{\coqdoclemma{hprop\_Unit}} : \coqdocabbreviation{IsHProp} (\coqdocinductive{Unit} : \coqdockw{Type}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}. \coqdoctac{intro} \coqdocvar{u}. \coqdoctac{apply} \coqdocinstance{contr\_unit}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 9 inv}{ex3\_9\_inv}{\coqdocdefinition{ex3\_9\_inv}} (\coqdocvar{b} : \coqdocinductive{Bool}) : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{b} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocconstructor{true} \ensuremath{\Rightarrow} @\coqexternalref{existT}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocabbreviation{existT}} \coqdockw{Type} \coqdocabbreviation{IsHProp} (\coqdocinductive{Unit} : \coqdockw{Type}) \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocconstructor{false} \ensuremath{\Rightarrow} @\coqexternalref{existT}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocabbreviation{existT}} \coqdockw{Type} \coqdocabbreviation{IsHProp} (\coqdocinductive{Empty} : \coqdockw{Type}) \coqdocinstance{hprop\_Empty}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 9}{ex3\_9}{\coqdoclemma{ex3\_9}} `\{\coqdocclass{Univalence}\} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocinductive{Bool}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}} \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b}. \coqdoctac{unfold} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}}, \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocinductive{Unit}:\coqdockw{Type}) \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{contradiction} \coqdocvar{n}. \coqdoctac{exact} \coqdocconstructor{tt}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocinductive{Empty}:\coqdockw{Type}) \coqdocinstance{hprop\_Empty}).\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{contradiction}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{A}  \coqdocvar{p}]. \coqdoctac{unfold} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}}, \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} \coqdocvar{A} \coqdocvar{p}) \coqdockw{as} [\coqdocvar{x} \ensuremath{|} \coqdocvar{x}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocinductive{Unit}:\coqdockw{Type}\coqdocnotation{)} \coqdocnotation{=} \coqdocvar{A}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assert} (\coqdocabbreviation{Contr} \coqdocvar{A}). \coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{x}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe}. \coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} \coqdocdefinition{equiv\_contr\_unit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{induction} \coqdocvar{X}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocabbreviation{IsHProp} (\coqdocinductive{Unit}:\coqdockw{Type}))). \coqdoctac{apply} \coqdocinstance{HProp\_HProp}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocinductive{Empty}:\coqdockw{Type}\coqdocnotation{)} \coqdocnotation{=} \coqdocvar{A}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{intro} \coqdocvar{a}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{induction} \coqdocvar{X}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocabbreviation{IsHProp} (\coqdocinductive{Empty}:\coqdockw{Type}))). \coqdoctac{apply} \coqdocinstance{HProp\_HProp}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 9}{\coqdocsection{Exercise3\_9}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.10}{127}
Show that if $\UU_{i+1}$ satisfies $\LEM{}$, then the canonical inclusion
$\prop_{\UU_{i}} \to \prop_{\UU_{i+1}}$ is an equivalence.


 \soln
If $\LEM{i+1}$ holds, then $\LEM{i}$ holds as well.  For suppose that
$A : \UU_{i}$ and $p : \isprop(A)$.  Then we also have $A :
\UU_{i+1}$, so $\LEM{i+1}(A, p) : A + \lnot A$, establishing
$\LEM{i}$.  By the previous exercise, then, $\prop_{\UU_{i}} \eqvsym
\bool \eqvsym \prop_{\UU_{i+1}}$.


Since Coq doesn't let the user access the \coqdockw{Type}${}_{i}$ hierarchy,
there's not much to do here.  This is really more of a ``proof by
contemplation'' anyway.


 \exerdone{3.11}{127}
Show that it is not the case that for all $A : \UU$ we have $\brck{A} \to A$.


 \soln
We can essentially just copy Theorem 3.2.2.  Suppose given a function $f :
\prd{A:\UU} \brck{A} \to A$, and recall the equivalence $e : \bool \eqvsym
\bool$ from Exercise 2.13 given by $e(1_{\bool}) \defeq 0_{\bool}$ and
$e(0_{\bool}) = 1_{\bool}$.  Then $\ua(e) : \bool = \bool$, $f(\bool)
: \brck{\bool} \to \bool$, and
\[
  \mapdepfunc{f}(\ua(e)) : 
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)} = f(\bool)
\]
So for $u : \brck{\bool}$,
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)}(u) = f(\bool)(u)
\]
and by 2.9.4, we have
\[
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)}(u) 
  =
  \transfib{A \mapsto A}{\ua(e)}{f(\bool)(\transfib{\lvert \blank
  \rvert}{\ua(e)^{-1}}{u}})
\]
But, any two $u, v : \brck{A}$ are equal, since $\brck{A}$ is contractible.  So
$\transfib{\lvert\blank\rvert}{\ua(e)^{-1}}{u} = u$, and so
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  \transfib{A \mapsto A}{\ua(e)}{f(\bool)(u)}
  = f(\bool)(u)
\]
and the propositional computation rule for $\ua$ gives
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  e(f(\bool)(u)) = f(\bool)(u)
\]
But $e$ has no fixed points, so we have a contradiction.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.negb no fixpoint}{negb\_no\_fixpoint}{\coqdoclemma{negb\_no\_fixpoint}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocdefinition{negb} \coqdocvariable{b} \coqdocnotation{=} \coqdocvariable{b}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{b}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{false\_ne\_true} \coqdocvar{H}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{true\_ne\_false} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdoceol
Theorem\coqdocindent{0.50em}
ex3\_11\coqdocindent{0.50em}
`\{Univalence\}\coqdocindent{0.50em}
:\coqdocindent{0.50em}
\~{}\coqdocindent{0.50em}
(forall\coqdocindent{0.50em}
A,\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A).\coqdoceol
Proof.\coqdoceol
\coqdocindent{1.00em}
intro\coqdocindent{0.50em}
f.\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(forall\coqdocindent{0.50em}
b,\coqdocindent{0.50em}
negb\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
b)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
b).\coqdocindent{0.50em}
intro\coqdocindent{0.50em}
b.\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb)\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool)\coqdocindent{0.50em}
b\coqdoceol
\coqdocindent{5.00em}
=\coqdoceol
\coqdocindent{5.00em}
f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
b).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(apD10\coqdocindent{0.50em}
(apD\coqdocindent{0.50em}
f\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb))\coqdocindent{0.50em}
b).\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A\coqdocindent{0.50em}
->\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb)\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool)\coqdocindent{0.50em}
b\coqdoceol
\coqdocindent{5.00em}
=\coqdoceol
\coqdocindent{5.00em}
transport\coqdocindent{0.50em}
idmap\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{10.00em}
(f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{19.50em}
(path\_universe\coqdocindent{0.50em}
negb)\^{}\coqdoceol
\coqdocindent{19.50em}
b))).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(@transport\_arrow\coqdocindent{0.50em}
Type0\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
idmap).\coqdoceol
\coqdocindent{1.00em}
rewrite\coqdocindent{0.50em}
X\coqdocindent{0.50em}
in\coqdocindent{0.50em}
X0.\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(b\coqdocindent{0.50em}
=\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
(fun\coqdocindent{0.50em}
A\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Type\coqdocindent{0.50em}
=>\coqdocindent{0.50em}
Brck\coqdocindent{0.50em}
A)\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb)\coqdocindent{0.50em}
\^{}\coqdocindent{0.50em}
b)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
allpath\_hprop.\coqdocindent{0.50em}
rewrite\coqdocindent{0.50em}
<-\coqdocindent{0.50em}
X1\coqdocindent{0.50em}
in\coqdocindent{0.50em}
X0.\coqdocindent{0.50em}
symmetry\coqdocindent{0.50em}
in\coqdocindent{0.50em}
X0.\coqdoceol
\coqdocindent{1.00em}
assert\coqdocindent{0.50em}
(transport\coqdocindent{0.50em}
idmap\coqdocindent{0.50em}
(path\_universe\coqdocindent{0.50em}
negb)\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
b)\coqdocindent{0.50em}
=\coqdocindent{0.50em}
negb\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
b)).\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
transport\_path\_universe.\coqdocindent{0.50em}
rewrite\coqdocindent{0.50em}
X2\coqdocindent{0.50em}
in\coqdocindent{0.50em}
X0.\coqdocindent{0.50em}
apply\coqdocindent{0.50em}
X0.\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(@negb\_no\_fixpoint\coqdocindent{0.50em}
(f\coqdocindent{0.50em}
Bool\coqdocindent{0.50em}
(min1\coqdocindent{0.50em}
true))).\coqdocindent{0.50em}
\coqdoceol
\coqdocindent{1.00em}
apply\coqdocindent{0.50em}
(X\coqdocindent{0.50em}
(min1\coqdocindent{0.50em}
true)).\coqdoceol
Qed.\coqdoceol
\end{coqdoccomment}
\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.12}{127}
Show that if $\LEM{}$ holds, then for all $A : \UU$ we have $\bbrck{\brck{A}
\to A}$.


 \soln
Suppose that $\LEM{}$ holds, and that $A : \UU$.  By $\LEM{}$, either $\brck{A}$
or $\lnot\brck{A}$.   If the
former, then we can use the recursion principle for $\brck{A}$ to construct a
map to $\bbrck{\brck{A} \to A}$, then apply it to the element of $\brck{A}$.
So we need a map $A \to \bbrck{\brck{A} \to A}$, which is not hard to get:
\[
  \lam{a:A}\left\lvert\lam{a':\brck{A}}a\right\rvert : A \to \bbrck{\brck{A} \to A}
\]
If the latter, then we have the canonical map out of the empty type $\brck{A}
\to A$, hence we have $\bbrck{\brck{A} \to A}$.  
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 12}{Exercise3\_12}{\coqdocsection{Exercise3\_12}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 12.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 12}{ex3\_12}{\coqdoclemma{ex3\_12}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{A}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvar{A}) \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{a}. \coqdocvar{contradiction} (\coqdocvar{n} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 12}{\coqdocsection{Exercise3\_12}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.13}{127}
Show that the axiom
\[
    \LEM{}': \prd{A:\UU} (A + \lnot A)
\]
implies that for $X : \UU$, $A : X \to \UU$, and $P : \prd{x:X} A(x) \to \UU$,
if $X$ is a set, $A(x)$ is a set for all $x:X$, and $P(x, a)$ is a mere
proposition for all $x:X$ and $a:A(x)$, 
\[
  \left(\prd{x:X}\left\lVert\sm{a:A(x)}P(x, a)\right\rVert\right)
  \to
  \left\lVert \sm{g:\prd{x:X}A(x)}\prd{x:X}P(x, g(x))\right\rVert.
\]


 \soln
By Lemma 3.8.2, it suffices to show that for any set $X$ and any $Y : X \to
\UU$ such that $Y(x)$ is a set, we have
\[
  \left(\prd{x:X}\brck{Y(x)}\right) \to \left\lVert\prd{x:X}Y(x)\right\rVert
\]
Suppose that $f : \prd{x:X}\brck{Y(x)}$.  By $\LEM{}'$, either $Y(x)$ is
inhabited or it's not.  If it is, then $\LEM{}'(Y(x)) \equiv y : Y(x)$, and we
have
\[
  \left\lvert\lam{x:X}y\right\rvert : \left\lVert \prd{x:X} Y(x) \right\rVert
\]
Suppose instead that $\lnot Y(x)$ and that $x:X$.  Then $f(x) : \brck{Y(x)}$.
Since we're trying to derive a mere proposition, we can ignore this truncation
and suppose that $f(x) : Y(x)$, in which case we have a contradiction, and
we're done.


The reason we can ignore the truncation (and apply \coqdocvar{strip\_truncations} in Coq)
in hypotheses is given by the reasoning in the previous Exercise.  If the
conclusion is a mere proposition, then the recursion principle for
$\brck{Y(x)}$ allows us to construct an arrow out of $\brck{Y(x)}$ if we have
one from $Y(x)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.AC}{AC}{\coqdocdefinition{AC}} := \coqdockw{\ensuremath{\forall}} \coqdocvar{X} \coqdocvar{A} \coqdocvar{P},\coqdoceol
\coqdocindent{1.00em}
\coqdocabbreviation{IsHSet} \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{a}, \coqdocabbreviation{IsHProp} (\coqdocvariable{P} \coqdocvariable{x} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{((}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}:\coqdocvariable{X}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}}\coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{3.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{P} \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.AC prod}{AC\_prod}{\coqdocdefinition{AC\_prod}} := \coqdockw{\ensuremath{\forall}} (\coqdocvar{X} : \coqdocrecord{hSet}) (\coqdocvar{Y} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}),\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHSet} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{((}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop is hset}{hprop\_is\_hset}{\coqdoclemma{hprop\_is\_hset}} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{typeclasses} \coqdoctac{eauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.AC equiv AC prod}{AC\_equiv\_AC\_prod}{\coqdoclemma{AC\_equiv\_AC\_prod}} `\{\coqdocclass{Funext}\} : \coqref{Ch03.AC}{\coqdocdefinition{AC}} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.AC prod}{\coqdocdefinition{AC\_prod}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}; \coqdoctac{unfold} \coqref{Ch03.AC}{\coqdocdefinition{AC}}, \coqref{Ch03.AC prod}{\coqdocdefinition{AC\_prod}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
forward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{AC} \coqdocvar{HX} \coqdocvar{Y} \coqdocvar{HY} \coqdocvar{f}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{He} : (\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, (\coqdockw{fun} \coqdocvar{x} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit}) \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})\coqdoceol
\coqdocindent{2.00em}
\coqdocnotation{\ensuremath{\eqvsym}} \coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x})\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{apply} \coqdocvar{w}\coqdocnotation{.1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{g}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}. \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{He}. \coqdoctac{clear} \coqdocvar{He}. \coqdoctac{apply} (\coqdocvar{AC} \coqdocvar{\_} \coqdocvar{Y} (\coqdockw{fun} \coqdocvar{x} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit})). \coqdoctac{apply} \coqdocvar{HX}. \coqdoctac{apply} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{y} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdoctac{by} \coqdoctac{apply} \coqdocvar{f}. \coqdocvar{strip\_truncations}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{y}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
back\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{AC\_prod} \coqdocvar{X} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HX} \coqdocvar{HA} \coqdocvar{HP} \coqdocvar{f}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{He}: (\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) \coqdoceol
\coqdocindent{2.00em}
\coqdocnotation{\ensuremath{\eqvsym}} \coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{\ensuremath{\exists}} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocnotation{(}\coqdocvar{X0} \coqdocvariable{x}\coqdocnotation{).1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{X0} \coqdocvar{x}\coqdocnotation{).2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{X0}\coqdocnotation{.1} \coqdocvar{x}\coqdocnotation{;} \coqdocvar{X0}\coqdocnotation{.2} \coqdocvar{x}\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{He}. \coqdoctac{clear} \coqdocvar{He}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{AC\_prod} (\coqdocdefinition{default\_HSet} \coqdocvar{X} \coqdocvar{HX}) (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqref{Ch03.ex3 3}{\coqdoclemma{ex3\_3}}. \coqdoctac{apply} (\coqdocvar{HA} \coqdocvar{x}). \coqdoctac{intro} \coqdocvar{a}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.hprop is hset}{\coqdoclemma{hprop\_is\_hset}}. \coqdoctac{apply} (\coqdocvar{HP} \coqdocvar{x} \coqdocvar{a}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} (\coqdocvar{f} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 13}{Exercise3\_13}{\coqdocsection{Exercise3\_13}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 13.LEM'}{LEM'}{\coqdocvariable{LEM'}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 13}{ex3\_13}{\coqdoclemma{ex3\_13}} `\{\coqdocclass{Funext}\} : \coqref{Ch03.AC}{\coqdocdefinition{AC}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.AC equiv AC prod}{\coqdoclemma{AC\_equiv\_AC\_prod}}. \coqdoctac{intros} \coqdocvar{X} \coqdocvar{Y} \coqdocvar{HX} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM'} (\coqdocvar{Y} \coqdocvar{x})). \coqdoctac{apply} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdockw{as} \coqdocvar{y'}. \coqdoctac{apply} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{\ensuremath{\lnot}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdockw{as} \coqdocvar{nn}. \coqdoctac{intro} \coqdocvar{p}. \coqdocvar{strip\_truncations}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction} \coqdocvar{nn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 13}{\coqdocsection{Exercise3\_13}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.14}{127}
Show that assuming $\LEM{}$, the double negation $\lnot\lnot A$ has the same
universal property as the propositional truncation $\brck{A}$, and is therefore
equivalent to it.  


 \soln
Suppose that $a : \lnot\lnot A$ and that we have some function $g : A \to B$,
where $B$ is a mere proposition, so $p : \isprop(B)$.  We can construct a
function $\lnot \lnot A \to \lnot \lnot B$ by using contraposition twice,
producing $g'': \lnot \lnot A \to \lnot \lnot B$
\[
    g''(h) \defeq 
    \lam{f : \lnot B}h(\lam{a:A}f(g(a))) 
\]
$\LEM{}$ then allows us to use double negation elimination to produce a map
$\lnot \lnot B \to B$.  Suppose that $f : \lnot \lnot B$.  Then we have
$\LEM{}(B, p) : B + \lnot B$, and in the left case we can produce the witness,
and in the right case we use $f$ to derive a contradiction.  Explicitly, we
have $\ell : \lnot \lnot B \to B$ given by
\[
  \ell(f) \defeq 
  \rec{B + \lnot\lnot B}(B, \idfunc{B}, f, \LEM{}(B, p))
\]
The computation rule does not hold judgementally for $g'' \circ \ell$.  I don't
see that it can, given the use of $\LEM{}$.  Clearly it does hold
propositionally, if one takes $\lvert a \rvert' \defeq \lam{f}f(a)$ to be the
analogue of the constructor for $\brck{A}$; for any $a : A$, we have $g(a) :
B$, and the fact that $B$ is a mere proposition ensures that $(g'' \circ
\ell)(\lvert a \rvert') = g(a)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 14}{Exercise3\_14}{\coqdocsection{Exercise3\_14}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 14.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Brck'}{Brck'}{\coqdocdefinition{Brck'}} (\coqdocvar{A} : \coqdockw{Type}) := \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.min1'}{min1'}{\coqdocdefinition{min1'}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{a} : \coqdocvariable{A}) : \coqref{Ch03.Brck'}{\coqdocdefinition{Brck'}} \coqdocvariable{A} := \coqdockw{fun} \coqdocvar{f} \ensuremath{\Rightarrow} \coqdocvariable{f} \coqdocvariable{a}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.contrapositive}{contrapositive}{\coqdocdefinition{contrapositive}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} \coqdocvar{X0}. \coqdoctac{apply} \coqdocvar{X}. \coqdoctac{apply} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.DNE}{DNE}{\coqdocdefinition{DNE}} \{\coqdocvar{B} : \coqdockw{Type}\} `\{\coqdocabbreviation{IsHProp} \coqdocvariable{B}\} : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{destruct} (\coqdocvariable{LEM} \coqdocvar{B} \coqdocvar{IsHProp0}). \coqdoctac{apply} \coqdocvar{b}. \coqdocvar{contradiction} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.trunc rect'}{trunc\_rect'}{\coqdocdefinition{trunc\_rect'}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} (\coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) : \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck'}{\coqdocdefinition{Brck'}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HB} \coqdocvar{a}. \coqdoctac{apply} \coqref{Ch03.DNE}{\coqdocdefinition{DNE}}. \coqdoctac{apply} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} \coqdocvar{g})). \coqdoctac{apply} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 14}{\coqdocsection{Exercise3\_14}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.15}{128}
Show that if we assume propositional resizing, then the type
\[
  \prd{P:\prop}\left((A \to P) \to P\right)
\]
has the same universal property as $\brck{A}$.


 \soln
Let $A:\UU_{i}$, so that for $\brck{A}'' \defeq \prd{P:\prop_{\UU_{i}}} ((A \to
P) \to P)$ we have $\brck{A}'' : \UU_{i+1}$.  By propositional resizing,
however, we have a corresponding $\brck{A}'' : \UU_{i}$.  To construct an arrow
$\brck{A}'' \to B$, suppose that $f : \brck{A}''$ and $g : A \to B$.  Then
$f(B, g) : B$.  So $\lam{f}\tilde{f}(B, g) : \brck{A}'' \to B$, where
$\tilde{f}$ is the image of $f$ under the inverse of the canonical inclusion
$\prop_{\UU_{i}} \to \prop_{\UU_{i+1}}$.


To show that the computation rule holds, let
\[
  \lvert a \rvert'' \defeq \lam{P}{f}f(a) : \prd{P:\prop}\left((A \to P) \to P
  \right)
\]
We need to show that $(\lam{f}\tilde{f}(B, g))(\lvert a \rvert'') \equiv g(a)$.
Assuming that propositional resizing gives a judgemental equality, we have
\begin{align*}
  (\lam{f}\tilde{f}(B, g))(\lvert a \rvert '')
  &\equiv
  (\lam{f}\tilde{f}(B, g))(\lam{P}{f}f(a))
  \\&\equiv
  (\lam{P}{f}f(a))(B, g)
  \\&\equiv
  g(a)
\end{align*}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Brck''}{Brck'{}'}{\coqdocdefinition{Brck'{}'}} (\coqdocvar{A} : \coqdockw{Type}) := \coqdockw{\ensuremath{\forall}} (\coqdocvar{P} : \coqdocrecord{hProp}), (\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}).\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.min1''}{min1'{}'}{\coqdocdefinition{min1'{}'}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{a} : \coqdocvariable{A}) := \coqdockw{fun} (\coqdocvar{P} : \coqdocrecord{hProp}) (\coqdocvar{f} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}) \ensuremath{\Rightarrow} \coqdocvariable{f} \coqdocvariable{a}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.trunc rect''}{trunc\_rect'{}'}{\coqdocdefinition{trunc\_rect'{}'}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} (\coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) : \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck''}{\coqdocdefinition{Brck'{}'}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{f} (\coqdocconstructor{hp} \coqdocvar{B} \coqdocvar{p})). \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.16}{128}
Assuming $\LEM{}$, show that double negation commutes with universal
quantification of mere propositions over sets.  That is, show that if $X$ is a
set and each $Y(x)$ is a mere proposition, then $\LEM{}$ implies
\[
  \left(\prd{x:X}\lnot\lnot Y(x)\right) 
  \eqvsym
  \left(\lnot\lnot\prd{x:X} Y(x)\right).
\]


 \soln
Each side is a mere proposition, since one side is a dependent function into a
mere proposition and the other is a negation.  So we just need to show that
each implies the other.  From left to right we use the fact that $\LEM{}$
is equivalent to double negation to obtain $\prd{x:X}Y(x)$, and double negation
introduction is always allowed, giving the right side.  For the other direction
we do the same.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 16}{Exercise3\_16}{\coqdocsection{Exercise3\_16}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 16.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 16}{ex3\_16}{\coqdoclemma{ex3\_16}} `\{\coqdocclass{Funext}\} (\coqdocvar{X} : \coqdocrecord{hSet}) (\coqdocvar{Y} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHProp} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{Y} \coqdocvariable{x}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{Y} \coqdocvariable{x}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{HY}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}; \coqdoctac{intro} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}. \coqdoctac{apply} \coqdocvar{f}. \coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocvar{Y} \coqdocvar{x})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{HY}. \coqdoctac{apply} \coqdocvar{y}.\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{contradiction} (\coqdocvar{H'} \coqdocvar{x}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocvar{Y} \coqdocvar{x})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{HY}. \coqdoctac{intro} \coqdocvar{f}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x}\coqdocnotation{)}). \coqdoctac{intro} \coqdocvar{f}. \coqdocvar{contradiction} (\coqdocvar{f} \coqdocvar{x}).\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{contradiction} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 16}{\coqdocsection{Exercise3\_16}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.17}{128}
Show that the rules for the propositional truncation given in \S3.7 are
sufficient to imply the following induction principle: for any type family $B :
\brck{A} \to \UU$ such that each $B(x)$ is a mere proposition, if for every
$a:A$ we have $B(\lvert a \rvert)$, then for every $x : \brck{A}$ we have
$B(x)$.


 \soln
Suppose that $B : \brck{A} \to \UU$, $B(x)$ is a mere proposition for all $x :
\brck{A}$ and that $f : \prd{a:A} B(\lvert a \rvert)$. Suppose that $x
: \brck{A}$; we need to construct an element of $B(x)$.  By the
induction principle for $\brck{A}$, it suffices to exhibit a map $A
\to B(x)$.  So suppose that $a:A$, and we'll construct an element of
$B(x)$.  Since $\brck{A}$ is contractible, we have $p : \lvert a
\rvert = x$, and $p_{*}(f(a)) : B(x)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 17}{ex3\_17}{\coqdoclemma{ex3\_17}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHProp} (\coqdocvariable{B} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a}, \coqdocvariable{B} (\coqdocconstructor{tr} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{B} \coqdocvariable{x}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HB} \coqdocvar{f}. \coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{Trunc\_rect}. \coqdoctac{apply} \coqdocvar{HB}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} (\coqdocvar{f} \coqdocvar{a}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.18}{128}
Show that the law of excluded middle
\[
  \LEM{} : \prd{A:\UU} \left( \isprop(A) \to (A + \lnot A)\right)
\]
and the law of double negation
\[
  \DN : \prd{A:\UU} \left( \isprop(A) \to (\lnot\lnot A \to A)\right)
\]
are logically equivalent.


 \soln
For the forward direction, suppose that $\LEM{}$ holds, that $A : \UU$,
that $H : \isprop(A)$, and that $f : \lnot\lnot A$.  We then need to produce an
element of $A$.  We have $z \defeq \LEM{}(A, H) : A + \lnot A$, so we can
consider cases:



\begin{itemize}
\item  $z \equiv \inl(a)$, in which case we can produce $a$.

\item  $z \equiv \inr(x)$, in which case we have $f(x) : \emptyt$, a contradiction.

\end{itemize}
giving the forward direction.


Suppose instead that $\DN$ holds, and we have $A : \UU$ and $H : \isprop(A)$.
We need to provide an element of $A + \lnot A$.  By Exercise 3.6, $A + \lnot A$
is a mere proposition, so by $\DN$, if we can give an element of $\lnot\lnot(A
+ \lnot A)$, then we'll get one of $A + \lnot A$.  In Exercise 1.13 we
constructed such an element, so producing that gives one of $A + \lnot A$, and
we're done.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 18}{ex3\_18}{\coqdoclemma{ex3\_18}} `\{\coqdocclass{Funext}\} : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\leftrightarrow}}} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{LEM} \coqdocvar{A} \coqdocvar{H'} \coqdocvar{f}. \coqdoctac{destruct} (\coqdocvar{LEM} \coqdocvar{A} \coqdocvar{H'}). \coqdoctac{apply} \coqdocvar{a}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{DN} \coqdocvar{A} \coqdocvar{H'}. \coqdoctac{apply} (\coqdocvar{DN} (\coqdocvar{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvar{A}) (\coqref{Ch03.ex3 6}{\coqdoclemma{ex3\_6}} \coqdocvar{H'})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} (\coqdockw{fun} \coqdocvar{g} : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvar{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvar{A}\coqdocnotation{)} \ensuremath{\Rightarrow} \coqdocvariable{g} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} (\coqdockw{fun} \coqdocvar{a}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvariable{g} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{a})))).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.19}{128}
Suppose $P : \mathbb{N} \to \UU$ is a decidable family of mere propositions.
Prove that
\[
  \left\lVert \sm{n:\mathbb{N}} P(n) \right\rVert
  \to
  \sm{n:\mathbb{N}} P(n).
\]


 \soln
Since $P : \mathbb{N} \to \UU$ is decidable, we have $f : \prd{n:\mathbb{N}}
(P(n) + \lnot P(n))$.  So if $\bbrck{\sm{n:\mathbb{N}}
P(n)}$ is inhabited, then there is some smallest $n$ such that $P(n)$.
It would be nice if we could define a function to return the
smallest $n$ such that $P(n)$.  But unbounded minimization isn't a
total function, so that won't obviously work.  Following the
discussion of Corollary 3.9.2, what we can do instead is to define some
\[
  Q : \left(\sm{n:\mathbb{N}} P(n)\right) \to \UU
\]
such that $\sm{w:\sm{n:\mathbb{N}} P(n)} Q(w)$ is a mere proposition.  Then
we can project out an element of $\sm{n:\mathbb{N}} P(n)$.


$Q(w)$ will be the proposition that $w$ is the smallest member of
$\sm{n\mathbb{N}}P(n)$.  Explicitly,
\[
  Q(w) \defeq 
  \prd{w' : \sm{n:\mathbb{N}}P(n)} \fst(w) \leq \fst(w')
\]
Then we have
\[
  \sm{w : \sm{n : \mathbb{N}} P(n)} Q(w)
  \equiv
  \sm{w : \sm{n : \mathbb{N}} P(n)}
  \prd{w' : \sm{n:\mathbb{N}}P(n)} \fst(w) \leq \fst(w')
\]
which we must show to be a mere proposition.  Suppose that $w$ and $w'$ are two
elements of this type.  By $\snd(w)$ and $\snd(w')$, we have $\fst(\fst(w)) \leq
\fst(\fst(w'))$ and $\fst(\fst(w')) \leq \fst(\fst(w))$, so $\fst(\fst(w)) = \fst(\fst(w'))$.  Since
$\mathbb{N}$ has decidable equality, $\fst(w) \leq \snd(w')$ is a mere
proposition for all $w$ and $w'$, meaning that $Q(w)$ is a mere proposition.
So $w = w'$, meaning that our type is contractible.


Now we can use the universal property of $\bbrck{\sm{n:\mathbb{N}}P(n)}$ to
construct an arrow into $\sm{w : \sm{n:\mathbb{N}} P(n)} Q(w)$ by way of a
function $\big(\sm{n:\mathbb{N}} P(n)\big) \to \sm{w : \sm{n:\mathbb{N}} P(n)}
Q(w)$.  So suppose that we have some element $w : \sm{n:\mathbb{N}} P(n)$.
Using bounded minimization, we can obtain the smallest element of $\sm{n:
\mathbb{N}} P(n)$ that's less than or equal to $w$, and this will in fact be
the smallest element \textit{tout court}.  This means that it's a member of our
constructed type, so we've constructed a map
\[
  \left\lVert \sm{n:\mathbb{N}} P(n) \right\rVert
  \to
  \sm{w:\sm{n:\mathbb{N}}P(n)}Q(w)
\]
and projecting out gives the function in the statement.


\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Open} \coqdockw{Scope} \coqdocvar{nat\_scope}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch03.nat code}{nat\_code}{\coqdocdefinition{nat\_code}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{n}, \coqdocvariable{m} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}, \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocinductive{Unit}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'}, \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m'} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m'} \ensuremath{\Rightarrow} \coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvar{n'} \coqdocvar{m'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch03.nat r}{nat\_r}{\coqdocdefinition{nat\_r}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{n} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{n} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocconstructor{tt}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'} \ensuremath{\Rightarrow} \coqref{Ch03.nat r}{\coqdocdefinition{nat\_r}} \coqdocvar{n'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.nat encode}{nat\_encode}{\coqdocdefinition{nat\_encode}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{p} : \coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}) : (\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m})\coqdoceol
\coqdocindent{1.00em}
:= \coqdocdefinition{transport} (\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n}) \coqdocvariable{p} (\coqref{Ch03.nat r}{\coqdocdefinition{nat\_r}} \coqdocvariable{n}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.nat decode}{nat\_decode}{\coqdocdefinition{nat\_decode}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}), \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}, \coqdocvar{m}; \coqdoctac{intro}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}. \coqdocvar{contradiction}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.equiv path nat}{equiv\_path\_nat}{\coqdoclemma{equiv\_path\_nat}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m}, \coqdocnotation{(}\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} (\coqref{Ch03.nat decode}{\coqdocdefinition{nat\_decode}} \coqdocvar{n} \coqdocvar{m}) (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdocvar{n} \coqdocvar{m}) \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{reflexivity}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}) \coqdocvar{IHn}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdoctac{apply} \coqdocdefinition{eta\_unit}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdoctac{simpl}. \coqdoctac{unfold} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{transport\_compose} \coqdocvar{\_} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Sn neq O}{Sn\_neq\_O}{\coqdoclemma{Sn\_neq\_O}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus eq O}{plus\_eq\_O}{\coqdoclemma{plus\_eq\_O}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{m} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\land}}} \coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{split}. \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le trans}{le\_trans}{\coqdoclemma{le\_trans}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m} \coqdocvar{k}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m} \coqdocvar{k} \coqdocvar{Hnm} \coqdocvar{Hmk}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{Hnm} \coqdockw{as} [\coqdocvar{l} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{Hmk} \coqdockw{as} [\coqdocvar{l'} \coqdocvar{p'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{l} \coqdocnotation{+} \coqdocvar{l'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_assoc} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p'}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le Sn le}{le\_Sn\_le}{\coqdoclemma{le\_Sn\_le}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} (\coqref{Ch03.le trans}{\coqdoclemma{le\_trans}} \coqdocvar{n} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}) \coqdocvar{m}). \coqdoctac{\ensuremath{\exists}} 1. \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus cancelL}{plus\_cancelL}{\coqdoclemma{plus\_cancelL}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m} \coqdocvar{k}, \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{k} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{n}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{k} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le antisymmetric}{le\_antisymmetric}{\coqdoclemma{le\_antisymmetric}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{p'}].\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{q} : (\coqdocvar{n} \coqdocnotation{+} \coqdocnotation{(}\coqdocvar{k} \coqdocnotation{+} \coqdocvar{k'}\coqdocnotation{)} \coqdocnotation{=} \coqdocvar{n} \coqdocnotation{+} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_assoc} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{s} \ensuremath{\Rightarrow} \coqdocvariable{s} \coqdocnotation{+} \coqdocvar{k'}) \coqdocvar{p}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{p'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdoctac{in} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.plus eq O}{\coqdoclemma{plus\_eq\_O}} \coqdoctac{in} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdocdefinition{plus} \coqdocvar{n}) (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{q})\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.decidable paths nat}{decidable\_paths\_nat}{\coqdoclemma{decidable\_paths\_nat}} : \coqdocdefinition{decidable\_paths} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}, \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{IHn} \coqdocvar{m}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{left}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{p}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hset nat}{hset\_nat}{\coqdoclemma{hset\_nat}} : \coqdocabbreviation{IsHSet} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{apply} \coqdoclemma{hset\_decidable}. \coqdoctac{apply} \coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}}. \coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop le}{hprop\_le}{\coqdoclemma{hprop\_le}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocabbreviation{IsHProp} (\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{path\_sigma\_hprop} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{k}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{refine} \coqdoclemma{set\_path2}. \coqdoctac{apply} \coqref{Ch03.hset nat}{\coqdoclemma{hset\_nat}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{p} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}], \coqdocvar{q} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{p'}]. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{p} \coqdocnotation{@} \coqdocvar{p'}\coqdocnotation{\^{}}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop dependent}{hprop\_dependent}{\coqdoclemma{hprop\_dependent}} `\{\coqdocclass{Funext}\} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a}, \coqdocabbreviation{IsHProp} (\coqdocvariable{P} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} (\coqdockw{\ensuremath{\forall}} \coqdocvar{a}, \coqdocvariable{P} \coqdocvariable{a}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{HP}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{p'}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} \coqdocvar{HP}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.n le n}{n\_le\_n}{\coqdocdefinition{n\_le\_n}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n} := \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvariable{n}\coqdocnotation{)\^{}}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.n le Sn}{n\_le\_Sn}{\coqdocdefinition{n\_le\_Sn}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} := \coqdocnotation{(}\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvariable{n}\coqdocnotation{)\^{}}\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Spred}{Spred}{\coqdoclemma{Spred}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqdocdefinition{pred} \coqdocvariable{n}) \coqdocnotation{=} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}; \coqdoctac{intro} \coqdocvar{H}; [\coqdocvar{contradiction} \coqdocvar{H}|]; \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le partitions}{le\_partitions}{\coqdoclemma{le\_partitions}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{m}. \coqdoctac{right}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{IHn} \coqdocvar{m}) \coqdockw{as} [\coqdocvar{IHnm} \ensuremath{|} \coqdocvar{IHnm}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{apply} (\coqref{Ch03.le trans}{\coqdoclemma{le\_trans}} \coqdocvar{\_} \coqdocvar{n}). \coqdoctac{apply} \coqdocvar{IHnm}. \coqdoctac{apply} \coqref{Ch03.n le Sn}{\coqdocdefinition{n\_le\_Sn}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{IHnm} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{n} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{\ensuremath{\exists}} 1. \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{p0}\coqdocnotation{\^{}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{k}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{f\_ap}. \coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdocdefinition{plus} \coqdocvar{n}) \coqdocvar{H}\coqdocnotation{\^{}}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le neq  lt}{le\_neq\_\_lt}{\coqdoclemma{le\_neq\_\_lt}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}. \coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{k}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}. \coqdoctac{intro} \coqdocvar{Hk}. \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Hk}\coqdocnotation{\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt partitions}{lt\_partitions}{\coqdoclemma{lt\_partitions}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{n}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{n} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.le partitions}{\coqdoclemma{le\_partitions}} \coqdocvar{n} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}}. \coqdoctac{apply} \coqdocvar{l}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{left}. \coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}}. \coqdoctac{apply} \coqdocvar{l}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.p nnp}{p\_nnp}{\coqdoclemma{p\_nnp}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{P}, \coqdocvariable{P} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{auto}. \coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n nlt n}{n\_nlt\_n}{\coqdoclemma{n\_nlt\_n}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{n}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{p} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n neq Sn}{n\_neq\_Sn}{\coqdoclemma{n\_neq\_Sn}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n lt Sm  n le m}{n\_lt\_Sm\_\_n\_le\_m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{plus\_n\_Sm}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le O}{le\_O}{\coqdoclemma{le\_O}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.plus eq O}{\coqdoclemma{plus\_eq\_O}} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt 1}{lt\_1}{\coqdoclemma{lt\_1}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} 1 \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le O}{\coqdoclemma{le\_O}}. \coqdoctac{apply} \coqref{Ch03.n lt Sm  n le m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt le}{lt\_le}{\coqdoclemma{lt\_le}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Sn lt Sm  n lt m}{Sn\_lt\_Sm\_\_n\_lt\_m}{\coqdoclemma{Sn\_lt\_Sm\_\_n\_lt\_m}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt neq}{lt\_neq}{\coqdoclemma{lt\_neq}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{p} \coqdocnotation{@} \coqdocvar{HX}\coqdocnotation{\^{}}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{apply} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{Hx}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.Sn lt Sm  n lt m}{\coqdoclemma{Sn\_lt\_Sm\_\_n\_lt\_m}} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHn} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{apply} \coqdocvar{Hx}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt trans}{lt\_trans}{\coqdoclemma{lt\_trans}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{k} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{l} \coqdocvar{p}], \coqdocvar{H2} \coqdockw{as} [\coqdocvar{l'} \coqdocvar{p'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocvar{l} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{l'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{change} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqdocvar{l} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{l'})) \coqdockw{with} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{l} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{l'}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_assoc} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n lt Sn}{n\_lt\_Sn}{\coqdoclemma{n\_lt\_Sn}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bound up}{bound\_up}{\coqdoclemma{bound\_up}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le lt  lt}{le\_lt\_\_lt}{\coqdoclemma{le\_lt\_\_lt}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{k} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{n} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H2} \coqdockw{as} [\coqdocvar{l} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{q}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}}. \coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt le  lt}{lt\_le\_\_lt}{\coqdoclemma{lt\_le\_\_lt}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{k} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{l} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}). \coqdoctac{apply} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}}. \coqdoctac{apply} \coqdocvar{H2}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le eq  le}{le\_eq\_\_le}{\coqdoclemma{le\_eq\_\_le}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{l} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{apply} (\coqdocvar{p} \coqdocnotation{@} \coqdocvar{H2}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n le m  Sn le Sm}{n\_le\_m\_\_Sn\_le\_Sm}{\coqdoclemma{n\_le\_m\_\_Sn\_le\_Sm}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{simpl}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Sn le Sm  n le m}{Sn\_le\_Sm\_\_n\_le\_m}{\coqdoclemma{Sn\_le\_Sm\_\_n\_le\_m}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n nlt O}{n\_nlt\_O}{\coqdoclemma{n\_nlt\_O}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{<} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{p}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.O lt n}{O\_lt\_n}{\coqdoclemma{O\_lt\_n}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqdocnotation{<} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n lt m  Sn lt Sm}{n\_lt\_m\_\_Sn\_lt\_Sm}{\coqdoclemma{n\_lt\_m\_\_Sn\_lt\_Sm}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{simpl}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n lt m  n le Sm}{n\_lt\_m\_\_n\_le\_Sm}{\coqdoclemma{n\_lt\_m\_\_n\_le\_Sm}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k})). \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}) \coqdoctac{in} \coqdocvar{p}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{symmetry}. \coqdoctac{apply} \coqdoclemma{plus\_n\_Sm}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt bound down}{lt\_bound\_down}{\coqdoclemma{lt\_bound\_down}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{k}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{X}. \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)}). \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt bound up}{lt\_bound\_up}{\coqdoclemma{lt\_bound\_up}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{k}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}. \coqdocvar{f\_ap}. \coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}. \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{X}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}. \coqdocvar{f\_ap}. \coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.pred n eq O}{pred\_n\_eq\_O}{\coqdoclemma{pred\_n\_eq\_O}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocdefinition{pred} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} 1\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{right}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bound down}{bound\_down}{\coqdoclemma{bound\_down}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}} \coqdoctac{in} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.nle lt}{nle\_lt}{\coqdoclemma{nle\_lt}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqdocnotation{)} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H}. \coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{reflexivity}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{m}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{n}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqref{Ch03.n lt m  Sn lt Sm}{\coqdoclemma{n\_lt\_m\_\_Sn\_lt\_Sm}}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{H'} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{simpl}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Sn neq n}{Sn\_neq\_n}{\coqdoclemma{Sn\_neq\_n}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} 1 0).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt antisymmetric}{lt\_antisymmetric}{\coqdoclemma{lt\_antisymmetric}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{n}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}], \coqdocvar{HX} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{p'}].\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H} : (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k'} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p'}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_assoc} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.lt eq  lt}{lt\_eq\_\_lt}{\coqdoclemma{lt\_eq\_\_lt}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H1} \coqdockw{as} [\coqdocvar{l} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{refine} (\coqdocvar{p} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{H2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.nlt le}{nlt\_le}{\coqdoclemma{nlt\_le}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}\coqdocnotation{)} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H}. \coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{symmetry}. \coqdoctac{apply} \coqdoclemma{plus\_O\_r}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.O lt n}{\coqdoclemma{O\_lt\_n}}. \coqdoctac{apply} \coqdocvar{n}. \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}). \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.n le m  Sn le Sm}{\coqdoclemma{n\_le\_m\_\_Sn\_le\_Sm}}. \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.n lt m  Sn lt Sm}{\coqdoclemma{n\_lt\_m\_\_Sn\_lt\_Sm}}. \coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n lt m  Sn le m}{n\_lt\_m\_\_Sn\_le\_m}{\coqdoclemma{n\_lt\_m\_\_Sn\_le\_m}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{<} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n lt m  Sn lt Sm}{\coqdoclemma{n\_lt\_m\_\_Sn\_lt\_Sm}} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n lt Sm  n le m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.n le m  n lt Sm}{n\_le\_m\_\_n\_lt\_Sm}{\coqdoclemma{n\_le\_m\_\_n\_lt\_Sm}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 19}{Exercise3\_19}{\coqdocsection{Exercise3\_19}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Context} \{\coqdocvar{P} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}\} \{\coqdocvar{HP} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocabbreviation{IsHProp} (\coqdocvariable{P} \coqdocvariable{n})\}\coqdoceol
\coqdocindent{4.00em}
\{\coqdocvar{DP} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvariable{P} \coqdocvariable{n} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{n}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Definition} \coqdef{Ch03.Q}{Q}{\coqdocdefinition{Q}} (\coqdocvar{w} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) : \coqdockw{Type} := \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{w'} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}, \coqdocvariable{w}\coqdocnotation{.1} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{w'}\coqdocnotation{.1}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop Q}{hprop\_Q}{\coqdoclemma{hprop\_Q}} `\{\coqdocclass{Funext}\} : \coqdockw{\ensuremath{\forall}} \coqdocvar{w}, \coqdocabbreviation{IsHProp} (\coqref{Ch03.Q}{\coqdocdefinition{Q}} \coqdocvariable{w}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{unfold} \coqref{Ch03.Q}{\coqdocdefinition{Q}}. \coqdoctac{apply} \coqref{Ch03.hprop dependent}{\coqdoclemma{hprop\_dependent}}. \coqdoctac{intro} \coqdocvar{w'}. \coqdoctac{apply} \coqref{Ch03.hprop le}{\coqdoclemma{hprop\_le}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop sigma Q}{hprop\_sigma\_Q}{\coqdoclemma{hprop\_sigma\_Q}} `\{\coqdocclass{Funext}\} : \coqdocabbreviation{IsHProp} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{w} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Q}{\coqdocdefinition{Q}} \coqdocvar{w}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{w} \coqdocvar{w'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{path\_sigma\_hprop} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}). \coqdoctac{apply} \coqref{Ch03.hprop Q}{\coqdoclemma{hprop\_Q}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_hprop}. \coqdoctac{apply} \coqref{Ch03.le antisymmetric}{\coqdoclemma{le\_antisymmetric}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{w}\coqdocnotation{.2} \coqdocvar{w'}\coqdocnotation{.1}). \coqdoctac{apply} (\coqdocvar{w'}\coqdocnotation{.2} \coqdocvar{w}\coqdocnotation{.1}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.bmin}{bmin}{\coqdocdefinition{bmin}} (\coqdocvar{bound} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{bound} \coqdockw{as} [|\coqdocvar{z}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{apply} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{apply} 1.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} \coqdocvar{IHz} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{z})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHz}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{z})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{z}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{z})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{z})).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct O}{bmin\_correct\_O}{\coqdoclemma{bmin\_correct\_O}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{P} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{DP} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{reflexivity}. \coqdoctac{apply} \coqdocvar{n} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHn}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct self P}{bmin\_correct\_self\_P}{\coqdoclemma{bmin\_correct\_self\_P}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{Ho}. \coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdoctac{in} \coqdocvar{Ho}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{X} : \coqdocinductive{Empty}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch03.n neq Sn}{\coqdoclemma{n\_neq\_Sn}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{X} : \coqdocinductive{Empty}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch03.n neq Sn}{\coqdoclemma{n\_neq\_Sn}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct bound}{bmin\_correct\_bound}{\coqdoclemma{bmin\_correct\_bound}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{\ensuremath{\exists}} 1. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{apply} \coqdoclemma{plus\_n\_Sm}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch03.le trans}{\coqdoclemma{le\_trans}} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqref{Ch03.n le Sn}{\coqdocdefinition{n\_le\_Sn}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqref{Ch03.n le Sn}{\coqdocdefinition{n\_le\_Sn}}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqref{Ch03.n le n}{\coqdocdefinition{n\_le\_n}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqref{Ch03.n le n}{\coqdocdefinition{n\_le\_n}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct nPn}{bmin\_correct\_nPn}{\coqdoclemma{bmin\_correct\_nPn}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{=} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.bmin correct O}{\coqdoclemma{bmin\_correct\_O}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}) \coqdoctac{in} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} 1 \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{refine} (\coqdocvar{H}\coqdocnotation{\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{HX}). \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H} \coqdocvar{HX}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{Ho}. \coqdoctac{apply} (\coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{Ho}. \coqdoctac{apply} \coqref{Ch03.n lt Sn}{\coqdoclemma{n\_lt\_Sn}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.n neq Sn}{\coqdoclemma{n\_neq\_Sn}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{HX}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.le lt  lt}{\coqdoclemma{le\_lt\_\_lt}} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct success}{bmin\_correct\_success}{\coqdoclemma{bmin\_correct\_success}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{<} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.lt 1}{\coqdoclemma{lt\_1}} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.bmin correct self P}{\coqdoclemma{bmin\_correct\_self\_P}} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqref{Ch03.bmin correct O}{\coqdoclemma{bmin\_correct\_O}} \coqdocvar{\_} \coqdocvar{H}\coqdocnotation{)\^{}} \coqdocnotation{\#} \coqdocvar{H}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct i}{bmin\_correct\_i}{\coqdoclemma{bmin\_correct\_i}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H1} \coqdocvar{H2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n nlt O}{\coqdoclemma{n\_nlt\_O}} \coqdoctac{in} \coqdocvar{H1}. \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{m}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{n} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}).\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=\coqdocindent{0.50em}
O\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
we\coqdocindent{0.50em}
just\coqdocindent{0.50em}
want\coqdocindent{0.50em}
the\coqdocindent{0.50em}
contrapositive\coqdocindent{0.50em}
of\coqdocindent{0.50em}
bmin\_correct\_O\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} (\coqref{Ch03.bmin correct O}{\coqdoclemma{bmin\_correct\_O}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{rewrite} \coqdocvar{H'} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
n\coqdocindent{0.50em}
<>\coqdocindent{0.50em}
O\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqref{Ch03.O lt n}{\coqdoclemma{O\_lt\_n}}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
<\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{Ho}. \coqdoctac{apply} \coqref{Ch03.O lt n}{\coqdoclemma{O\_lt\_n}}. \coqdoctac{apply} \coqref{Ch03.Sn neq O}{\coqdoclemma{Sn\_neq\_O}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{apply} \coqref{Ch03.O lt n}{\coqdoclemma{O\_lt\_n}}. \coqdoctac{apply} \coqref{Ch03.Sn neq O}{\coqdoclemma{Sn\_neq\_O}}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H1}. \coqdoctac{apply} \coqref{Ch03.Sn lt Sm  n lt m}{\coqdoclemma{Sn\_lt\_Sm\_\_n\_lt\_m}} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
<\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.lt bound down}{\coqdoclemma{lt\_bound\_down}} \coqdoctac{in} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n})). \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{Ho}. \coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m}) \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.bmin correct nPn}{\coqdoclemma{bmin\_correct\_nPn}}. \coqdoctac{rewrite} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.lt bound up}{\coqdoclemma{lt\_bound\_up}} \coqdoctac{in} \coqdocvar{H1}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt trans}{\coqdoclemma{lt\_trans}} \coqdocvar{\_} \coqdocvar{n}). \coqdoctac{apply} \coqdocvar{H1}. \coqdoctac{rewrite} \coqdocvar{Ho}. \coqdoctac{apply} \coqref{Ch03.n lt Sn}{\coqdoclemma{n\_lt\_Sn}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Case:\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
>\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H} := (\coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt le  lt}{\coqdoclemma{lt\_le\_\_lt}} \coqdocvar{\_} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{Ho}. \coqdoctac{apply} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct i'}{bmin\_correct\_i'}{\coqdoclemma{bmin\_correct\_i'}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{clear} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H'} := (\coqref{Ch03.bmin correct nPn}{\coqdoclemma{bmin\_correct\_nPn}} \coqdocvar{n})). \coqdoctac{rewrite} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{H'}. \coqdoctac{clear} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H'} := (\coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}} \coqdocvar{n})). \coqdoctac{rewrite} \coqdocvar{p} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le antisymmetric}{\coqdoclemma{le\_antisymmetric}}. \coqdoctac{apply} \coqdocvar{H'}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{k} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{q}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{generalize} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.bmin correct i}{\coqdoclemma{bmin\_correct\_i}}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct leb}{bmin\_correct\_leb}{\coqdoclemma{bmin\_correct\_leb}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{P} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} (\coqref{Ch03.bmin correct O}{\coqdoclemma{bmin\_correct\_O}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}) \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{H}). \coqdoctac{symmetry}. \coqdoctac{apply} \coqdoclemma{plus\_O\_r}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{Ho} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}]. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n})). \coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{symmetry}. \coqdoctac{apply} \coqdoclemma{plus\_O\_r}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{n0} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.le trans}{\coqdoclemma{le\_trans}} \coqdocvar{\_} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n lt m  Sn le m}{\coqdoclemma{n\_lt\_m\_\_Sn\_le\_m}}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct i cp}{bmin\_correct\_i\_cp}{\coqdoclemma{bmin\_correct\_i\_cp}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{P} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H'} : (\coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{<} \coqdocvariable{n} \coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\land}}} \coqdocvariable{m} \coqdocnotation{<} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{m}\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n'} \coqdocvar{m'} \coqdocvar{H'}. \coqdoctac{apply} (\coqref{Ch03.bmin correct i}{\coqdoclemma{bmin\_correct\_i}} \coqdocvar{n'}). \coqdoctac{apply} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{H'}). \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{H'}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H'{}'} : (\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvar{m})). \coqdoctac{apply} \coqref{Ch03.p nnp}{\coqdoclemma{p\_nnp}}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} (\coqdocvar{H'} \coqdocvar{n} \coqdocvar{m})) \coqdoctac{in} \coqdocvar{H'{}'}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H'{}'{}'} : (\coqexternalref{sum}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{sum}} (\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvar{m} \coqdocnotation{<} \coqdocvar{n}\coqdocnotation{)}) (\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvar{m} \coqdocnotation{<} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}\coqdocnotation{)}))).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} \coqdocvar{n} \coqdocvar{m}) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{left}. \coqdoctac{apply} \coqref{Ch03.lt antisymmetric}{\coqdoclemma{lt\_antisymmetric}}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{left}. \coqdoctac{intro} \coqdocvar{H'{}'{}'}. \coqdoctac{apply} (\coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdocvar{n}). \coqdoctac{apply} (\coqref{Ch03.lt eq  lt}{\coqdoclemma{lt\_eq\_\_lt}} \coqdocvar{m} \coqdocvar{n} \coqdocvar{m}) \coqdoctac{in} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdocvar{m}) \coqdoctac{in} \coqdocvar{H'{}'{}'}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{H'{}'}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{Ho}. \coqdoctac{apply} \coqdocvar{H'{}'{}'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H'{}'{}'}; \coqdoctac{clear} \coqdocvar{H'{}'} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.nlt le}{\coqdoclemma{nlt\_le}} \coqdoctac{in} \coqdocvar{n0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.nlt le}{\coqdoclemma{nlt\_le}}. \coqdoctac{intro} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H'{}'} := (\coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{Heq} : (\coqdocvar{n} \coqdocnotation{=} \coqdocvar{m})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le antisymmetric}{\coqdoclemma{le\_antisymmetric}}. \coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqref{Ch03.n lt Sm  n le m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt le  lt}{\coqdoclemma{lt\_le\_\_lt}} \coqdocvar{\_} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{n}) \coqdocvar{\_}). \coqdoctac{apply} \coqdocvar{H'}. \coqdoctac{apply} \coqdocvar{H'{}'}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{Hle} : (\coqdocvar{m} \coqdocnotation{\ensuremath{\le}} \coqdocvar{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{Heq}\coqdocnotation{\^{}}). \coqdoctac{symmetry}. \coqdoctac{apply} \coqdoclemma{plus\_O\_r}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdocvar{H}. \coqdoctac{change} (\coqdocvariable{P} \coqdocvar{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocinductive{Empty}) \coqdockw{with} (\coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.bmin correct i'}{\coqdoclemma{bmin\_correct\_i'}} \coqdocvar{n}). \coqdoctac{apply} \coqdocvar{Hle}. \coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.nlt le}{\coqdoclemma{nlt\_le}} \coqdoctac{in} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.bmin correct}{bmin\_correct}{\coqdoclemma{bmin\_correct}} (\coqdocvar{bound} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n} \coqexternalref{:type scope:x '/x5C' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\land}}} \coqdocvar{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{bound}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvariable{P} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvariable{bound} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{bound}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w} \coqdocvar{n} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{w} [\coqdocvar{a} \coqdocvar{b}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le O}{\coqdoclemma{le\_O}} \coqdoctac{in} \coqdocvar{b}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{n}. \coqdoctac{transitivity} (\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqdocnotation{+} \coqdocvar{n}). \coqdocvar{f\_ap}. \coqdoctac{apply} \coqref{Ch03.bmin correct O}{\coqdoclemma{bmin\_correct\_O}}. \coqdoctac{apply} (\coqdocvar{b} \coqdocnotation{\#} \coqdocvar{a}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w} \coqdocvar{n} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.lt partitions}{\coqdoclemma{lt\_partitions}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{bound}) (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{bound})) \coqdockw{as} [[\coqdocvar{Ho} \ensuremath{|} \coqdocvar{Ho}] \ensuremath{|} \coqdocvar{Ho}].\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
<\coqdocindent{0.50em}
S\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHbound}. \coqdoctac{\ensuremath{\exists}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{bound}). \coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.bmin correct success}{\coqdoclemma{bmin\_correct\_success}}. \coqdoctac{apply} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{Ho} \coqdockw{as} [\coqdocvar{k} \coqdocvar{q}]. \coqdoctac{\ensuremath{\exists}} \coqdocvar{k}. \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
=\coqdocindent{0.50em}
S\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{w} [\coqdocvar{a} \coqdocvar{b}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{w} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{bound})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{DP} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{bound})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.nlt le}{\coqdoclemma{nlt\_le}}. \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdocvar{p}. \coqdoctac{change} (\coqdocvariable{P} \coqdocvar{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocinductive{Empty}) \coqdockw{with} (\coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.bmin correct i'}{\coqdoclemma{bmin\_correct\_i'}} \coqdocvar{bound}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n lt Sm  n le m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}}. \coqdoctac{apply} \coqdocvar{H}. \coqdoctac{rewrite} \coqdocvar{Ho}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{p0} \coqdoctac{in} \coqdocvar{n0}. \coqdoctac{apply} \coqdocvar{n0} \coqdoctac{in} \coqdocvar{a}. \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.le neq  lt}{\coqdoclemma{le\_neq\_\_lt}} \coqdoctac{in} \coqdocvar{b}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n lt Sm  n le m}{\coqdoclemma{n\_lt\_Sm\_\_n\_le\_m}} \coqdoctac{in} \coqdocvar{b}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{Hlt} : (\coqdocvar{w} \coqdocnotation{<} \coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{bound})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqref{Ch03.lt eq  lt}{\coqdoclemma{lt\_eq\_\_lt}} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{bound})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqref{Ch03.n le m  n lt Sm}{\coqdoclemma{n\_le\_m\_\_n\_lt\_Sm}}. \coqdoctac{apply} \coqdocvar{b}. \coqdoctac{apply} \coqdocvar{Ho}\coqdocnotation{\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{generalize} \coqdocvar{a}. \coqdoctac{change} (\coqdocvariable{P} \coqdocvar{w} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocinductive{Empty}) \coqdockw{with} (\coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvar{w}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.bmin correct i'}{\coqdoclemma{bmin\_correct\_i'}} \coqdocvar{bound}). \coqdoctac{apply} \coqdocvar{b}. \coqdoctac{apply} \coqdocvar{Hlt}. \coqdocvar{contradiction}. \coqdoctac{apply} \coqdocvar{n0}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
S\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
<\coqdocindent{0.50em}
bmin\coqdocindent{0.50em}
bound\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H} := (\coqref{Ch03.bmin correct bound}{\coqdoclemma{bmin\_correct\_bound}} \coqdocvar{bound})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.lt le  lt}{\coqdoclemma{lt\_le\_\_lt}} \coqdocvar{\_} \coqdocvar{\_} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{bound})) \coqdoctac{in} \coqdocvar{Ho}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n nlt n}{\coqdoclemma{n\_nlt\_n}} \coqdoctac{in} \coqdocvar{Ho}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.ex3 19}{ex3\_19}{\coqdoclemma{ex3\_19}} `\{\coqdocclass{Funext}\} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocabbreviation{pr1} \coqdocvar{\_} \coqref{Ch03.Q}{\coqdocdefinition{Q}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H'} := \coqref{Ch03.hprop sigma Q}{\coqdoclemma{hprop\_sigma\_Q}}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{strip\_truncations}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{w'} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqref{Ch03.bmin}{\coqdocdefinition{bmin}} \coqdocvar{w}\coqdocnotation{.1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.bmin correct success}{\coqdoclemma{bmin\_correct\_success}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.n le m  n lt Sm}{\coqdoclemma{n\_le\_m\_\_n\_lt\_Sm}}. \coqdoctac{apply} \coqref{Ch03.bmin correct leb}{\coqdoclemma{bmin\_correct\_leb}}. \coqdoctac{apply} \coqdocvar{w}\coqdocnotation{.2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{w'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch03.Q}{\coqdocdefinition{Q}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w'{}'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.bmin correct}{\coqdoclemma{bmin\_correct}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{w}\coqdocnotation{.1}. \coqdoctac{split}. \coqdoctac{apply} \coqdocvar{w}\coqdocnotation{.2}. \coqdoctac{apply} \coqref{Ch03.n le n}{\coqdocdefinition{n\_le\_n}}. \coqdoctac{apply} \coqdocvar{w'{}'}\coqdocnotation{.2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 19}{\coqdocsection{Exercise3\_19}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Close} \coqdockw{Scope} \coqdocvar{nat\_scope}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.20}{128}
Prove Lemma 3.11.9(ii): if $A$ is contractible with center $a$, then
$\sm{x:A}P(x)$ is equivalent to $P(a)$.


 \soln
Suppose that $A$ is contractible with center $a$.  For the forward direction,
suppose that $w : \sm{x:A} P(x)$.  Then $\fst(w) = a$, since $A$ is
contractible, so from $\snd(w) : P(\fst(w))$ and the indiscernibility
of identicals, we have $P(a)$.  For the backward direction, suppose
that $p : P(a)$.  Then we have $(a, p) : \sm{x:A} P(x)$.


To show that these are quasi-inverses, suppose that $p : P(a)$.  Going backward
gives $(a, p) : \sm{x:A} P(x)$, and going forward we have
$(\contr_{a}^{-1})_{*}p$.  Since $A$ is contractible, $\contr_{a} =
\refl{a}$, so this reduces to $p$, as needed.
For the other direction, suppose that $w : \sm{x:X} P(x)$.  Going forward gives
$(\contr_{\fst(w)}^{-1})_{*}\snd(w) : P(a)$, and going back gives
\[
  (a, (\contr_{\fst(w)}^{-1})_{*}\snd(w)) : \sm{x:A} P(x)
\]
By Theoremm 2.7.2, it suffices to show that $a = \fst(w)$ and that
\[
  (\contr_{\fst(w)})_{*}(\contr_{\fst(w)}^{-1})_{*} \snd(w) = \snd(w)
\]
The first of these is given by the fact that $A$ is contractible.  The second
results from the functorality of transport.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.equiv sigma contr base}{equiv\_sigma\_contr\_base}{\coqdoclemma{equiv\_sigma\_contr\_base}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{Contr} \coqdocvariable{A}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{P} (\coqdocmethod{center} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{apply} (\coqdocdefinition{transport} \coqdocvar{\_} \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{w}\coqdocnotation{.1}\coqdocnotation{)\^{}}). \coqdoctac{apply} \coqdocvar{w}\coqdocnotation{.2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{apply} \coqdocnotation{(}\coqdocmethod{center} \coqdocvar{A}\coqdocnotation{;} \coqdocvar{p}\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{Contr} (\coqdocmethod{center} \coqdocvar{A} \coqdocnotation{=} \coqdocmethod{center} \coqdocvar{A})). \coqdoctac{apply} \coqdocinstance{contr\_paths\_contr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocmethod{contr} (\coqdocmethod{center} \coqdocvar{A}) \coqdocnotation{=} \coqdocconstructor{idpath}). \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{X0}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{\ensuremath{\exists}} (\coqdocmethod{contr} \coqdocvar{w}\coqdocnotation{.1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{transport\_pV}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.21}{128}
Prove that $\isprop(P) \eqvsym (P \eqvsym \brck{P})$.


 \soln
$\isprop(P)$ is a mere proposition by Lemma 3.3.5.  $P \eqvsym \brck{P}$ is
also a mere proposition.  An equivalence is determined by its underlying
function, and for all $f, g : P \to \brck{P}$, $f = g$ by function
extensionality and the fact that $\brck{P}$ is a mere proposition.  Since each
of the two sides is a mere proposition, we just need to show that they imply
each other, by Lemma 3.3.3.  Lemma 3.9.1 gives the forward direction.  For the
backward direction, suppose that $e : P \eqvsym \brck{P}$, and let $x, y : P$.
Then $e(x) = e(y)$, since $\brck{P}$ is a proposition, and applying $e^{-1}$ to
each side gives $x = y$.  Thus $P$ is a mere proposition.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 21}{ex3\_21}{\coqdoclemma{ex3\_21}} `\{\coqdocclass{Funext}\} (\coqdocvar{P} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{P}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocvar{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvar{P})). \coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{e1} \coqdocvar{e2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_equiv}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{HP}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}. \coqdoctac{apply} \coqdocconstructor{tr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{Trunc\_rect}. \coqdoctac{intro} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{HP}. \coqdoctac{apply} \coqdocabbreviation{idmap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{e}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{e} \coqdocvar{x} \coqdocnotation{=} \coqdocvar{e} \coqdocvar{y}) \coqdockw{as} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocnotation{(}\coqdocmethod{eissect} \coqdocvar{e} \coqdocvar{x}\coqdocnotation{)\^{}}. \coqdoctac{rewrite} \coqdocnotation{(}\coqdocmethod{eissect} \coqdocvar{e} \coqdocvar{y}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqdocvar{e}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{3.22}{128}
As in classical set theory, the finite version of the axiom of choice is a
theorem.  Prove that the axiom of choice holds when $X$ is a finite type
$\Fin(n)$.


 \soln
We want to show that for all $n$, $A : \Fin(n) \to \UU$, and 
$P : \prd{m_{n} : \Fin(n)} A(m_{n}) \to \UU$, if $A$ is a family of sets and
$P$ a family of propositions, then
\[
  \left(
    \prd{m_{n} : \Fin(n)} \left\lVert \sm{a:A(m_{n})} P(m_{n}, a)\right\rVert
  \right)
  \to
  \brck{
    \sm{g : \prd{m_{n} : \Fin(n)} A(m_{n})} \prd{m_{n} : \Fin(n)}
        P(m_{n}, g(m_{n}))
  }
\]


We proceed by induction on $n$.  Note first that $\eqv{\Fin(0)}{\emptyt}$ and
that $\eqv{\Fin(n + 1)}{\Fin(n) + \unit}$, which follow quickly from the fact
that $\N$ is a set.  In particular, we'll use the equivalence which sends
$n_{n+1}$ to $\star$ and $m_{n+1}$ to $m_{n}$ for $m < n$.


For the base case, $n \equiv 0$, everything is easily provided by ex falso
quodlibet.  
For the induction step, we can define a new family of sets $A' : (\Fin(n) +
\unit) \to \UU$ as follows:
\begin{align*}
  A'(z) &= \begin{cases}
             A(m_{n+1}) & \text{if $z \equiv m_{n}$} \\
             A(n_{n+1}) & \text{if $z \equiv \star$}
           \end{cases}
\end{align*}
And if $e : \eqv{\Fin(n+1)}{\Fin(n) + \unit}$, then we clearly have
$h : \eqv{A(z)}{A'(e(z))}$ for all $z : \Fin(n+1)$.  Similarly, we can define
\begin{align*}
  P'(z, a) &= \begin{cases}
                P(m_{n+1},  h^{-1}(a)) & \text{if $z \equiv m_{n}$} \\
                P(n_{n+1}, h^{-1}(a)) & \text{if $z \equiv \star$}
              \end{cases}
\end{align*}
For which we clearly have $g : \eqv{P(z, a)}{P'(e(z), h(a))}$ for all $z$ and
$a$.  So, by the functorality of equivalence (Ex.~2.17), we have
\[
  \eqv{
    \prd{m_{n+1} : \Fin(n + 1)} \brck{\sm{a : A(m_{n+1})} P(m_{n+1}, a)}
  }{
    \prd{z : \Fin(n) + \unit} \brck{\sm{a : A'(z)} P'(z, a)}
  }
\]
But, since the induction principle for the sum type is an equivalence, we also
have
\[
  \eqv{
    \prd{z : \Fin(n) + \unit} \brck{\sm{a : A'(z)} P'(z, a)}
  }{
    \left(\prd{z : \Fin(n)} \brck{\sm{a : A'(\inl(z))} P'(\inl(z), a)}\right)
    \times
    \left(\prd{z : \unit} \brck{\sm{a : A'(\inr(z))} P'(\inr(z), a)}\right)
  }
\]
And to construct an arrow out of this, we just need to give an arrow out of
each one.  Now, by the same equivalences, we can rewrite the conclusion as
\[
  \brck{
    \sm{g : \prd{z : \Fin(n) + \unit} A'(z)}
    \prd{z : \Fin(n) + \unit}
    P'(z, g(z))
  }
\]
Using the universal property of $\Sigma$ types, we get
\[
  \brck{
    \prd{z : \Fin(n) + \unit} \sm{a : A'(z)} P'(z, a)
  }
\]
and the functorality of the induction principle for the sum gives
\[
  \brck{
    \left(\prd{z : \Fin(n)} \sm{a : A'(\inl(z))} P'(\inl(z), a)\right)
    \times
    \left(\prd{z : \unit} \sm{a : A'(\inr(z))} P'(\inr(z), a)\right)
  }
\]
Since this is only a finite product, we can take it outside of the truncation,
giving
\[
  \brck{
    \prd{z : \Fin(n)} \sm{a : A'(\inl(z))} P'(\inl(z), a)
  }
    \times
  \brck{
    \prd{z : \unit} \sm{a : A'(\inr(z))} P'(\inr(z), a)
  }
\]
and using the universal property of $\Sigma$ types to go back once more, we
finally arrive at
\[
  \brck{
    \sm{g : \prd{z : \Fin(n)} A'(\inl(z))} 
    \prd{z : \Fin(n)} 
    P'(\inl(z), g(z))
  }
    \times
  \brck{
    \prd{z : \unit} 
    \sm{a : A'(\inr(z))}
    P'(\inr(z), a)
  }
\]
Since each of the domain and codomain are products, we can produce the required
map by giving one between the first items of each product and one between the
second.  So first we need an arrow
\[
  \prd{m_{n} : \Fin(n)} \brck{\sm{a : A'(\inl(m_{n}))} P'(\inl(m_{n}), a)}
  \to
  \brck{
    \sm{g : \prd{m_{n} : \Fin(n)} A'(\inl(m_{n}))}
    \prd{m_{n} : \Fin(n)}
    P'(\inl(m_{n}), g(m_{n}))
  }
\]
but by definition of $A'$ and $P'$, this is just
\[
  \prd{m_{n} : \Fin(n)} \brck{\sm{a : A(m_{n})} P(m_{n}, a)}
  \to
  \brck{
    \sm{g : \prd{m_{n} : \Fin(n)} A(m_{n})}
    \prd{m_{n} : \Fin(n)}
    P(m_{n}, g(m_{n}))
  }
\]
which is the induction hypothesis. For the second map, we need
\[
  \prd{z : \unit}\brck{\sm{a : A'(\inr(z))} P'(\inr(z), a)}
  \to
  \brck{\prd{z : \unit}\sm{a : A'(\inr(z))} P'(\inr(z), a)}
\]
which by the computation rules for $A'$ and $P'$ is
\[
  \left(\unit \to \brck{\sm{a : A(n_{n+1})} P(n_{n+1}, a)}\right)
  \to
  \brck{\unit \to \sm{a : A(n_{n+1})} P(n_{n+1}, a)}
\]
and this is easily constructed using the recursor for truncation.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.cardO}{cardO}{\coqdocdefinition{cardO}} : \coqdocdefinition{Fin} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocinductive{Empty}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{n} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.plus eq O}{\coqdoclemma{plus\_eq\_O}} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.isequiv cardO}{isequiv\_cardO}{\coqdoclemma{isequiv\_cardO}} : \coqdocclass{IsEquiv} \coqref{Ch03.cardO}{\coqdocdefinition{cardO}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{isequiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{Empty\_rect}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Retraction\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{n} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} (\coqdocvar{n} \coqdocnotation{=} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}) \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.plus eq O}{\coqdoclemma{plus\_eq\_O}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.cardF}{cardF}{\coqdocdefinition{cardF}} \{\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}\} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocinductive{Unit}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{\ensuremath{\exists}} (\coqdocdefinition{pred} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}. \coqdocvar{f\_ap}. \coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{n0}. \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdocvar{f\_ap}. \coqdocvar{f\_ap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{H}\coqdocnotation{\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus cancelR}{plus\_cancelR}{\coqdoclemma{plus\_cancelR}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocdefinition{plus} \coqdocvariable{m} \coqdocvariable{n} \coqdocnotation{=} \coqdocdefinition{plus} \coqdocvariable{k} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_comm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocvar{H} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_comm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop lt}{hprop\_lt}{\coqdoclemma{hprop\_lt}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocabbreviation{IsHProp} (\coqdocdefinition{lt} \coqdocvariable{n} \coqdocvariable{m}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H} : (\coqdoceol
\coqdocindent{2.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}, \coqdocabbreviation{IsHProp} ((\coqdocvar{n} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{k})\%\coqdocvar{nat} \coqdocnotation{=} \coqdocvar{m})\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{k}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} (@\coqdoclemma{set\_path2} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqref{Ch03.hset nat}{\coqdoclemma{hset\_nat}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{x} \coqdocvar{p}], \coqdocvar{y} \coqdockw{as} [\coqdocvar{y} \coqdocvar{p'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdoclemma{S\_inj}. \coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{n}). \coqdoctac{apply} (\coqdocvar{p} \coqdocnotation{@} \coqdocvar{p'}\coqdocnotation{\^{}}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.path Fin}{path\_Fin}{\coqdoclemma{path\_Fin}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{w} \coqdocvar{w'} : \coqdocdefinition{Fin} \coqdocvariable{n}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{w}\coqdocnotation{.1} \coqdocnotation{=} \coqdocvariable{w'}\coqdocnotation{.1}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{w} \coqdocnotation{=} \coqdocvariable{w'}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{m} \coqdocvar{w}], \coqdocvar{w'} \coqdockw{as} [\coqdocvar{m'} \coqdocvar{w'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{H} := \coqref{Ch03.hprop lt}{\coqdoclemma{hprop\_lt}} \coqdocvar{m'} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.isequiv cardF}{isequiv\_cardF}{\coqdoclemma{isequiv\_cardF}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocclass{IsEquiv} (@\coqref{Ch03.cardF}{\coqdocdefinition{cardF}} \coqdocvariable{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{isequiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
inverse\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{w} \ensuremath{|} \coqdocvar{t}]. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{n}. \coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{w} \ensuremath{|} \coqdocvar{t}].\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
w\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Fin\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]]. \coqdoctac{unfold} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqdocvar{n}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}) \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}). \coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{m}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqdoclemma{plus\_O\_r} \coqdocvar{\_}\coqdocnotation{)}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{p0}\coqdocnotation{\^{}}). \coqdoctac{apply} \coqdocvar{p}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}). \coqdoctac{apply} \coqref{Ch03.path Fin}{\coqdoclemma{path\_Fin}}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{2.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
t\coqdocindent{0.50em}
:\coqdocindent{0.50em}
Unit\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{unfold} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}}. \coqdoctac{simpl}. \coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{n} \coqdocvar{n}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}}). \coqdoctac{apply} \coqdocinstance{contr\_unit}. \coqdocvar{contradiction} (\coqdocvar{n0} 1).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Retraction\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]]. \coqdoctac{unfold} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.decidable paths nat}{\coqdoclemma{decidable\_paths\_nat}} \coqdocvar{m} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.path Fin}{\coqdoclemma{path\_Fin}}. \coqdoctac{apply} \coqdocvar{p0}\coqdocnotation{\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.path Fin}{\coqdoclemma{path\_Fin}}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.eq lt  lt}{eq\_lt\_\_lt}{\coqdoclemma{eq\_lt\_\_lt}} (\coqdocvar{n} \coqdocvar{m} \coqdocvar{k} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{lt} \coqdocvariable{m} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{lt} \coqdocvariable{n} \coqdocvariable{k}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{w}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{l} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocvar{q}). \coqdocvar{f\_ap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.pred inj}{pred\_inj}{\coqdoclemma{pred\_inj}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{pred} \coqdocvariable{n} \coqdocnotation{=} \coqdocdefinition{pred} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{Hn} \coqdocvar{Hm} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqref{Ch03.Spred}{\coqdoclemma{Spred}} \coqdocvar{n} \coqdocvar{Hn}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocvar{\_} \coqdocnotation{@} \coqdocnotation{(}\coqref{Ch03.Spred}{\coqdoclemma{Spred}} \coqdocvar{m} \coqdocvar{Hm}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.pn lt n}{pn\_lt\_n}{\coqdoclemma{pn\_lt\_n}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocdefinition{lt} (\coqdocdefinition{pred} \coqdocvariable{n}) \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{\ensuremath{\exists}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}. \coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{apply} \coqref{Ch03.Spred}{\coqdoclemma{Spred}}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.brck equiv}{brck\_equiv}{\coqdoclemma{brck\_equiv}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{B}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{B}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{e}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{a'}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{apply} \coqdocvar{e}. \coqdoctac{apply} \coqdocvar{a'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b'}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{apply} \coqdocvar{e}\coqdocnotation{\ensuremath{^{-1}}}. \coqdoctac{apply} \coqdocvar{b'}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Book 2 15 6}{Book\_2\_15\_6}{\coqdocdefinition{Book\_2\_15\_6}} (\coqdocvar{X} : \coqdockw{Type}) (\coqdocvar{A} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) (\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{P} \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocnotation{(}\coqdocvar{f} \coqdocvariable{x}\coqdocnotation{).1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{f} \coqdocvar{x}\coqdocnotation{).2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.Book 2 15 7}{Book\_2\_15\_7}{\coqdoclemma{Book\_2\_15\_7}} `\{\coqdocclass{Funext}\} (\coqdocvar{X} : \coqdockw{Type}) (\coqdocvar{A} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) \coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) \coqdoceol
\coqdocindent{1.00em}
: \coqdocclass{IsEquiv} (\coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}} \coqdocvariable{X} \coqdocvariable{A} \coqdocvariable{P}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{isequiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{f}\coqdocnotation{.1} \coqdocvar{x}\coqdocnotation{;} \coqdocvar{f}\coqdocnotation{.2} \coqdocvar{x}\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Section\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{unfold} \coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}. \coqdoctac{\ensuremath{\exists}} 1.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Retraction\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}}. \coqdoctac{simpl}. \coqdoctac{apply} \coqdocdefinition{eta\_sigma}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.brck functor prod}{brck\_functor\_prod}{\coqdoclemma{brck\_functor\_prod}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{A} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqdocvariable{B}) \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{split}; \coqdocvar{strip\_truncations}; \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{apply} (\coqexternalref{fst}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{fst}} \coqdocvar{x}). \coqdoctac{apply} (\coqexternalref{snd}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocprojection{snd}} \coqdocvar{x}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{a} \coqdocvar{b}]. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{apply} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdocindent{0.50em}
The\coqdocindent{0.50em}
induction\coqdocindent{0.50em}
step\coqdocindent{0.50em}
of\coqdocindent{0.50em}
the\coqdocindent{0.50em}
proof\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.ISFAC}{ISFAC}{\coqdocsection{ISFAC}}.\coqdoceol
\coqdocnoindent
\coqdockw{Context} \{\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}\} \{\coqdocvar{A} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}\} \{\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Definition} \coqdef{Ch03.A'}{A'}{\coqdocdefinition{A'}} := \coqdocvariable{A} \coqdocnotation{o} \coqdocnotation{(}@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Definition} \coqdef{Ch03.P'}{P'}{\coqdocdefinition{P'}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.A'}{\coqdocdefinition{A'}} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{a}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvariable{P} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{m}. \coqdoctac{apply} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.domain trans}{domain\_trans}{\coqdoclemma{domain\_trans}} `\{\coqdocclass{Funext}\} :\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{m} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdocnotation{)}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}))\coqdoceol
\coqdocindent{12.50em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdoceol
\coqdocindent{16.00em}
\coqdocvariable{P} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} \coqdocvariable{z} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} \coqdocvariable{z} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{z}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_sigma'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch03.A'}{\coqdocdefinition{A'}}. \coqdoctac{unfold} \coqdocdefinition{compose}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{a}. \coqdoctac{unfold} \coqref{Ch03.P'}{\coqdocdefinition{P'}}. \coqdoctac{unfold} \coqdocdefinition{compose}. \coqdoctac{simpl}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqdoceol
\coqdocindent{2.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{2.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}}\coqdoceol
\coqdocindent{2.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_sum\_rect} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_functor\_prod'}; \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.codomain trans}{codomain\_trans}{\coqdoclemma{codomain\_trans}} `\{\coqdocclass{Funext}\} :\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{P} \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{z}, (\coqdocvariable{A} \coqdocnotation{o} \coqdocnotation{(}@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})\coqdocnotation{)} \coqdocnotation{o} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}) \coqdocvariable{z}\coqdoceol
\coqdocindent{6.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqdoceol
\coqdocindent{9.50em}
\coqdocvariable{P} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})) (\coqdocvar{g} \coqdocvariable{z})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}}\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}}\coqdoceol
\coqdocindent{16.00em}
\coqdocvariable{P} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.A'}{\coqdocdefinition{A'}} \coqdocvariable{z} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.P'}{\coqdocdefinition{P'}} \coqdocvariable{z} (\coqdocvar{g} \coqdocvariable{z})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_sigma'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{g}. \coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} \coqdocvariable{z} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} \coqdocvariable{z} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} (\coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}) (\coqref{Ch03.Book 2 15 7}{\coqdoclemma{Book\_2\_15\_7}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_})).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{9.50em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}}\coqdoceol
\coqdocindent{9.50em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{refine} (\coqdocdefinition{equiv\_sum\_rect} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocdefinition{Fin} \coqdocvariable{n}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) \coqdoceol
\coqdocindent{6.50em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqdoceol
\coqdocindent{6.50em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqref{Ch03.A'}{\coqdocdefinition{A'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.P'}{\coqdocdefinition{P'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck functor prod}{\coqdoclemma{brck\_functor\_prod}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_prod'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch03.A'}{\coqdocdefinition{A'}}, \coqref{Ch03.P'}{\coqdocdefinition{P'}}, \coqdocdefinition{compose}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqdoceol
\coqdocindent{10.00em}
(\coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}) \coqdoceol
\coqdocindent{10.00em}
(\coqref{Ch03.Book 2 15 7}{\coqdoclemma{Book\_2\_15\_7}} \coqdocvar{\_} \coqdocvar{\_} (\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocvariable{P} (\coqref{Ch03.cardF}{\coqdocdefinition{cardF}}\coqdocnotation{\ensuremath{^{-1}}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})) \coqdocvariable{a}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.ISFAC}{\coqdocsection{ISFAC}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.finite AC}{finite\_AC}{\coqdoclemma{finite\_AC}} `\{\coqdocclass{Funext}\} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{A} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) \coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{m} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{P} \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocconstructor{tr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} (\coqdockw{fun} \coqdocvar{m} : \coqdocdefinition{Fin} 0 \ensuremath{\Rightarrow} \coqdocdefinition{Empty\_rect} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{A} \coqdocvariable{m}) (\coqref{Ch03.cardO}{\coqdocdefinition{cardO}} \coqdocvariable{m})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{m}. \coqdocvar{contradiction} (\coqref{Ch03.cardO}{\coqdocdefinition{cardO}} \coqdocvar{m}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.domain trans}{\coqdoclemma{domain\_trans}} \coqdoctac{in} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{f} \coqdockw{as} [\coqdocvar{fn} \coqdocvar{f1}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.codomain trans}{\coqdoclemma{codomain\_trans}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{IHn} \coqdocvar{\_} ((\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{8.50em}
\coqdocvar{P} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvar{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})) \coqdocvariable{a}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{fn}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{z} := \coqdocconstructor{tt}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{f1} \coqdoctac{in} \coqdocvar{z}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{t}. \coqdoctac{apply} \coqdocvar{z}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
There's also a shorter proof by way of Lemma 3.8.2.  It suffices to show 
for all $n : \N$ and $Y : \Fin(n) \to \UU$
\[
  \left(\prd{m_{n} : \Fin(n)} \brck{Y(m_{n})}\right)
  \to
  \brck{\prd{m_{n} : \Fin(n)} Y(x)}
\]
Things proceed by induction, as before.  For $n \equiv 0$ everything follows
from a contradiction.  For the induction step, we can define a new family $Y' :
(\Fin(n) + \unit) \to \UU$ as before.  Then
\[
  \prd{m_{n+1} : \Fin(n+1)} \brck{Y(m_{n+1})}
  \eqvsym
  \prd{z : \Fin(n) + \unit} \brck{Y'(z)}
  \eqvsym
  \left(\prd{z : \Fin(n)} \brck{Y'(\inl(z))}\right)
  \times
  \left(\prd{z : \unit} \brck{Y'(\inr(z))}\right)
\]
and
\begin{align*}
  \brck{\prd{m_{n+1} : \Fin(n+1)} Y(m_{n+1})}
  &\eqvsym
  \brck{\prd{z : \Fin(n) + \unit} Y'(z)}
  \\&\eqvsym
  \brck{\left(\prd{z : \Fin(n)} Y'(\inl(z))\right)
  \times
  \left(\prd{z : \unit} Y'(\inr(z))\right)}
  \\&\eqvsym
  \brck{\prd{z : \Fin(n)} Y'(\inl(z))}
  \times
  \brck{\prd{z : \unit} Y'(\inr(z))}
\end{align*}
As before, we pair the induction hypothesis with a trivially constructed map to
produce the required arrow.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\begin{coqdoccomment}
\coqdocindent{0.50em}
the\coqdocindent{0.50em}
induction\coqdocindent{0.50em}
step\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.ISFAC'}{ISFAC'}{\coqdocsection{ISFAC'}}.\coqdoceol
\coqdocnoindent
\coqdockw{Context} \{\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}\} \{\coqdocvar{Y} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Definition} \coqdef{Ch03.Y'}{Y'}{\coqdocdefinition{Y'}} := \coqdocvariable{Y} \coqdocnotation{o} \coqdocnotation{(}@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})\coqdocnotation{)}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.domain trans'}{domain\_trans'}{\coqdoclemma{domain\_trans'}} `\{\coqdocclass{Funext}\} :\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocvariable{m})\coqdocnotation{)}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})))\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))})\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqref{Ch03.Y'}{\coqdocdefinition{Y'}} \coqdocvariable{z})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b}. \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z}))\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}))\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{refine} (\coqdocdefinition{equiv\_sum\_rect} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.codomain trans'}{codomain\_trans'}{\coqdoclemma{codomain\_trans'}} `\{\coqdocclass{Funext}\} : \coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqdocvariable{Y} ((@\coqdocmethod{equiv\_inv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})) (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})))\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}}\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqdocvariable{Y} \coqdocnotation{(}\coqdocvariable{n}\coqdocnotation{;} \coqdocnotation{(}\coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdocnotation{;} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{\_}\coqdocnotation{)\^{}}\coqdocnotation{))})\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{Y} \coqdocvariable{m}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})) \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z} : \coqdocinductive{Unit}, \coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{z})\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Y'}{\coqdocdefinition{Y'}} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvariable{z})\coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} \coqref{Ch03.brck functor prod}{\coqdoclemma{brck\_functor\_prod}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{z}, \coqref{Ch03.Y'}{\coqdocdefinition{Y'}} \coqdocvariable{z})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}. \coqdoctac{refine} (\coqdocdefinition{equiv\_sum\_rect} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}. \coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} \coqref{Ch03.cardF}{\coqdocdefinition{cardF}} (\coqref{Ch03.isequiv cardF}{\coqdoclemma{isequiv\_cardF}} \coqdocvariable{n})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b}. \coqdoctac{unfold} \coqref{Ch03.Y'}{\coqdocdefinition{Y'}}, \coqdocdefinition{compose}. \coqdoctac{apply} \coqdocdefinition{equiv\_path}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{f\_ap}. \coqdoctac{apply} \coqdocmethod{eissect}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.ISFAC'}{\coqdocsection{ISFAC'}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.finite AC'}{finite\_AC'}{\coqdoclemma{finite\_AC'}} `\{\coqdocclass{Funext}\} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{Y} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocvariable{m})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{Y} \coqdocvariable{m}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H'}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{m}. \coqdocvar{contradiction} (\coqref{Ch03.cardO}{\coqdocdefinition{cardO}} \coqdocvar{m}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.domain trans'}{\coqdoclemma{domain\_trans'}} \coqdoctac{in} \coqdocvar{f}. \coqdoctac{destruct} \coqdocvar{f} \coqdockw{as} [\coqdocvar{fn} \coqdocvar{f1}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.codomain trans'}{\coqdoclemma{codomain\_trans'}}. \coqdoctac{split}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{fn}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{set} (\coqdocvar{z} := \coqdocconstructor{tt}). \coqdoctac{apply} \coqdocvar{f1} \coqdoctac{in} \coqdocvar{z}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{intro} \coqdocvar{t}. \coqdoctac{apply} \coqdocvar{z}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.finite AC eqv finite AC'}{finite\_AC\_eqv\_finite\_AC'}{\coqdoclemma{finite\_AC\_eqv\_finite\_AC'}} `\{\coqdocclass{Funext}\} : \coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{A} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) \coqdocvar{P}, \coqdoceol
\coqdocindent{2.50em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{m} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{2.50em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}}\coqdoceol
\coqdocindent{2.50em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{P} \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdocnotation{)}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{Y} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}),\coqdoceol
\coqdocindent{2.50em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocvariable{m})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{Y} \coqdocvariable{m})\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
forward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{finite\_AC} \coqdocvar{n} \coqdocvar{Y} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{e} : (\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvar{Y} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, (\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit}) \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdoceol
\coqdocindent{2.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvar{Y} \coqdocvariable{m})\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{equiv\_via} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{y} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{Y} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} (\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit}) \coqdocvariable{m} \coqdocvar{y}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}. \coqdoctac{apply} \coqdoclemma{equiv\_inverse}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} (\coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}) (\coqref{Ch03.Book 2 15 7}{\coqdoclemma{Book\_2\_15\_7}} \coqdocvar{\_} \coqdocvar{\_} (\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}. \coqdoctac{refine} (\coqdocdefinition{equiv\_functor\_forall'} \coqdocvar{\_} \coqdocvar{\_}). \coqdoctac{apply} \coqdocdefinition{equiv\_idmap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b}. \coqdoctac{apply} \coqdocdefinition{equiv\_sigma\_contr}. \coqdoctac{intro} \coqdocvar{y}. \coqdoctac{apply} \coqdocinstance{contr\_unit}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{e}. \coqdoctac{clear} \coqdocvar{e}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{finite\_AC} \coqdocvar{n} \coqdocvar{Y} (\coqdockw{fun} \coqdocvar{z} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{m}. \coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{m})). \coqdoctac{apply} (\coqdocvar{f} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{tr}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
back\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{finite\_AC'} \coqdocvar{n} \coqdocvar{A} \coqdocvar{P} \coqdocvar{f}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{e} : (\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) \coqdocvariable{m})\coqdoceol
\coqdocindent{2.00em}
\coqdocnotation{\ensuremath{\eqvsym}}\coqdoceol
\coqdocindent{2.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m} : \coqdocdefinition{Fin} \coqdocvar{n}, \coqdocvar{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m} : \coqdocdefinition{Fin} \coqdocvar{n}, \coqdocvar{P} \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqdoceol
\coqdocindent{1.00em}
)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.brck equiv}{\coqdoclemma{brck\_equiv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocconstructor{BuildEquiv} \coqdocvar{\_} \coqdocvar{\_} (\coqref{Ch03.Book 2 15 6}{\coqdocdefinition{Book\_2\_15\_6}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}) (\coqref{Ch03.Book 2 15 7}{\coqdoclemma{Book\_2\_15\_7}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{e}. \coqdoctac{clear} \coqdocvar{e}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{finite\_AC'}. \coqdoctac{apply} \coqdocvar{f}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.finite AC alt}{finite\_AC\_alt}{\coqdoclemma{finite\_AC\_alt}} `\{\coqdocclass{Funext}\} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{A} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) \coqdoceol
\coqdocindent{4.00em}
(\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{m} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{P} \coqdocvariable{m} (\coqdocvar{g} \coqdocvariable{m})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{n}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.finite AC eqv finite AC'}{\coqdoclemma{finite\_AC\_eqv\_finite\_AC'}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.finite AC'}{\coqdoclemma{finite\_AC'}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\end{coqdoccode}
