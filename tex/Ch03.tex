\begin{coqdoccode}
\end{coqdoccode}
\section{Sets and logic}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} \coqdef{Ch03.Brck}{Brck}{\coqdocabbreviation{Brck}} \coqdocvar{Q} := (\coqdocinductive{minus1Trunc} \coqdocvar{Q}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.1}{127}  
Prove that if $A \eqvsym B$ and $A$ is a set, then so is $B$.


 \soln
Suppose that $A \eqvsym B$ and that $A$ is a set.  Since $A$ is a set, $x =_{A}
y$ is a mere proposition.  And since $A \eqvsym B$, this means that $x =_{B} y$
is a mere proposition, hence that $B$ is a set.


Alternatively, we can unravel some definitions.  By assumption we have $f : A
\eqvsym B$ and
\[
  g : \isset(A) \equiv \prd{x, y:A}\prd{p,q : x=y} (p = q)
\]
Now suppose that $x, y : B$ and $p, q : x = y$.  Then $f^{-1}(x),
f^{-1}(y) : A$ and $f^{-1}(p), f^{-1}(q) : f^{-1}(x) =
f^{-1}(y)$, so
\[
  f\!\left(g(f^{-1}(x), f^{-1}(y), f^{-1}(p), f^{-1}(q))\right) 
  : 
    f(f^{-1}(p)) = f(f^{-1}(q))
\]
Since $f^{-1}$ is a quasi-inverse of $f$, we have the homotopy $\alpha :
\prd{a:A} (f(f^{-1}(a)) = a)$, thus
\[
  \alpha_{x}^{-1} \ct 
  f\!\left(g(f^{-1}(x), f^{-1}(y), f^{-1}(p), f^{-1}(q))\right) 
  \ct \alpha_{y}
  :
  p = q
\]
So we've constructed an element of
\[
  \isset(B) : \prd{x, y : B} \prd{p, q : x = y} (p = q)
\]
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 1}{ex3\_1}{\coqdoclemma{ex3\_1}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) `\{\coqdocclass{Univalence}\} : \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe} \coqdoctac{in} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 1'}{ex3\_1'}{\coqdoclemma{ex3\_1'}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{p} \coqdocnotation{=} \coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{q}). \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdocdefinition{ap} \coqdocvar{f}\coqdocnotation{\ensuremath{^{-1}}})\coqdocnotation{)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.2}{127}
Prove that if $A$ and $B$ are sets, then so is $A + B$.


 \soln
Suppose that $A$ and $B$ are sets.  Then for all $a, a' : A$ and $b, b': B$, $a
= a'$ and $b = b'$ are contractible.  Given the characterization of the path
space of $A+B$ in \symbol{92}S2.12, it must also be contractible.  Hence $A + B$ is a
set.


More explicitly, suppose that $z, z' : A + B$ and $p, q : z = z'$.  By
induction, there are four cases.



\begin{itemize}
\item  $z \equiv \inl(a)$ and $z' \equiv \inl(a')$.  Then $(z = z') \eqvsym (a = a')$, and since $A$ is a set, $a = a'$ is contractible, so $(z = z')$ is as well.

\item  $z \equiv \inl(a)$ and $z' \equiv \inr(b)$.  Then $(z = z') \eqvsym \emptyt$, so $p$ is a contradiction.

\item  $z \equiv \inr(b)$ and $z' \equiv \inl(a)$.  Then $(z = z') \eqvsym \emptyt$, so $p$ is a contradiction.

\item  $z \equiv \inr(b)$ and $z' \equiv \inr(b')$.  Then $(z = z') \eqvsym (b = b')$, and since $B$ is a set, this type is contractible.

\end{itemize}
So $z = z'$ is contractible, making $A + B$ a set.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 2}{ex3\_2}{\coqdoclemma{ex3\_2}} (\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}) : \coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{z} \coqdocvar{z'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{p} \coqdocnotation{=} \coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{pose} \coqdocvar{proof} (\coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{z} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{b}], \coqdocvar{z'} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{b'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{f}. \coqdocvar{contradiction}. \coqdocvar{contradiction}. \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} \coqdocnotation{(}\coqdocdefinition{path\_sum} \coqdocvar{z} \coqdocvar{z'}\coqdocnotation{)\^{}-1)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.3}{127}
Prove that if $A$ is a set and $B : A \to \UU$ is a type family such that
$B(x)$ is a set for all $x:A$, then $\sm{x:A}B(x)$ is a set.


 \soln
At this point the pattern in these proofs is relatively obvious: show
that the path space of the combined types is determined by the path
spaces of the base types, and then apply the fact that the base types
are sets.  So here we suppose that $w w' : \sm{x:A} B(x)$, and that $p
q : (w = w')$.  Now
\[
  (w = w') \eqvsym \sm{p : \fst(w) = \fst(w')} p_{*}(\snd(w)) = \snd(w')
\]
by Theorem 2.7.2. Since $A$ is a set, $\fst(w) = \fst(w')$ is
contractible, so $(w = w') \eqvsym ((\refl{\fst(w)})_{*}(\snd(w)) =
\snd(w')) \equiv (\snd(w) = \snd(w'))$ by Lemma 3.11.9.  And since $B$
is a set, this too is contractible, making $w = w'$ contractible and
$\sm{x:A} B(x)$ a set.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 3}{ex3\_3}{\coqdoclemma{ex3\_3}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) : \coqdoceol
\coqdocindent{1.00em}
\coqdocabbreviation{IsHSet} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}:\coqdocvariable{A}, \coqdocabbreviation{IsHSet} (\coqdocvariable{B} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{B} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{f} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{w} \coqdocvar{w'}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1} \coqdocvar{p} \coqdocnotation{=} \coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1} \coqdocvar{q}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{p}..\coqdocnotation{1} \coqdocnotation{=} \coqdocvar{q}..\coqdocnotation{1}). \coqdoctac{apply} \coqdocvar{f}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{apply} (\coqdocvar{g} \coqdocvar{w'}\coqdocnotation{.1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} \coqdocnotation{(}\coqdocdefinition{path\_sigma\_uncurried} \coqdocvar{B} \coqdocvar{w} \coqdocvar{w'}\coqdocnotation{)\^{}-1)\^{}-1} \coqdocvar{X}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.4}{127}
Show that $A$ is a mere proposition if and only if $A \to A$ is contractible.


 \soln 
For the forward direction, suppose that $A$ is a mere proposition.  Then by
Example 3.6.2, $A \to A$ is a mere proposition.  We also have $\idfunc{A} : A
\to A$ when $A$ is inhabited and $! : A \to A$ when it's not, so $A \to A$ is
contractible.


For the other direction, suppose that $A \to A$ is contractible and that $x y :
A$.  We have the functions $z \mapsto x$ and $z \mapsto y$, and since $A \to A$
is contractible these functions are equal.  $\happly$ then gives $x = y$, so
$A$ is a mere proposition.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 4}{ex3\_4}{\coqdoclemma{ex3\_4}} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\leftrightarrow}}} \coqdocabbreviation{Contr} (\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
forward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocabbreviation{idmap}; \coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
backward\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdockw{fun} \coqdocvar{z}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{x}\coqdocnotation{)} \coqdocnotation{=} \coqdocnotation{(}\coqdockw{fun} \coqdocvar{z}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{y}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H}. \coqdoctac{transitivity} \coqdocvar{center}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocnotation{(}\coqdocvar{contr} (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{x})\coqdocnotation{)\^{}}. \coqdoctac{apply} (\coqdocvar{contr} (\coqdockw{fun} \coqdocvar{\_} : \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvar{y})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{apD10} \coqdocvar{X} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.5}{127}
Show that $\isprop(A) \eqvsym (A \to \iscontr(A))$.


 \soln
Lemma 3.3.3 gives us maps $\isprop(A) \to (A \to \iscontr(A))$ and $(A
\to \iscontr(A)) \to \isprop(A)$.  Note that $\iscontr(A)$ is a mere
proposition, so $A \to \iscontr(A)$ is as well.  $\isprop(A)$ is
always a mere proposition, so by Lemma 3.3.3 we have the equivalence.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 5}{ex3\_5}{\coqdoclemma{ex3\_5}} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{Contr} \coqdocvariable{A}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Lemma\coqdocindent{0.50em}
3.3.3\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
Lemma\coqdocindent{0.50em}
3.11.3\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.6}{127}
Show that if $A$ is a mere proposition, then so is $A + (\lnot A)$.


 \soln
Suppose that $A$ is a mere proposition, and that $x, y : A + (\lnot A)$.  By a
case analysis, we have



\begin{itemize}
\item  $x = \inl(a)$ and $y = \inl(a')$.  Then $(x = y) \eqvsym (a = a')$, and $A$ is a mere proposition, so this holds.

\item  $x = \inl(a)$ and $y = \inr(f)$.  Then $f(a) : \emptyt$, a contradiction.

\item  $x = \inr(f)$ and $y = \inl(a)$.  Then $f(a) : \emptyt$, a contradiction.

\item  $x = \inr(f)$ and $y = \inr(f')$.  Then $(x = y) \eqvsym (f = f')$, and $\lnot A$ is a mere proposition, so this holds.

\end{itemize}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 6}{ex3\_6}{\coqdoclemma{ex3\_6}} \{\coqdocvar{A}\} : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} (\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocnotation{\ensuremath{\lnot}}\coqdocvar{A})) \coqdockw{as} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{f} \coqdocvar{f'}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{x}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{f}], \coqdocvar{y} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{f'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}). \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}}). \coqdoctac{apply} \coqdocvar{H'}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.7}{127}
More generally, show that if $A$ and $B$ are mere propositions and $\lnot (A
\times B)$, then $A + B$ is also a mere proposition.


 \soln
Suppose that $A$ and $B$ are mere propositions with $f : \lnot (A \times B)$,
and let $x, y : A + B$.  Then we have cases:



\begin{itemize}
\item  $x = \inl(a)$ and $y = \inl(a')$.  Then $(x = y) \eqvsym (a = a')$, and $A$ is a mere proposition, so this holds.

\item  $x = \inl(a)$ and $y = \inr(b)$.  Then $f(a, b) : \emptyt$, a contradiction.

\item  $x = \inr(b)$ and $y = \inl(a)$.  Then $f(a, b) : \emptyt$, a contradiction.

\item  $x = \inr(b)$ and $y = \inr(b')$.  Then $(x = y) \eqvsym (b = b')$, and $B$ is a mere proposition, so this holds.

\end{itemize}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 7}{ex3\_7}{\coqdoclemma{ex3\_7}} \{\coqdocvar{A} \coqdocvar{B}\} : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\~{}(}\coqdocvariable{A} \coqexternalref{:type scope:x '*' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\times}}} \coqdocvariable{B}\coqdocnotation{)} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHProp} (\coqdocvariable{A}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}}\coqdocvariable{B}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HA} \coqdocvar{HB} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{a} \ensuremath{|} \coqdocvar{b}], \coqdocvar{y} \coqdockw{as} [\coqdocvar{a'} \ensuremath{|} \coqdocvar{b'}].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}}). \coqdoctac{apply} \coqdocvar{HA}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqdocvar{f} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{a}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}). \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} \coqdocinductive{Empty}. \coqdoctac{apply} (\coqdocvar{f} \coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvar{a'}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{,}} \coqdocvar{b}\coqexternalref{:core scope:'(' x ',' x ',' '..' ',' x ')'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}). \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}}). \coqdoctac{apply} \coqdocvar{HB}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.8}{127}
Assuming that some type $\isequiv(f)$ satisfies
\begin{itemize}
  \item[(i)] For each $f : A \to B$, there is a function $\qinv(f) \to \isequiv(f)$;
  \item[(ii)] For each $f$ we have $\isequiv(f) \to \qinv(f)$;
  \item[(iii)] For any two $e_{1}, e_{2} : \isequiv(f)$ we have $e_{1} = e_{2}$,
\end{itemize}
show that the type $\brck{\qinv(f)}$ satisfies the same conditions and is
equivalent to $\isequiv(f)$.


 \soln
Suppose that $f : A \to B$.  There is a function $\qinv(f) \to \brck{\qinv(f)}$
by definition.  Since $\isequiv(f)$ is a mere proposition (by iii), the
recursion principle for $\brck{\qinv(f)}$ gives a map $\brck{\qinv(f)} \to
\isequiv(f)$, which we compose with the map from (ii) to give a map
$\brck{\qinv(f)} \to \qinv(f)$.  Finally, $\brck{\qinv(f)}$ is a mere
proposition by construction.  Since $\brck{\qinv(f)}$ and $\isequiv(f)$ are
both mere propositions and logically equivalent, $\brck{\qinv(f)} \eqvsym
\isequiv(f)$ by Lemma 3.3.3.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 8}{Exercise3\_8}{\coqdocsection{Exercise3\_8}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Variables} (\coqdef{Ch03.Exercise3 8.E}{E}{\coqdocvariable{E}} \coqdef{Ch03.Exercise3 8.Q}{Q}{\coqdocvariable{Q}} : \coqdockw{Type}).\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H1}{H1}{\coqdocvariable{H1}} : \coqdocvariable{Q} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{E}.\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H2}{H2}{\coqdocvariable{H2}} : \coqdocvariable{E} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{Q}.\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 8.H3}{H3}{\coqdocvariable{H3}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{e} \coqdocvar{e'} : \coqdocvariable{E}, \coqdocvariable{e} \coqdocnotation{=} \coqdocvariable{e'}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 8 i}{ex3\_8\_i}{\coqdocdefinition{ex3\_8\_i}} : \coqdocvariable{Q} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} := \coqdocconstructor{min1}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 8 ii}{ex3\_8\_ii}{\coqdocdefinition{ex3\_8\_ii}} : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{Q}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{q}. \coqdoctac{apply} \coqdocvariable{H2}. \coqdoctac{apply} (@\coqdocdefinition{minus1Trunc\_rect\_nondep} \coqdocvariable{Q} \coqdocvariable{E}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvariable{H1}. \coqdoctac{apply} \coqdocvariable{H3}. \coqdoctac{apply} \coqdocvar{q}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 8 iii}{ex3\_8\_iii}{\coqdoclemma{ex3\_8\_iii}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{q} \coqdocvar{q'} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}, \coqdocvariable{q} \coqdocnotation{=} \coqdocvariable{q'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 8 iv}{ex3\_8\_iv}{\coqdoclemma{ex3\_8\_iv}} : \coqdocnotation{(}\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{Q}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{E}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} @\coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqref{Ch03.ex3 8 iii}{\coqdoclemma{ex3\_8\_iii}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdocvariable{H3}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvariable{H1} \coqdocnotation{o} \coqref{Ch03.ex3 8 ii}{\coqdocdefinition{ex3\_8\_ii}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.ex3 8 i}{\coqdocdefinition{ex3\_8\_i}} \coqdocnotation{o} \coqdocvariable{H2}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 8}{\coqdocsection{Exercise3\_8}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.9}{127}
Show that if $\LEM{}$ holds, then the type $\prop \defeq \sm{A:\UU}\isprop(A)$
is equivalent to $\bool$.


 \soln
Suppose that 
\[
  f : \prd{A:\UU}\left(\isprop(A) \to (A + \lnot A)\right)
\]
To construct a map $\prop \to \bool$, it suffices to consider an element of the
form $(A, g)$, where $g : \isprop(A)$.  Then $f(g) : A + \lnot A$, so we have
two cases:



\begin{itemize}
\item  $f(g) \equiv \inl(a)$, in which case we send it to $1_{\bool}$, or

\item  $f(g) \equiv \inr(a)$, in which case we send it to $0_{\bool}$.

\end{itemize}
To go the other way, note that $\LEM{}$ splits $\prop$ into two equivalence
classes (basically, the true and false propositions), and $\unit$ and $\emptyt$
are in different classes.  Univalence quotients out these classes, leaving us
with two elements.  We'll use $\unit$ and $\emptyt$ as representatives, so we
send $0_{\bool}$ to $\emptyt$ and $1_{\bool}$ to $\unit$.


Coq has some trouble with the universes here, so we have to specify that we want (\coqdocinductive{Unit} : \coqdockw{Type}) and (\coqdocinductive{Empty} : \coqdockw{Type}); otherwise we get the \coqdocabbreviation{Type0} versions.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 9}{Exercise3\_9}{\coqdocsection{Exercise3\_9}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 9.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{A} : \coqdockw{Type}), \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 9 f}{ex3\_9\_f}{\coqdocdefinition{ex3\_9\_f}} (\coqdocvar{P} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}}\coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) : \coqdocinductive{Bool} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} (\coqdocvariable{LEM} \coqdocvariable{P}\coqdocnotation{.1} \coqdocvariable{P}\coqdocnotation{.2}) \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocconstructor{true}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} \coqdocvar{a'} \ensuremath{\Rightarrow} \coqdocconstructor{false}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop Unit}{hprop\_Unit}{\coqdoclemma{hprop\_Unit}} : \coqdocabbreviation{IsHProp} (\coqdocinductive{Unit} : \coqdockw{Type}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{hprop\_inhabited\_contr}. \coqdoctac{intro} \coqdocvar{u}. \coqdoctac{apply} \coqdocinstance{contr\_unit}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 9 inv}{ex3\_9\_inv}{\coqdocdefinition{ex3\_9\_inv}} (\coqdocvar{b} : \coqdocinductive{Bool}) : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{b} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocconstructor{true} \ensuremath{\Rightarrow} @\coqexternalref{existT}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocabbreviation{existT}} \coqdockw{Type} \coqdocabbreviation{IsHProp} (\coqdocinductive{Unit} : \coqdockw{Type}) \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocconstructor{false} \ensuremath{\Rightarrow} @\coqexternalref{existT}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocabbreviation{existT}} \coqdockw{Type} \coqdocabbreviation{IsHProp} (\coqdocinductive{Empty} : \coqdockw{Type}) \coqdocinstance{hprop\_Empty}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 9}{ex3\_9}{\coqdoclemma{ex3\_9}} `\{\coqdocclass{Univalence}\} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{Type} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocabbreviation{IsHProp} \coqdocvar{A}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocinductive{Bool}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}} \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{b}. \coqdoctac{unfold} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}}, \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{b}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocinductive{Unit}:\coqdockw{Type}) \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{contradiction} \coqdocvar{n}. \coqdoctac{exact} \coqdocconstructor{tt}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocinductive{Empty}:\coqdockw{Type}) \coqdocinstance{hprop\_Empty}).\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{contradiction}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{destruct} \coqdocvar{w} \coqdockw{as} [\coqdocvar{A}  \coqdocvar{p}]. \coqdoctac{unfold} \coqref{Ch03.ex3 9 f}{\coqdocdefinition{ex3\_9\_f}}, \coqref{Ch03.ex3 9 inv}{\coqdocdefinition{ex3\_9\_inv}}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvariable{LEM} \coqdocvar{A} \coqdocvar{p}) \coqdockw{as} [\coqdocvar{x} \ensuremath{|} \coqdocvar{x}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocinductive{Unit}:\coqdockw{Type}\coqdocnotation{)} \coqdocnotation{=} \coqdocvar{A}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assert} (\coqdocabbreviation{Contr} \coqdocvar{A}). \coqdoctac{apply} \coqdoclemma{contr\_inhabited\_hprop}. \coqdoctac{apply} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{x}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe}. \coqdoctac{apply} \coqdoclemma{equiv\_inverse}. \coqdoctac{apply} \coqdocdefinition{equiv\_contr\_unit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{induction} \coqdocvar{X}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocabbreviation{IsHProp} (\coqdocinductive{Unit}:\coqdockw{Type}))). \coqdoctac{apply} \coqdocinstance{HProp\_HProp}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{(}\coqdocinductive{Empty}:\coqdockw{Type}\coqdocnotation{)} \coqdocnotation{=} \coqdocvar{A}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_path\_universe}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{intro} \coqdocvar{z}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{intro} \coqdocvar{a}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{induction} \coqdocvar{X}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocabbreviation{IsHProp} (\coqdocinductive{Empty}:\coqdockw{Type}))). \coqdoctac{apply} \coqdocinstance{HProp\_HProp}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 9}{\coqdocsection{Exercise3\_9}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.10}{127}
Show that if $\UU_{i+1}$ satisfies $\LEM{}$, then the canonical inclusion
$\prop_{\UU_{i}} \to \prop_{\UU_{i+1}}$ is an equivalence.


 \soln
If $\LEM{i+1}$ holds, then $\LEM{i}$ holds as well.  For suppose that
$A : \UU_{i}$ and $p : \isprop(A)$.  Then we also have $A :
\UU_{i+1}$, so $\LEM{i+1}(A, p) : A + \lnot A$, establishing
$\LEM{i}$.  By the previous exercise, then, $\prop_{\UU_{i}} \eqvsym
\bool \eqvsym \prop_{\UU_{i+1}}$.


Since Coq doesn't let the user access the \coqdockw{Type}${}_{i}$ hierarchy,
there's not much to do here.  This is really more of a ``proof by
contemplation'' anyway.


 \exerdone{3.11}{127}
Show that it is not the case that for all $A : \UU$ we have $\brck{A} \to A$.


 \soln
We can essentially just copy Theorem 3.2.2.  Suppose given a function $f :
\prd{A:\UU} \brck{A} \to A$, and recall the equivalence $e : \bool \eqvsym
\bool$ from Exercise 2.13 given by $e(1_{\bool}) \defeq 0_{\bool}$ and
$e(0_{\bool}) = 1_{\bool}$.  Then $\ua(e) : \bool = \bool$, $f(\bool)
: \brck{\bool} \to \bool$, and
\[
  \mapdepfunc{f}(\ua(e)) : 
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)} = f(\bool)
\]
So for $u : \brck{\bool}$,
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)}(u) = f(\bool)(u)
\]
and by 2.9.4, we have
\[
  \transfib{A \mapsto (\brck{A} \to A)}{\ua(e)}{f(\bool)}(u) 
  =
  \transfib{A \mapsto A}{\ua(e)}{f(\bool)(\transfib{\lvert \blank
  \rvert}{\ua(e)^{-1}}{u}})
\]
But, any two $u, v : \brck{A}$ are equal, since $\brck{A}$ is contractible.  So
$\transfib{\lvert\blank\rvert}{\ua(e)^{-1}}{u} = u$, and so
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  \transfib{A \mapsto A}{\ua(e)}{f(\bool)(u)}
  = f(\bool)(u)
\]
and the propositional computation rule for $\ua$ gives
\[
  \happly(\mapdepfunc{f}(\ua(e)), u) : 
  e(f(\bool)(u)) = f(\bool)(u)
\]
But $e$ has no fixed points, so we have a contradiction.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.negb no fixpoint}{negb\_no\_fixpoint}{\coqdoclemma{negb\_no\_fixpoint}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocdefinition{negb} \coqdocvariable{b} \coqdocnotation{=} \coqdocvariable{b}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{b} \coqdocvar{H}. \coqdoctac{destruct} \coqdocvar{b}; \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{false\_ne\_true} \coqdocvar{H}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} (\coqdocdefinition{true\_ne\_false} \coqdocvar{H}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 11}{ex3\_11}{\coqdoclemma{ex3\_11}} `\{\coqdocclass{Univalence}\} : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{b}, \coqdocdefinition{negb} (\coqdocvar{f} \coqdocinductive{Bool} \coqdocvariable{b}) \coqdocnotation{=} \coqdocvar{f} \coqdocinductive{Bool} \coqdocvariable{b}). \coqdoctac{intro} \coqdocvar{b}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocdefinition{transport} (\coqdockw{fun} \coqdocvar{A} \ensuremath{\Rightarrow} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}) (\coqdocdefinition{path\_universe} \coqdocdefinition{negb}) (\coqdocvar{f} \coqdocinductive{Bool}) \coqdocvar{b}\coqdoceol
\coqdocindent{5.00em}
\coqdocnotation{=}\coqdoceol
\coqdocindent{5.00em}
\coqdocvar{f} \coqdocinductive{Bool} \coqdocvar{b}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{apD10} (\coqdocdefinition{apD} \coqdocvar{f} (\coqdocdefinition{path\_universe} \coqdocdefinition{negb})) \coqdocvar{b}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocdefinition{transport} (\coqdockw{fun} \coqdocvar{A} \ensuremath{\Rightarrow} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}) (\coqdocdefinition{path\_universe} \coqdocdefinition{negb}) (\coqdocvar{f} \coqdocinductive{Bool}) \coqdocvar{b}\coqdoceol
\coqdocindent{5.00em}
\coqdocnotation{=}\coqdoceol
\coqdocindent{5.00em}
\coqdocdefinition{transport} \coqdocabbreviation{idmap} (\coqdocdefinition{path\_universe} \coqdocdefinition{negb}) \coqdoceol
\coqdocindent{10.00em}
(\coqdocvar{f} \coqdocinductive{Bool} (\coqdocdefinition{transport} (\coqdockw{fun} \coqdocvar{A} \ensuremath{\Rightarrow} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A}) \coqdoceol
\coqdocindent{19.50em}
\coqdocnotation{(}\coqdocdefinition{path\_universe} \coqdocdefinition{negb}\coqdocnotation{)\^{}}\coqdoceol
\coqdocindent{19.50em}
\coqdocvar{b}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocdefinition{transport\_arrow} \coqdocabbreviation{Type0} (\coqdockw{fun} \coqdocvar{A} \ensuremath{\Rightarrow} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A}) \coqdocabbreviation{idmap}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{X} \coqdoctac{in} \coqdocvar{X0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{b} \coqdocnotation{=} \coqdocnotation{(}\coqdocdefinition{transport} (\coqdockw{fun} \coqdocvar{A} : \coqdockw{Type} \ensuremath{\Rightarrow} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A}) \coqdocnotation{(}\coqdocdefinition{path\_universe} \coqdocdefinition{negb}\coqdocnotation{)} \coqdocnotation{\^{}} \coqdocvar{b}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{X1} \coqdoctac{in} \coqdocvar{X0}. \coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{X0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocdefinition{transport} \coqdocabbreviation{idmap} (\coqdocdefinition{path\_universe} \coqdocdefinition{negb}) (\coqdocvar{f} \coqdocinductive{Bool} \coqdocvar{b}) \coqdocnotation{=} \coqdocdefinition{negb} (\coqdocvar{f} \coqdocinductive{Bool} \coqdocvar{b})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{transport\_path\_universe}. \coqdoctac{rewrite} \coqdocvar{X2} \coqdoctac{in} \coqdocvar{X0}. \coqdoctac{apply} \coqdocvar{X0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqref{Ch03.negb no fixpoint}{\coqdoclemma{negb\_no\_fixpoint}} (\coqdocvar{f} \coqdocinductive{Bool} (\coqdocconstructor{min1} \coqdocconstructor{true}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{X} (\coqdocconstructor{min1} \coqdocconstructor{true})).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.12}{127}
Show that if $\LEM{}$ holds, then for all $A : \UU$ we have $\bbrck{\brck{A}
\to A}$.


 \soln
Suppose that $\LEM{}$ holds, and that $A : \UU$.  By $\LEM{}$, either $\brck{A}$
or $\lnot\brck{A}$.   If the
former, then we can use the recursion principle for $\brck{A}$ to construct a
map to $\bbrck{\brck{A} \to A}$, then apply it to the element of $\brck{A}$.
So we need a map $A \to \bbrck{\brck{A} \to A}$, which is not hard to get:
\[
  \lam{a:A}\left\lvert\lam{a':\brck{A}}a\right\rvert : A \to \bbrck{\brck{A} \to A}
\]
If the latter, then we have the canonical map out of the empty type $\brck{A}
\to A$, hence we have $\bbrck{\brck{A} \to A}$.  
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 12}{Exercise3\_12}{\coqdocsection{Exercise3\_12}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 12.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 12}{ex3\_12}{\coqdoclemma{ex3\_12}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{A}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvar{A}) \coqdocinstance{minus1Trunc\_is\_prop}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{minus1Trunc\_rect\_nondep} (\coqdockw{fun} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocconstructor{min1} (\coqdockw{fun} \coqdocvar{\_} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvariable{a}))).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocinstance{minus1Trunc\_is\_prop}. \coqdoctac{apply} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{intro} \coqdocvar{a}. \coqdocvar{contradiction} \coqdocvar{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 12}{\coqdocsection{Exercise3\_12}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.13}{127}
Show that the axiom
\[
    \LEM{}': \prd{A:\UU} (A + \lnot A)
\]
implies that for $X : \UU$, $A : X \to \UU$, and $P : \prd{x:X} A(x) \to \UU$,
if $X$ is a set, $A(x)$ is a set for all $x:X$, and $P(x, a)$ is a mere
proposition for all $x:X$ and $a:A(x)$, 
\[
  \left(\prd{x:X}\left\lVert\sm{a:A(x)}P(x, a)\right\rVert\right)
  \to
  \left\lVert \sm{g:\prd{x:X}A(x)}\prd{x:X}P(x, g(x))\right\rVert.
\]


 \soln
By Lemma 3.8.2, it suffices to show that for any set $X$ and any $Y : X \to
\UU$ such that $Y(x)$ is a set, we have
\[
  \left(\prd{x:X}\brck{Y(x)}\right) \to \left\lVert\prd{x:X}Y(x)\right\rVert
\]
Suppose that $f : \prd{x:X}\brck{Y(x)}$.  By $\LEM{}'$, either $Y(x)$ is
inhabited or it's not.  If it is, then $\LEM{}'(Y(x)) \equiv y : Y(x)$, and we
have
\[
  \left\lvert\lam{x:X}y\right\rvert : \left\lVert \prd{x:X} Y(x) \right\rVert
\]
Suppose instead that $\lnot Y(x)$ and that $x:X$.  Then $f(x) : \brck{Y(x)}$.
Since we're trying to derive a mere proposition, we can ignore this truncation
and suppose that $f(x) : Y(x)$, in which case we have a contradiction, and
we're done.


The reason we can ignore the truncation (and apply \coqdocvar{strip\_truncations} in Coq)
in hypotheses is given by the reasoning in the previous Exercise.  If the
conclusion is a mere proposition, then the recursion principle for
$\brck{Y(x)}$ allows us to construct an arrow out of $\brck{Y(x)}$ if we have
one from $Y(x)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.AC}{AC}{\coqdocdefinition{AC}} := \coqdockw{\ensuremath{\forall}} \coqdocvar{X} \coqdocvar{A} \coqdocvar{P},\coqdoceol
\coqdocindent{1.00em}
\coqdocabbreviation{IsHSet} \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{a}, \coqdocabbreviation{IsHProp} (\coqdocvariable{P} \coqdocvariable{x} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{((}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}:\coqdocvariable{X}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}}\coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqdoceol
\coqdocindent{3.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{P} \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.AC simpl}{AC\_simpl}{\coqdocdefinition{AC\_simpl}} := \coqdockw{\ensuremath{\forall}} (\coqdocvar{X} : \coqdocrecord{hSet}) (\coqdocvar{Y} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}),\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHSet} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{((}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.hprop is hset}{hprop\_is\_hset}{\coqdoclemma{hprop\_is\_hset}} (\coqdocvar{A} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocabbreviation{IsHSet} \coqdocvariable{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{typeclasses} \coqdoctac{eauto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Lemma382}{Lemma382}{\coqdoclemma{Lemma382}} : \coqref{Ch03.AC}{\coqdocdefinition{AC}} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.AC simpl}{\coqdocdefinition{AC\_simpl}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}; \coqdoctac{unfold} \coqref{Ch03.AC}{\coqdocdefinition{AC}}, \coqref{Ch03.AC simpl}{\coqdocdefinition{AC\_simpl}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{AC}. \coqdoctac{intros} \coqdocvar{X} \coqdocvar{Y} \coqdocvar{HY} \coqdocvar{D}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, (\coqdockw{fun} \coqdocvar{x} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit}) \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})\coqdoceol
\coqdocindent{7.50em}
\coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{apply} \coqdocvar{w}\coqdocnotation{.1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{g}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{g}. \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{X0}. \coqdoctac{apply} (\coqdocvar{AC} \coqdocvar{X} \coqdocvar{Y} (\coqdockw{fun} \coqdocvar{x} \coqdocvar{a} \ensuremath{\Rightarrow} \coqdocinductive{Unit})). \coqdoctac{apply} \coqdocvar{X}. \coqdoctac{apply} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqref{Ch03.hprop Unit}{\coqdoclemma{hprop\_Unit}}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdockw{as} \coqdocvar{y} \coqdoctac{by} \coqdoctac{apply} \coqdocvar{D}. \coqdocvar{strip\_truncations}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{y}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{AC\_simpl} \coqdocvar{X} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HX} \coqdocvar{HA} \coqdocvar{HP} \coqdocvar{D}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) \coqdoceol
\coqdocindent{6.00em}
\coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{P} \coqdocvariable{x} (\coqdocvar{g} \coqdocvariable{x})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{\ensuremath{\exists}} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocnotation{(}\coqdocvar{X0} \coqdocvariable{x}\coqdocnotation{).1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{X0} \coqdocvar{x}\coqdocnotation{).2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdocvar{strip\_truncations}. \coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} \coqdocnotation{(}\coqdocvar{X0}\coqdocnotation{.1} \coqdocvar{x}\coqdocnotation{;} \coqdocvar{X0}\coqdocnotation{.2} \coqdocvar{x}\coqdocnotation{)}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{X0}. \coqdoctac{apply} (\coqdocvar{AC\_simpl} (\coqdocdefinition{default\_HSet} \coqdocvar{X} \coqdocvar{HX}) (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} \coqdocvariable{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} \coqdocvariable{x} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqref{Ch03.ex3 3}{\coqdoclemma{ex3\_3}}. \coqdoctac{apply} (\coqdocvar{HA} \coqdocvar{x}). \coqdoctac{intro} \coqdocvar{a}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.hprop is hset}{\coqdoclemma{hprop\_is\_hset}}. \coqdoctac{apply} (\coqdocvar{HP} \coqdocvar{x} \coqdocvar{a}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{apply} (\coqdocvar{D} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 13}{Exercise3\_13}{\coqdocsection{Exercise3\_13}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 13.LEM'}{LEM'}{\coqdocvariable{LEM'}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 13}{ex3\_13}{\coqdoclemma{ex3\_13}}: \coqref{Ch03.AC}{\coqdocdefinition{AC}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.Lemma382}{\coqdoclemma{Lemma382}}. \coqdoctac{unfold} \coqref{Ch03.AC simpl}{\coqdocdefinition{AC\_simpl}}. \coqdoctac{intros} \coqdocvar{X} \coqdocvar{Y} \coqdocvar{HX} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocconstructor{min1}. \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM'} (\coqdocvar{Y} \coqdocvar{x})). \coqdoctac{apply} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdockw{as} \coqdocvar{y'}. \coqdoctac{apply} \coqdocvar{HY}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocnotation{\ensuremath{\lnot}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} (\coqdocvar{Y} \coqdocvar{x})) \coqdockw{as} \coqdocvar{nn}. \coqdoctac{intro} \coqdocvar{p}. \coqdocvar{strip\_truncations}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction} \coqdocvar{nn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 13}{\coqdocsection{Exercise3\_13}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.14}{127}
Show that assuming $\LEM{}$, the double negation $\lnot\lnot A$ has the same
universal property as the propositional truncation $\brck{A}$, and is therefore
equivalent to it.  


 \soln
Suppose that $a : \lnot\lnot A$ and that we have some function $g : A \to B$,
where $B$ is a mere proposition, so $p : \isprop(B)$.  We can construct a
function $\lnot \lnot A \to \lnot \lnot B$ by using contraposition twice,
producing $g'': \lnot \lnot A \to \lnot \lnot B$
\[
    g''(h) \defeq 
    \lam{f : \lnot B}h(\lam{a:A}f(g(a))) 
\]
$\LEM{}$ then allows us to use double negation elimination to produce a map
$\lnot \lnot B \to B$.  Suppose that $f : \lnot \lnot B$.  Then we have
$\LEM{}(B, p) : B + \lnot B$, and in the left case we can produce the witness,
and in the right case we use $f$ to derive a contradiction.  Explicitly, we
have $\ell : \lnot \lnot B \to B$ given by
\[
  \ell(f) \defeq 
  \rec{B + \lnot\lnot B}(B, \idfunc{B}, f, \LEM{}(B, p))
\]
The computation rule does not hold judgementally for $g'' \circ \ell$.  I don't
see that it can, given the use of $\LEM{}$.  Clearly it does hold
propositionally, if one takes $\lvert a \rvert' \defeq \lam{f}f(a)$ to be the
analogue of the constructor for $\brck{A}$; for any $a : A$, we have $g(a) :
B$, and the fact that $B$ is a mere proposition ensures that $(g'' \circ
\ell)(\lvert a \rvert') = g(a)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 14}{Exercise3\_14}{\coqdocsection{Exercise3\_14}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 14.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Brck'}{Brck'}{\coqdocdefinition{Brck'}} (\coqdocvar{A} : \coqdockw{Type}) := \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.min1'}{min1'}{\coqdocdefinition{min1'}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{a} : \coqdocvariable{A}) : \coqref{Ch03.Brck'}{\coqdocdefinition{Brck'}} \coqdocvariable{A} := \coqdockw{fun} \coqdocvar{f} \ensuremath{\Rightarrow} \coqdocvariable{f} \coqdocvariable{a}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.contrapositive}{contrapositive}{\coqdocdefinition{contrapositive}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{intro} \coqdocvar{a}. \coqdoctac{apply} \coqdocvar{X0}. \coqdoctac{apply} \coqdocvar{X}. \coqdoctac{apply} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.DNE}{DNE}{\coqdocdefinition{DNE}} \{\coqdocvar{B} : \coqdockw{Type}\} `\{\coqdocabbreviation{IsHProp} \coqdocvariable{B}\} : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{destruct} (\coqdocvariable{LEM} \coqdocvar{B} \coqdocvar{IsHProp0}). \coqdoctac{apply} \coqdocvar{b}. \coqdocvar{contradiction} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.trunc rect'}{trunc\_rect'}{\coqdocdefinition{trunc\_rect'}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} (\coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) : \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck'}{\coqdocdefinition{Brck'}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HB} \coqdocvar{a}. \coqdoctac{apply} \coqref{Ch03.DNE}{\coqdocdefinition{DNE}}. \coqdoctac{apply} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} (\coqref{Ch03.contrapositive}{\coqdocdefinition{contrapositive}} \coqdocvar{g})). \coqdoctac{apply} \coqdocvar{a}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 14}{\coqdocsection{Exercise3\_14}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.15}{128}
Show that if we assume propositional resizing, then the type
\[
  \prd{P:\prop}\left((A \to P) \to P\right)
\]
has the same universal property as $\brck{A}$.


 \soln
Let $A:\UU_{i}$, so that for $\brck{A}'' \defeq \prd{P:\prop_{\UU_{i}}} ((A \to
P) \to P)$ we have $\brck{A}'' : \UU_{i+1}$.  By propositional resizing,
however, we have a corresponding $\brck{A}'' : \UU_{i}$.  To construct an arrow
$\brck{A}'' \to B$, suppose that $f : \brck{A}''$ and $g : A \to B$.  Then
$f(B, g) : B$.  So $\lam{f}\tilde{f}(B, g) : \brck{A}'' \to B$, where
$\tilde{f}$ is the image of $f$ under the inverse of the canonical inclusion
$\prop_{\UU_{i}} \to \prop_{\UU_{i+1}}$.


To show that the computation rule holds, let
\[
  \lvert a \rvert'' \defeq \lam{P}{f}f(a) : \prd{P:\prop}\left((A \to P) \to P
  \right)
\]
We need to show that $(\lam{f}\tilde{f}(B, g))(\lvert a \rvert'') \equiv g(a)$.
Assuming that propositional resizing gives a judgemental equality, we have
\begin{align*}
  (\lam{f}\tilde{f}(B, g))(\lvert a \rvert '')
  &\equiv
  (\lam{f}\tilde{f}(B, g))(\lam{P}{f}f(a))
  \\&\equiv
  (\lam{P}{f}f(a))(B, g)
  \\&\equiv
  g(a)
\end{align*}
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Brck''}{Brck'{}'}{\coqdocdefinition{Brck'{}'}} (\coqdocvar{A} : \coqdockw{Type}) := \coqdockw{\ensuremath{\forall}} (\coqdocvar{P} : \coqdocrecord{hProp}), (\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}).\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.min1''}{min1'{}'}{\coqdocdefinition{min1'{}'}} \{\coqdocvar{A} : \coqdockw{Type}\} (\coqdocvar{a} : \coqdocvariable{A}) := \coqdockw{fun} (\coqdocvar{P} : \coqdocrecord{hProp}) (\coqdocvar{f} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P}) \ensuremath{\Rightarrow} \coqdocvariable{f} \coqdocvariable{a}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.trunc rect''}{trunc\_rect'{}'}{\coqdocdefinition{trunc\_rect'{}'}} \{\coqdocvar{A} \coqdocvar{B} : \coqdockw{Type}\} (\coqdocvar{g} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}) : \coqdocabbreviation{IsHProp} \coqdocvariable{B} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqref{Ch03.Brck''}{\coqdocdefinition{Brck'{}'}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{B}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocvar{f} (\coqdocconstructor{hp} \coqdocvar{B} \coqdocvar{p})). \coqdoctac{apply} \coqdocvar{g}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.16}{128}
Assuming $\LEM{}$, show that double negation commutes with universal
quantification of mere propositions over sets.  That is, show that if $X$ is a
set and each $Y(x)$ is a mere proposition, then $\LEM{}$ implies
\[
  \left(\prd{x:X}\lnot\lnot Y(x)\right) 
  \eqvsym
  \left(\lnot\lnot\prd{x:X} Y(x)\right).
\]


 \soln
Each side is a mere proposition, since one side is a dependent function into a
mere proposition and the other is a negation.  So we just need to show that
each implies the other.  From left to right we use the fact that $\LEM{}$
is equivalent to double negation to obtain $\prd{x:X}Y(x)$, and double negation
introduction is always allowed, giving the right side.  For the other direction
we do the same.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Section} \coqdef{Ch03.Exercise3 16}{Exercise3\_16}{\coqdocsection{Exercise3\_16}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Hypothesis} \coqdef{Ch03.Exercise3 16.LEM}{LEM}{\coqdocvariable{LEM}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 16}{ex3\_16}{\coqdoclemma{ex3\_16}} (\coqdocvar{X} : \coqdocrecord{hSet}) (\coqdocvar{Y} : \coqdocvariable{X} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHProp} (\coqdocvariable{Y} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdoceol
\coqdocindent{1.00em}
\coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{Y} \coqdocvariable{x}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{Y} \coqdocvariable{x}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{HY}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}; \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{f}. \coqdoctac{apply} \coqdocvar{f}. \coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocvar{Y} \coqdocvar{x})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{HY}. \coqdoctac{apply} \coqdocvar{y}.\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{contradiction} (\coqdocvar{H} \coqdocvar{x}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvariable{LEM} (\coqdocvar{Y} \coqdocvar{x})).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{HY}. \coqdoctac{intro} \coqdocvar{f}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{Y} \coqdocvariable{x}\coqdocnotation{)}). \coqdoctac{intro} \coqdocvar{f}. \coqdocvar{contradiction} (\coqdocvar{f} \coqdocvar{x}).\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{contradiction} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03.Exercise3 16}{\coqdocsection{Exercise3\_16}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.17}{128}
Show that the rules for the propositional truncation given in \S3.7 are
sufficient to imply the following induction principle: for any type family $B :
\brck{A} \to \UU$ such that each $B(x)$ is a mere proposition, if for every
$a:A$ we have $B(\lvert a \rvert)$, then for every $x : \brck{A}$ we have
$B(x)$.


 \soln
Suppose that $B : \brck{A} \to \UU$, $B(x)$ is a mere proposition for all $x :
\brck{A}$ and that $f : \prd{a:A} B(\lvert a \rvert)$. Suppose that $x
: \brck{A}$; we need to construct an element of $B(x)$.  By the
induction principle for $\brck{A}$, it suffices to exhibit a map $A
\to B(x)$.  So suppose that $a:A$, and we'll construct an element of
$B(x)$.  Since $\brck{A}$ is contractible, we have $p : \lvert a
\rvert = x$, and $p_{*}(f(a)) : B(x)$.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 17}{ex3\_17}{\coqdoclemma{ex3\_17}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{B} : \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) :\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocabbreviation{IsHProp} (\coqdocvariable{B} \coqdocvariable{x})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{a}, \coqdocvariable{B} (\coqdocconstructor{min1} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvariable{B} \coqdocvariable{x}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{HB} \coqdocvar{f}. \coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (@\coqdocdefinition{minus1Trunc\_rect\_nondep} \coqdocvar{A} (\coqdocvar{B} \coqdocvar{x})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{a}. \coqdoctac{assert} (\coqdocconstructor{min1} \coqdocvar{a} \coqdocnotation{=} \coqdocvar{x}) \coqdockw{as} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{transport} \coqdocvar{\_} \coqdocvar{p}). \coqdoctac{apply} (\coqdocvar{f} \coqdocvar{a}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{allpath\_hprop}. \coqdoctac{apply} \coqdocvar{x}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.18}{128}
Show that the law of excluded middle
\[
  \LEM{} : \prd{A:\UU} \left( \isprop(A) \to (A + \lnot A)\right)
\]
and the law of double negation
\[
  \DN : \prd{A:\UU} \left( \isprop(A) \to (\lnot\lnot A \to A)\right)
\]
are logically equivalent.


 \soln
For the forward direction, suppose that $\LEM{}$ holds, that $A : \UU$,
that $H : \isprop(A)$, and that $f : \lnot\lnot A$.  We then need to produce an
element of $A$.  We have $z \defeq \LEM{}(A, H) : A + \lnot A$, so we can
consider cases:



\begin{itemize}
\item  $z \equiv \inl(a)$, in which case we can produce $a$.

\item  $z \equiv \inr(x)$, in which case we have $f(x) : \emptyt$, a contradiction.

\end{itemize}
giving the forward direction.


Suppose instead that $\DN$ holds, and we have $A : \UU$ and $H : \isprop(A)$.
We need to provide an element of $A + \lnot A$.  By Exercise 3.6, $A + \lnot A$
is a mere proposition, so by $\DN$, if we can give an element of $\lnot\lnot(A
+ \lnot A)$, then we'll get one of $A + \lnot A$.  In Exercise 1.13 we
constructed such an element, so producing that gives one of $A + \lnot A$, and
we're done.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 18}{ex3\_18}{\coqdoclemma{ex3\_18}}: \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{\ensuremath{\leftrightarrow}}} \coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{A}, \coqdocabbreviation{IsHProp} \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{A}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}\coqexternalref{:type scope:x '<->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{LEM} \coqdocvar{A} \coqdocvar{H} \coqdocvar{f}. \coqdoctac{destruct} (\coqdocvar{LEM} \coqdocvar{A} \coqdocvar{H}). \coqdoctac{apply} \coqdocvar{a}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{DN} \coqdocvar{A} \coqdocvar{H}. \coqdoctac{apply} (\coqdocvar{DN} (\coqdocvar{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}}\coqdocvar{A}) (\coqref{Ch03.ex3 6}{\coqdoclemma{ex3\_6}} \coqdocvar{H})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{exact} (\coqdockw{fun} \coqdocvar{g} : \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvar{A} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvar{A}\coqdocnotation{)} \ensuremath{\Rightarrow} \coqdocvariable{g} (\coqexternalref{inr}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inr}} (\coqdockw{fun} \coqdocvar{a}:\coqdocvar{A} \ensuremath{\Rightarrow} \coqdocvariable{g} (\coqexternalref{inl}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{inl}} \coqdocvariable{a})))).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\end{coqdoccode}
\exer{3.19}{128}
Suppose $P : \mathbb{N} \to \UU$ is a decidable family of mere propositions.
Prove that
\[
  \left\lVert \sm{n:\mathbb{N}} P(n) \right\rVert
  \to
  \sm{n:\mathbb{N}} P(n).
\]


 \soln
Since $P : \mathbb{N} \to \UU$ is decidable, we have $f : \prd{n:\mathbb{N}}
(P(n) + \lnot P(n))$.  So if $\bbrck{\sm{n:\mathbb{N}}
P(n)}$ is inhabited, then there is some smallest $n$ such that $P(n)$.
It would be nice if we could define a function to return the
smallest $n$ such that $P(n)$.  But unbounded minimization isn't a
total function, so that won't obviously work.  Following the
discussion of Corollary 3.9.2, what we can do instead is to define some
\[
  Q : \left(\sm{n:\mathbb{N}} P(n)\right) \to \UU
\]
such that $\sm{w:\sm{n:\mathbb{N}} P(n)} Q(w)$ is a mere proposition.  Then
we can project out an element of $\sm{n:\mathbb{N}} P(n)$.


$Q(w)$ will be the proposition that $w$ is the smallest member of
$\sm{n\mathbb{N}}P(n)$.  Explicitly,
\[
  Q(w) \defeq 
  \prd{w' : \sm{n:\mathbb{N}}P(n)} \fst(w) \leq \fst(w')
\]
Then we have
\[
  \sm{w : \sm{n : \mathbb{N}} P(n)} Q(w)
  \equiv
  \sm{w : \sm{n : \mathbb{N}} P(n)}
  \prd{w' : \sm{n:\mathbb{N}}P(n)} \fst(w) \leq \fst(w')
\]
which we must show to be a mere proposition.  Suppose that $w$ and $w'$ are two
elements of this type.  By $\snd(w)$ and $\snd(w')$, we have $\fst(w) \leq
\fst(w')$ and $\fst(w') \leq \fst(w)$, so $\fst(w) = \fst(w')$.  Since
$\mathbb{N}$ has decidable equality, $\fst(w) \leq \snd(w')$ is a mere
proposition for all $w$ and $w'$, meaning that $Q(w)$ is a mere proposition.
So $w = w'$, meaning that our type is contractible.


Now we can use the universal property of $\bbrck{\sm{n:\mathbb{N}}P(n)}$ to
construct an arrow into $\sm{w : \sm{n:\mathbb{N}} P(n)} Q(w)$ by way of a
function $\big(\sm{n:\mathbb{N}} P(n)\big) \to \sm{w : \sm{n:\mathbb{N}} P(n)}
Q(w)$.  So suppose that we have some element $w : \sm{n:\mathbb{N}} P(n)$.
Using bounded minimization, we can obtain the smallest element of $\sm{n:
\mathbb{N}} P(n)$ that's less than or equal to $w$, and this will in fact be
the smallest element \textit{tout court}.  This means that it's a member of our
constructed type, so we've constructed a map
\[
  \left\lVert \sm{n:\mathbb{N}} P(n) \right\rVert
  \to
  \sm{w:\sm{n:\mathbb{N}}P(n)}Q(w)
\]
and projecting out gives the function in the statement.


I'm having just the damnedest time trying to work everything out in Coq.  At
some point I'll sort out my loadpath to cut out the \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} lemmas.  I'm sure I'm
overcomplicating the correctness proofs for \coqdocvar{bounded\_min}, though.  No way can
they be this long.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Open} \coqdockw{Scope} \coqdocvar{nat\_scope}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch03.nat code}{nat\_code}{\coqdocdefinition{nat\_code}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{n}, \coqdocvariable{m} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}, \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocinductive{Unit}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'}, \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m'} \ensuremath{\Rightarrow} \coqdocinductive{Empty}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{m'} \ensuremath{\Rightarrow} \coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvar{n'} \coqdocvar{m'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdef{Ch03.nat r}{nat\_r}{\coqdocdefinition{nat\_r}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{n} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{n} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqdocconstructor{tt}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'} \ensuremath{\Rightarrow} \coqref{Ch03.nat r}{\coqdocdefinition{nat\_r}} \coqdocvar{n'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.nat encode}{nat\_encode}{\coqdocdefinition{nat\_encode}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{p} : \coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}) : (\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m})\coqdoceol
\coqdocindent{1.00em}
:= \coqdocdefinition{transport} (\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n}) \coqdocvariable{p} (\coqref{Ch03.nat r}{\coqdocdefinition{nat\_r}} \coqdocvariable{n}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.nat decode}{nat\_decode}{\coqdocdefinition{nat\_decode}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}), \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}, \coqdocvar{m}; \coqdoctac{intro}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}. \coqdocvar{contradiction}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{X}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.equiv path nat}{equiv\_path\_nat}{\coqdoclemma{equiv\_path\_nat}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m}, \coqdocnotation{(}\coqref{Ch03.nat code}{\coqdocdefinition{nat\_code}} \coqdocvariable{n} \coqdocvariable{m}\coqdocnotation{)} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} (\coqref{Ch03.nat decode}{\coqdocdefinition{nat\_decode}} \coqdocvar{n} \coqdocvar{m}) (\coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdocvar{n} \coqdocvar{m}) \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{reflexivity}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}) \coqdocvar{IHn}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{generalize} \coqdoctac{dependent} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdoctac{apply} \coqdocdefinition{eta\_unit}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{c}. \coqdoctac{simpl}. \coqdoctac{unfold} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocnotation{(}\coqdoclemma{transport\_compose} \coqdocvar{\_} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Sn neq O}{Sn\_neq\_O}{\coqdoclemma{Sn\_neq\_O}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{n} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus cancelL}{plus\_cancelL}{\coqdoclemma{plus\_cancelL}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m} \coqdocvar{k}, \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{k} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{induction} \coqdocvar{n}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{k} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus assoc}{plus\_assoc}{\coqdoclemma{plus\_assoc}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n} \coqdocvar{m} \coqdocvar{k}, \coqdocvariable{n} \coqdocnotation{+} \coqdocnotation{(}\coqdocvariable{m} \coqdocnotation{+} \coqdocvariable{k}\coqdocnotation{)} \coqdocnotation{=} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{m}\coqdocnotation{)} \coqdocnotation{+} \coqdocvariable{k}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{trivial}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m} \coqdocvar{k}. \coqdoctac{simpl}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.plus O r}{plus\_O\_r}{\coqdoclemma{plus\_O\_r}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{n} \coqdocnotation{+} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}}). \coqdoctac{apply} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.le antisymmetric}{le\_antisymmetric}{\coqdoclemma{le\_antisymmetric}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{m} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{n}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{q}. \coqdoctac{destruct} \coqdocvar{p} \coqdockw{as} [\coqdocvar{k} \coqdocvar{p}], \coqdocvar{q} \coqdockw{as} [\coqdocvar{k'} \coqdocvar{q}].\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{Hm} : (\coqdocvar{m} \coqdocnotation{+} \coqdocvar{k'} \coqdocnotation{+} \coqdocvar{k} \coqdocnotation{=} \coqdocvar{m})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{l} \ensuremath{\Rightarrow} \coqdocvariable{l} \coqdocnotation{+} \coqdocvar{k}) \coqdocvar{q}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{p}).\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{Hk} : (\coqdocvar{k'} \coqdocnotation{+} \coqdocvar{k} \coqdocnotation{=} 0)).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqref{Ch03.plus cancelL}{\coqdoclemma{plus\_cancelL}} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocnotation{(}\coqref{Ch03.plus assoc}{\coqdoclemma{plus\_assoc}} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}\coqdocnotation{)} \coqdocnotation{@} \coqdocvar{Hm} \coqdocnotation{@} \coqdocnotation{(}\coqref{Ch03.plus O r}{\coqdoclemma{plus\_O\_r}} \coqdocvar{m}\coqdocnotation{)}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocvar{q}\coqdocnotation{\^{}} \coqdocnotation{@} \coqdocvar{\_}). \coqdoctac{refine} (\coqdocnotation{(}\coqdocdefinition{ap} (\coqdockw{fun} \coqdocvar{l} \ensuremath{\Rightarrow} \coqdocvariable{l} \coqdocnotation{+} \coqdocvar{k'}) \coqdocvar{p}\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocvar{\_}).\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.decidable}{decidable}{\coqdocdefinition{decidable}} \{\coqdocvar{A}\} (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) := \coqdockw{\ensuremath{\forall}} \coqdocvar{a}, (\coqdocvariable{P} \coqdocvariable{a} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocvariable{P} \coqdocvariable{a}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Module} \coqdef{Ch03.Exercise3 19}{Exercise3\_19}{\coqdocmodule{Exercise3\_19}}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Variable} (\coqdef{Ch03.Exercise3 19.P}{P}{\coqdocvariable{P}} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}).\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} (\coqdef{Ch03.Exercise3 19.H}{H}{\coqdocvariable{H}} : \coqref{Ch03.Exercise3 19.decidable}{\coqdocdefinition{decidable}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}}).\coqdoceol
\coqdocnoindent
\coqdockw{Hypothesis} (\coqdef{Ch03.Exercise3 19.HP}{HP}{\coqdocvariable{HP}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocabbreviation{IsHProp} (\coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvariable{n})).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Exercise3 19.Q}{Q}{\coqdocdefinition{Q}} (\coqdocvar{w} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) := \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{w'} : \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}, \coqdocvariable{w}\coqdocnotation{.1} \coqdocnotation{\ensuremath{\le}} \coqdocvariable{w'}\coqdocnotation{.1}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.Exercise3 19.hprop sigmaQ}{hprop\_sigmaQ}{\coqdoclemma{hprop\_sigmaQ}} : \coqdocabbreviation{IsHProp} (\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{w} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.Q}{\coqdocdefinition{Q}} \coqdocvar{w}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{intros} \coqdocvar{w} \coqdocvar{w'}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{transparent} \coqdoctac{assert} (\coqdocvar{H} : (\coqdocvar{w}\coqdocnotation{.1} \coqdocnotation{=} \coqdocvar{w'}\coqdocnotation{.1})).\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.Exercise3 19.ex3 19}{ex3\_19}{\coqdoclemma{ex3\_19}} : \coqref{Ch03.Exercise3 19.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} (@\coqdocabbreviation{pr1} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{n} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqref{Ch03.Exercise3 19.P}{\coqdocaxiom{P}} \coqdocvar{n}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqref{Ch03.Exercise3 19.Q}{\coqdocdefinition{Q}}).\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{End} \coqref{Ch03}{\coqdocmodule{Exercise3\_19}}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.20}{128}
Prove Lemma 3.11.9(ii): if $A$ is contractible with center $a$, then
$\sm{x:A}P(x)$ is equivalent to $P(a)$.


 \soln
Suppose that $A$ is contractible with center $a$.  For the forward direction,
suppose that $w : \sm{x:A} P(x)$.  Then $\fst(w) = a$, since $A$ is
contractible, so from $\snd(w) : P(\fst(w))$ and the indiscernibility
of identicals, we have $P(a)$.  For the backward direction, suppose
that $p : P(a)$.  Then we have $(a, p) : \sm{x:A} P(x)$.


To show that these are quasi-inverses, suppose that $p : P(a)$.  Going backward
gives $(a, p) : \sm{x:A} P(x)$, and going forward we have
$(\contr_{a}^{-1})_{*}p$.  Since $A$ is contractible, $\contr_{a} =
\refl{a}$, so this reduces to $p$, as needed.
For the other direction, suppose that $w : \sm{x:X} P(x)$.  Going forward gives
$(\contr_{\fst(w)}^{-1})_{*}\snd(w) : P(a)$, and going back gives
\[
  (a, (\contr_{\fst(w)}^{-1})_{*}\snd(w)) : \sm{x:A} P(x)
\]
By Theoremm 2.7.2, it suffices to show that $a = \fst(w)$ and that
\[
  (\contr_{\fst(w)})_{*}(\contr_{\fst(w)}^{-1})_{*} \snd(w) = \snd(w)
\]
The first of these is given by the fact that $A$ is contractible.  The second
results from the functorality of transport.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 20 f}{ex3\_20\_f}{\coqdocdefinition{ex3\_20\_f}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{Contr} \coqdocvariable{A}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{P} (\coqdocmethod{center} \coqdocvariable{A}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} (\coqdocdefinition{transport} \coqdocvar{\_} \coqdocnotation{(}\coqdocmethod{contr} \coqdocvar{X}\coqdocnotation{.1}\coqdocnotation{)\^{}}). \coqdoctac{apply} \coqdocvar{X}\coqdocnotation{.2}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.ex3 20 g}{ex3\_20\_g}{\coqdocdefinition{ex3\_20\_g}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{Contr} \coqdocvariable{A}) : \coqdoceol
\coqdocindent{1.00em}
\coqdocvariable{P} (\coqdocmethod{center} \coqdocvariable{A}) \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} \coqdocnotation{(}\coqdocmethod{center} \coqdocvar{A}\coqdocnotation{;} \coqdocvar{X}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 20}{ex3\_20}{\coqdoclemma{ex3\_20}} (\coqdocvar{A} : \coqdockw{Type}) (\coqdocvar{P} : \coqdocvariable{A} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}) (\coqdocvar{HA} : \coqdocabbreviation{Contr} \coqdocvariable{A}) : \coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{x} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvar{x}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocvariable{P} (\coqdocmethod{center} \coqdocvariable{A}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} (\coqref{Ch03.ex3 20 f}{\coqdocdefinition{ex3\_20\_f}} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HA}) (\coqref{Ch03.ex3 20 g}{\coqdocdefinition{ex3\_20\_g}} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HA})\coqdocvar{\_} \coqdocvar{\_}); \coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqref{Ch03.ex3 20 f}{\coqdocdefinition{ex3\_20\_f}}, \coqref{Ch03.ex3 20 g}{\coqdocdefinition{ex3\_20\_g}}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{p}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{Contr} (\coqdocmethod{center} \coqdocvar{A} \coqdocnotation{=} \coqdocmethod{center} \coqdocvar{A})). \coqdoctac{apply} \coqdocinstance{contr\_paths\_contr}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocmethod{contr} (\coqdocmethod{center} \coqdocvar{A}) \coqdocnotation{=} \coqdocconstructor{idpath}). \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocvar{X0}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{w}. \coqdoctac{apply} \coqdocdefinition{path\_sigma\_uncurried}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{\ensuremath{\exists}} (\coqdocmethod{contr} \coqdocvar{w}\coqdocnotation{.1}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{transport\_pV}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exerdone{3.21}{128}
Prove that $\isprop(P) \eqvsym (P \eqvsym \brck{P})$.


 \soln
$\isprop(P)$ is a mere proposition by Lemma 3.3.5.  $P \eqvsym \brck{P}$ is
also a mere proposition.  An equivalence is determined by its underlying
function, and for all $f, g : P \to \brck{P}$, $f = g$ by function
extensionality and the fact that $\brck{P}$ is a mere proposition.  Since each
of the two sides is a mere proposition, we just need to show that they imply
each other, by Lemma 3.3.3.  Lemma 3.9.1 gives the forward direction.  For the
backward direction, suppose that $e : P \eqvsym \brck{P}$, and let $x, y : P$.
Then $e(x) = e(y)$, since $\brck{P}$ is a proposition, and applying $e^{-1}$ to
each side gives $x = y$.  Thus $P$ is a mere proposition.
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 31}{ex3\_31}{\coqdoclemma{ex3\_31}} (\coqdocvar{P} : \coqdockw{Type}) : \coqdocabbreviation{IsHProp} \coqdocvariable{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocnotation{(}\coqdocvariable{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvariable{P}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocabbreviation{IsHProp} (\coqdocvar{P} \coqdocnotation{\ensuremath{\eqvsym}} \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqdocvar{P})). \coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{e1} \coqdocvar{e2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{path\_equiv}. \coqdoctac{apply} \coqdocdefinition{path\_forall}; \coqdoctac{intro} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{HP}. \coqdoctac{apply} \coqdocdefinition{equiv\_iff\_hprop}. \coqdoctac{apply} \coqdocconstructor{min1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{minus1Trunc\_rect\_nondep} \coqdocabbreviation{idmap}). \coqdoctac{apply} \coqdocvar{HP}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{e}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}; \coqdoctac{intros} \coqdocvar{x} \coqdocvar{y}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdocvar{e} \coqdocvar{x} \coqdocnotation{=} \coqdocvar{e} \coqdocvar{y}) \coqdockw{as} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{hprop\_allpath}. \coqdoctac{apply} \coqdoclemma{allpath\_hprop}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqdocnotation{(}\coqdocmethod{eissect} \coqdocvar{e} \coqdocvar{x}\coqdocnotation{)\^{}}. \coqdoctac{rewrite} \coqdocnotation{(}\coqdocmethod{eissect} \coqdocvar{e} \coqdocvar{y}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} (\coqdocdefinition{ap} \coqdocvar{e}\coqdocnotation{\ensuremath{^{-1}}} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\exer{3.22}{128}
As in classical set theory, the finite version of the axiom of choice is a
theorem.  Prove that the axiom of choice holds when $X$ is a finite type
$\Fin(n)$.


 \soln
We want to show that for all $n$, $A : \Fin(n) \to \UU$, and 
$P : \prd{m_{n} : \Fin(n)} A(m_{n}) \to \UU$, if $A$ is a family of sets and
$P$ a family of propositions, then
\[
  \left(
    \prd{m_{n} : \Fin(n)} \left\lVert \sm{a:A(m_{n})} P(m_{n}, a)\right\rVert
  \right)
  \to
  \left\lVert
    \sm{g : \prd{m_{n} : \Fin(n)} A(m_{n})} \prd{m_{n} : \Fin(n)}
        P(m_{n}, g(m_{n}))
  \right\rVert.
\]


We proceed by induction.  For the base case, suppose that $n \equiv 0$, so we
are interested in $\Fin(0) \defeq \sm{n:\mathbb{N}}(m < 0)$, which is
equivalent to $\emptyt$.  Then we have $\ind{\emptyt}(A) : \prd{m_{0} :
\Fin(0)} A(m_{0})$, so
\[
  \left(
    \ind{\emptyt}(A),
    \ind{\emptyt}(\lam{m_{0}}P(m_{0}, \ind{\emptyt}(A, m_{0})))
  \right)
\]
is an element of the codomain.


For the induction step, suppose that we have an element
\[
  f : \prd{m_{n+1} : \Fin(n+1)} 
        \left\lVert \sm{a:A(m_{n+1})} P(m_{n+1}, a)\right\rVert
\]
which can be modified in the obvious way to give a function
\[
  \tilde{f} : \prd{m_{n} : \Fin(n)} 
        \left\lVert \sm{a:A(m_{n})} P(m_{n}, a)\right\rVert
\]
So by the induction step, and since the element we're trying to construct is a
mere proposition, we have an element
\[
    w : \sm{g : \prd{m_{n} : \Fin(n)} A(m_{n})} \prd{m_{n} : \Fin(n)}
        P(m_{n}, g(m_{n}))
\]


Now, we need to construct an element of
\[
\left\lVert
    \sm{g : \prd{m_{n+1} : \Fin(n+1)} A(m_{n+1})} \prd{m_{n+1} : \Fin(n+1)}
        P(m_{n+1}, g(m_{n+1}))
\right\rVert
\]
To construct the first slot, suppose that $k : \Fin(n + 1)$.  Then because we
have $e : \Fin(n+1) \eqvsym \Fin(n) + \unit$, there are two cases: either $e(k)
: \Fin(n)$ or $e(k) = *$.  In the first case, we set $g(e(k)) \defeq (\fst
w)(e(k))$.  In the second, we 


Suppose the first.  Then we can modify $f$ in the
obvious way to obtain
\[
  \tilde{f} : \prd{m_{n} : \Fin(n)} 
        \left\lVert \sm{a:A(m_{n})} P(m_{n}, a)\right\rVert
\]
So by the induction step, and since the element we're trying to construct is a
mere proposition, we have an element
\[
    w : \sm{g : \prd{m_{n} : \Fin(n)} A(m_{n})} \prd{m_{n} : \Fin(n)}
        P(m_{n}, g(m_{n}))
\]


\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Infix} \coqdef{Ch03.:38224}{"}{"}\ensuremath{\not=}" := (\coqdockw{fun} \coqdocvar{n} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqdocnotation{)}) : \coqdocvar{nat\_scope}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.pred}{pred}{\coqdocdefinition{pred}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvariable{n} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \ensuremath{\Rightarrow} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n'} \ensuremath{\Rightarrow} \coqdocvar{n'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.S pred inv}{S\_pred\_inv}{\coqdoclemma{S\_pred\_inv}} : \coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{\ensuremath{\not=}} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqref{Ch03.pred}{\coqdocdefinition{pred}} \coqdocvariable{n}) \coqdocnotation{=} \coqdocvariable{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{intros}. \coqdocvar{contradiction} \coqdocvar{X}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.nat eq decidable}{nat\_eq\_decidable}{\coqdoclemma{nat\_eq\_decidable}} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}), \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocnotation{\ensuremath{\lnot}} \coqdocnotation{(}\coqdocvariable{n} \coqdocnotation{=} \coqdocvariable{m}\coqdocnotation{)}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}, \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqref{Ch03.nat encode}{\coqdocdefinition{nat\_encode}} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{IHn} \coqdocvar{m}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{left}. \coqdoctac{apply} (\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{p}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{right}. \coqdoctac{intro} \coqdocvar{H}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.cardF f}{cardF\_f}{\coqdocdefinition{cardF\_f}} \{\coqdocvar{n}\} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocdefinition{Fin} \coqdocvariable{n}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocinductive{Unit}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.nat eq decidable}{\coqdoclemma{nat\_eq\_decidable}} \coqdocvar{m} \coqdocvar{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{apply} \coqdocconstructor{tt}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{\ensuremath{\exists}} (\coqref{Ch03.pred}{\coqdocdefinition{pred}} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \coqref{Ch03.S pred inv}{\coqdoclemma{S\_pred\_inv}}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdoclemma{plus\_n\_Sm} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro}. \coqdoctac{rewrite} \coqdocvar{H} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdoclemma{plus\_1\_r} \coqdoctac{in} \coqdocvar{p}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.Fin incl}{Fin\_incl}{\coqdocdefinition{Fin\_incl}} \{\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}\} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{m}. \coqdoctac{destruct} \coqdocvar{m} \coqdockw{as} [\coqdocvar{m} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{m}. \coqdoctac{\ensuremath{\exists}} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{apply} (\coqdocnotation{(}\coqdoclemma{plus\_n\_Sm} \coqdocvar{m} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k})\coqdocnotation{)\^{}} \coqdocnotation{@} \coqdocnotation{(}\coqdocdefinition{ap} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{p}\coqdocnotation{)}).\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdef{Ch03.cardF g}{cardF\_g}{\coqdocdefinition{cardF\_g}} \{\coqdocvar{n}\} : \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocdefinition{Fin} \coqdocvariable{n}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocinductive{Unit} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}. \coqdoctac{destruct} \coqdocvar{x} \coqdockw{as} [\coqdocvar{m} \ensuremath{|} \coqdocvar{t}]. \coqdoctac{apply} (\coqref{Ch03.Fin incl}{\coqdocdefinition{Fin\_incl}} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{n}. \coqdoctac{\ensuremath{\exists}} 0. \coqdoctac{apply} \coqdocnotation{(}\coqdoclemma{plus\_1\_r} \coqdocvar{n}\coqdocnotation{)\^{}}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.sum O r}{sum\_O\_r}{\coqdoclemma{sum\_O\_r}} (\coqdocvar{n} \coqdocvar{m} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) : \coqdocvariable{n} \coqdocnotation{+} \coqdocvariable{m} \coqdocnotation{=} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdocvariable{m} \coqdocnotation{=} 0.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}. \coqdoctac{simpl}. \coqdoctac{apply} \coqdocabbreviation{idmap}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdoclemma{S\_inj} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{IHn}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.cardFO}{cardFO}{\coqdoclemma{cardFO}} : \coqdocdefinition{Fin} \coqexternalref{O}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{O}} \coqdocnotation{\ensuremath{\eqvsym}} \coqdocinductive{Empty}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{refine} (\coqdocdefinition{equiv\_adjointify} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{destruct} \coqdocvar{n} \coqdockw{as} [\coqdocvar{n} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqdocvar{n} \coqdocnotation{+} \coqdocvar{k}) \coqdocnotation{=} 0). \coqdoctac{transitivity} (\coqdocvar{n} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{apply} \coqdoclemma{plus\_n\_Sm}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.equiv path nat}{\coqdoclemma{equiv\_path\_nat}} \coqdoctac{in} \coqdocvar{X}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{e}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{e}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{n}. \coqdoctac{destruct} \coqdocvar{n} \coqdockw{as} [\coqdocvar{n} [\coqdocvar{k} \coqdocvar{p}]].\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} (\coqdocvar{n} \coqdocnotation{+} \coqdocvar{k}) \coqdocnotation{=} 0). \coqdoctac{transitivity} (\coqdocvar{n} \coqdocnotation{+} \coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{k}). \coqdoctac{apply} \coqdoclemma{plus\_n\_Sm}. \coqdoctac{apply} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqref{Ch03.equiv path nat}{\coqdoclemma{equiv\_path\_nat}} \coqdoctac{in} \coqdocvar{X}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdef{Ch03.cardF}{cardF}{\coqdoclemma{cardF}} \{\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}\} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvariable{n}) \coqdocnotation{\ensuremath{\eqvsym}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{(}}\coqdocdefinition{Fin} \coqdocvariable{n}\coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{)}} \coqexternalref{:type scope:x '+' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocnotation{+}} \coqdocinductive{Unit}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdef{Ch03.ex3 22}{ex3\_22}{\coqdoclemma{ex3\_22}} `\{\coqdocclass{Univalence}\}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{n} : \coqexternalref{nat}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocinductive{nat}}) (\coqdocvar{A} : \coqdocdefinition{Fin} \coqdocvariable{n} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type})\coqdoceol
\coqdocindent{12.00em}
(\coqdocvar{P} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{m} : \coqdocdefinition{Fin} \coqdocvariable{n}), \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdockw{Type}),\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{n}, \coqdocabbreviation{IsHSet} (\coqdocvariable{A} \coqdocvariable{n})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m} \coqdocvar{a}, \coqdocabbreviation{IsHProp} (\coqdocvariable{P} \coqdocvariable{m} \coqdocvariable{a})\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}}\coqdoceol
\coqdocindent{1.00em}
\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{(}}\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvariable{P} \coqdocvariable{m} \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}\coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{)}} \coqexternalref{:type scope:x '->' x}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Logic}{\coqdocnotation{\ensuremath{\rightarrow}}} \coqdoceol
\coqdocindent{1.00em}
\coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{g} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvariable{A} \coqdocvariable{m} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdockw{\ensuremath{\forall}} \coqdocvar{k}, \coqdocvariable{P} \coqdocvariable{k} (\coqdocvar{g} \coqdocvariable{k})\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
case\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=\coqdocindent{0.50em}
0\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HA} \coqdocvar{HP} \coqdocvar{f}. \coqdoctac{apply} \coqdocconstructor{min1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m}, \coqdocvar{A} \coqdocvariable{m}). \coqdoctac{intros}. \coqdocvar{contradiction} (\coqref{Ch03.cardFO}{\coqdoclemma{cardFO}} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{\ensuremath{\exists}} \coqdocvar{X}. \coqdoctac{intro}. \coqdocvar{contradiction} (\coqref{Ch03.cardFO}{\coqdoclemma{cardFO}} \coqdocvar{k}).\coqdoceol
\coqdocemptyline
\coqdocindent{1.00em}
\begin{coqdoccomment}
\coqdocindent{0.50em}
case\coqdocindent{0.50em}
n\coqdocindent{0.50em}
=\coqdocindent{0.50em}
S\coqdocindent{0.50em}
n\coqdocindent{0.50em}
\end{coqdoccomment}
\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{A} \coqdocvar{P} \coqdocvar{HA} \coqdocvar{HP} \coqdocvar{f}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{k} : \coqdocdefinition{Fin} \coqdocvar{n}, \coqref{Ch03.Brck}{\coqdocabbreviation{Brck}} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\{}}\coqdocvar{a} \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{:}} \coqdocvar{A} (\coqref{Ch03.Fin incl}{\coqdocdefinition{Fin\_incl}} \coqdocvariable{k}) \coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\&}} \coqdocvar{P} (\coqref{Ch03.Fin incl}{\coqdocdefinition{Fin\_incl}} \coqdocvariable{k}) \coqdocvar{a}\coqexternalref{:type scope:'x7B' x ':' x 'x26' x 'x7D'}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Specif}{\coqdocnotation{\}}}) \coqdockw{as} \coqdocvar{w}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{apply} (\coqdocvar{f} (\coqref{Ch03.Fin incl}{\coqdocdefinition{Fin\_incl}} \coqdocvar{k})).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{IHn} \coqdoctac{in} \coqdocvar{w}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{strip\_truncations}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\coqdockw{\ensuremath{\forall}} \coqdocvar{m} : \coqdocdefinition{Fin} (\coqexternalref{S}{http://coq.inria.fr/distrib/8.4pl3/stdlib/Coq.Init.Datatypes}{\coqdocconstructor{S}} \coqdocvar{n}), \coqdocvar{A} \coqdocvariable{m}) \coqdockw{as} \coqdocvar{g}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{m}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} (\coqdocmethod{eissect} \coqref{Ch03.cardF}{\coqdocaxiom{cardF}} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqref{Ch03.cardF}{\coqdocaxiom{cardF}} \coqdocvar{m}) \coqdockw{as} [\coqdocvar{em} \ensuremath{|} \coqdocvar{m\_m}]; \coqdoctac{simpl}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Local}\coqdocindent{0.50em}
\coqdockw{Close} \coqdockw{Scope} \coqdocvar{nat\_scope}.\coqdoceol
\end{coqdoccode}
